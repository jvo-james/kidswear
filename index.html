<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kids Wear — One-off Dresses</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Lexend:wght@600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4Q5GR0GCN9"></script>
  <!-- Paystack inline -->
  <script src="https://js.paystack.co/v1/inline.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- STYLE: full page styles (place inside <head> or a CSS file) -->




<style>

:root{
  --brand-1: #ff6b8a;        /* playful pink */
  --brand-2: #ffd166;        /* sunny yellow */
  --accent:   #6ee7b7;       /* mint accent */
  --bg:       #fffaf6;
  --muted:    #6b7280;
  --card:     #ffffff;
  --glass:    rgba(255,255,255,0.6);
  --shadow:   0 8px 24px rgba(23,23,23,0.08);
  --radius-lg: 18px;
  --radius-md: 12px;
  --radius-sm: 8px;
  --max-width: 1200px;
  --transition-fast: 180ms;
  --transition: 280ms;
  --elev: 0 10px 30px rgba(16,24,40,0.08);
  --focus: 0 0 0 4px rgba(110,231,183,0.18);
  --text: #0f172a;
  --success: #10b981;
}

/* quick reset */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg, #fffaf6 0%, #fff7f0 40%);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.45;
  scroll-behavior:smooth;
  -webkit-tap-highlight-color: transparent;
}

/* container helper */
.container{
  width:90%;
  max-width:var(--max-width);
  margin:0 auto;
}

/* simple utilities */
.sr-only{
  position:absolute!important;
  width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
}
.lead{font-size:1.05rem;color:var(--muted)}

/* -------------------------
   HEADER
   -------------------------*/
.site-header{
  position:sticky;
  top:0;
  z-index:60;
  backdrop-filter: blur(6px);
  background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.65));
  border-bottom: 1px solid rgba(15,23,42,0.04);
  box-shadow: 0 6px 18px rgba(18,24,36,0.03);
}
.header-inner{
  display:flex;
  align-items:center;
  gap:12px;
  height:72px;
  width:90%;
  max-width:var(--max-width);
  margin:0 auto;
  padding:8px 0;
}
.logo{
  display:flex;
  gap:10px;
  align-items:center;
  text-decoration:none;
  color:var(--text);
  font-weight:700;
  font-size:1.1rem;
}
.logo-ico{
  font-size:20px;
  color:var(--brand-1);
  transform:translateY(-1px);
  text-shadow: 0 2px 8px rgba(255,107,138,0.12);
}
.brand-name{letter-spacing:0.2px}
.main-nav{margin-left:16px;flex:1}
.main-nav .nav-list{
  display:flex;
  gap:12px;
  align-items:center;
  list-style:none;
  padding:0;margin:0;
}
.main-nav a{
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:8px 12px;
  border-radius:10px;
  color:var(--muted);
  text-decoration:none;
  font-weight:600;
  transition:all var(--transition);
}
.main-nav a:hover, .main-nav a:focus{
  color:var(--text);
  transform:translateY(-2px);
  background:linear-gradient(90deg, rgba(255,107,138,0.06), rgba(255,209,102,0.04));
}

.header-actions{
  display:flex;
  gap:8px;
  align-items:center;
}

/* icon buttons */
.icon-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border:0;
  background:transparent;
  padding:8px;
  border-radius:10px;
  cursor:pointer;
  color:var(--muted);
  transition:all var(--transition);
}
.icon-btn:focus{outline:none;box-shadow:var(--focus)}
.icon-btn:hover{transform:translateY(-3px); color:var(--text)}

/* badge */
.badge{
  display:inline-block;
  min-width:20px;
  background:var(--brand-1);
  color:#fff;
  padding:2px 6px;
  font-size:12px;
  border-radius:999px;
  margin-left:6px;
  vertical-align:middle;
  text-align:center;
}

/* hamburger mobile */
.hamburger{
  display:inline-flex;
  align-items:center;
  gap:8px;
  background:var(--card);
  border-radius:12px;
  border:1px solid rgba(15,23,42,0.04);
  padding:8px 10px;
}
.hamburger .fa-bars{font-size:18px}

/* MOBILE NAV */
.mobile-nav{
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:14px;
  border-top:1px solid rgba(15,23,42,0.03);
  background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.95));
  transform-origin:top;
  transition:all 220ms ease;
  overflow:hidden;
  max-height:0;
}
.mobile-nav.open{max-height:420px}
.mobile-nav ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:6px}
.mobile-nav a{padding:12px;border-radius:10px;text-decoration:none;color:var(--text);font-weight:600}
.mobile-nav-footer{margin-top:12px}

/* -------------------------
   HERO / SLIDER
   -------------------------*/
.hero{
  margin:18px auto;
  width:100%;
}
.hero-slider{
  position:relative;
  border-radius:var(--radius-lg);
  overflow:hidden;
  box-shadow:var(--elev);
  min-height:300px;
}
.slide{
  display:block;
  width:100%;
  height:100%;
  position:relative;
}
.slide-inner{
  display:grid;
  grid-template-columns: 1fr;
  align-items:center;
  min-height:320px;
}

/* hero image */
.hero-media img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  filter:contrast(1.02) saturate(1.05);
  transform:scale(1.02);
  transition:transform 6s ease;
}
.hero-slider .slide.active .hero-media img{ transform: scale(1); }

/* caption overlay */
.hero-caption{
  position:absolute;
  left:14px;
  bottom:18px;
  z-index:3;
  background:linear-gradient(90deg, rgba(255,255,255,0.92), rgba(255,255,255,0.72));
  padding:18px;
  border-radius:14px;
  width:calc(100% - 40px);
  max-width:560px;
  box-shadow:var(--shadow);
}
.hero-caption h1, .hero-caption h2{
  margin:0 0 6px 0;
  font-size:1.45rem;
  line-height:1.1;
  color:var(--text);
}
.hero-caption p{margin:0 0 12px 0;color:var(--muted)}
.hero-cta{display:flex;gap:10px;flex-wrap:wrap}

/* hero controls */
.hero-controls{
  position:absolute;
  right:12px;
  top:12px;
  display:flex;
  gap:10px;
  align-items:center;
  z-index:4;
}
.hero-prev, .hero-next{
  border:0;
  background:rgba(255,255,255,0.9);
  padding:8px 10px;
  border-radius:10px;
  cursor:pointer;
  box-shadow:0 6px 18px rgba(12,18,28,0.06);
}
.hero-dots{display:flex;gap:6px;margin-left:8px}
.hero-dots .dot{
  width:10px;height:10px;border-radius:999px;border:0;background:rgba(12,18,28,0.12);cursor:pointer;
}
.hero-dots .dot.active{background:linear-gradient(90deg,var(--brand-1),var(--brand-2))}

/* -------------------------
   CATEGORIES (CHIPS)
   -------------------------*/
.categories{margin:20px auto}
.section-title{display:flex;align-items:center;gap:8px;font-size:1.05rem;margin:6px 0 10px 0}
.category-chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{
  border:1px solid rgba(15,23,42,0.06);
  background:linear-gradient(180deg,white, rgba(255,255,255,0.92));
  padding:8px 12px;
  border-radius:999px;
  cursor:pointer;
  font-weight:600;
  display:inline-flex;
  align-items:center;
  gap:8px;
  transition:all var(--transition);
}
.chip:hover{transform:translateY(-3px)}
.chip.active{
  background:linear-gradient(90deg,var(--brand-1),var(--brand-2));
  color:white;
  box-shadow: 0 10px 30px rgba(255,107,138,0.12);
}

/* -------------------------
   SHOP / PRODUCT GRID
   -------------------------*/
.shop{margin:20px auto 36px}
.shop-header{display:flex;flex-direction:column;gap:12px;margin-bottom:8px}
.shop-header h2{margin:0;display:flex;align-items:center;gap:8px;font-size:1.15rem}
.shop-controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.search-wrap{display:flex;gap:6px;align-items:center;border-radius:12px;padding:6px;background:var(--card);box-shadow:var(--shadow)}
.search-wrap input[type="search"]{
  border:0;padding:10px 8px;min-width:150px;border-radius:10px;outline:none;font-size:0.95rem;
}
.search-wrap .icon-btn{padding:8px 10px}
.sort-wrap select{
  padding:8px 10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);background:var(--card);
}

/* product grid */
.product-grid{
  display:grid;
  gap:12px;
  width:100%;
  margin-top:12px;
}

/* grid columns: mobile-first (1 column) */
.product-grid{grid-template-columns: 1fr}

/* product card */
.product-card{
  display:flex;
  flex-direction:column;
  background:var(--card);
  border-radius:14px;
  overflow:hidden;
  box-shadow:var(--shadow);
  transition:transform var(--transition), box-shadow var(--transition);
  border:1px solid rgba(15,23,42,0.03);
}
.product-card:hover{transform:translateY(-6px);box-shadow:0 18px 50px rgba(16,24,40,0.06)}
.product-media{position:relative;padding-top:70%;overflow:hidden;background:linear-gradient(180deg,rgba(255,246,245,1),rgba(255,250,245,0.6))}
.product-media img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;display:block}
.product-media .quickview{
  position:absolute;right:8px;top:8px;background:rgba(255,255,255,0.9);border-radius:10px;padding:8px;border:0;cursor:pointer;box-shadow:0 6px 18px rgba(12,18,28,0.06)
}
.product-tag{
  position:absolute;left:8px;top:8px;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:white;padding:6px 10px;border-radius:999px;font-weight:700;display:inline-flex;gap:8px;align-items:center;font-size:13px
}

.product-body{padding:12px 14px 16px;display:flex;flex-direction:column;gap:10px}
.product-title{font-size:1rem;margin:0;color:var(--text)}
.product-meta{margin:0;color:var(--muted);font-size:13px}
.product-bottom{display:flex;align-items:center;justify-content:space-between;gap:8px}
.price-wrap .price{font-weight:800;color:var(--brand-1)}
.card-actions{display:flex;align-items:center;gap:8px}
.btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;border:0;cursor:pointer;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:white;font-weight:700;transition:transform var(--transition)}
.btn:hover{transform:translateY(-3px)}
.btn.tiny{padding:6px 8px;font-weight:700;border-radius:10px;font-size:0.92rem}
.btn.large{padding:12px 18px;font-size:1rem;border-radius:14px}
.btn.outline{background:transparent;border:1px solid rgba(15,23,42,0.06);color:var(--text);font-weight:700}
.btn.accent{background:linear-gradient(90deg,var(--accent), #34d399);color:#083325}

/* sold-out style */
.product-card.sold-out{
  opacity:0.62;filter:grayscale(0.2);pointer-events:none;
}

/* load more */
.load-more-wrap{text-align:center;margin:18px 0}
.load-more-wrap .btn{background:linear-gradient(90deg,var(--brand-2),var(--brand-1));}

/* no results */
.no-results{padding:38px;text-align:center;color:var(--muted)}

/* -------------------------
   PRODUCT MODAL
   -------------------------*/
.modal{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
  background:rgba(8,15,24,0.5);
  padding:20px;
  opacity:0;pointer-events:none;transition:opacity 220ms ease;
  z-index:120;
}
.modal.open{opacity:1;pointer-events:auto}
.modal-inner{
  width:100%;
  max-width:980px;
  background:linear-gradient(180deg,#fff,#fffefc);
  border-radius:18px;
  padding:16px;
  box-shadow:0 30px 60px rgba(10,20,30,0.2);
  position:relative;
}
.modal-close{position:absolute;right:14px;top:14px;border:0;background:transparent;padding:8px;border-radius:10px;cursor:pointer;color:var(--muted)}
.modal-grid{display:grid;grid-template-columns:1fr;gap:12px}
.modal-media{background:var(--card);border-radius:12px;padding:8px;display:flex;flex-direction:column;gap:8px}
#modal-gallery{min-height:260px;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center}
#modal-gallery img{max-width:100%;max-height:320px;object-fit:contain}
#modal-thumbs{display:flex;gap:8px;overflow:auto;padding:6px}
#modal-thumbs .thumb{height:64px;border-radius:8px;object-fit:cover;cursor:pointer;box-shadow:0 10px 30px rgba(16,24,40,0.06)}
.modal-info{padding:6px 6px 12px}
.modal-title{font-size:1.15rem;margin:0 0 6px 0}
.modal-price{font-weight:900;font-size:1.15rem;color:var(--brand-1);margin-bottom:8px}
.price-row{display:flex;gap:12px;align-items:center;margin-bottom:8px}
.availability{color:var(--success);font-weight:700;font-size:0.95rem}
.modal-desc{color:var(--muted);margin-bottom:12px}
.modal-controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.modal-controls label{font-weight:700;font-size:0.9rem}
.modal-controls select, .modal-controls input[type="number"]{padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);min-width:120px}
.modal-cta{display:flex;gap:8px;margin-left:auto}

/* modal meta */
.modal-meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);margin-top:12px}

/* -------------------------
   CART PANEL (slide out)
   -------------------------*/
.cart-panel{
  position:fixed;
  right:0;
  top:0;
  height:100%;
  width:100%;
  max-width:420px;
  background:linear-gradient(180deg,#fff,#fffefc);
  box-shadow:-20px 0 60px rgba(10,20,30,0.16);
  transform:translateX(110%);
  transition:transform 260ms cubic-bezier(.2,.9,.2,1);
  z-index:110;
  display:flex;
  flex-direction:column;
}
.cart-panel.open{transform:translateX(0)}
.cart-header{display:flex;align-items:center;justify-content:space-between;padding:14px;border-bottom:1px solid rgba(15,23,42,0.03)}
.cart-contents{padding:14px;flex:1;overflow:auto}
.cart-footer{padding:14px;border-top:1px solid rgba(15,23,42,0.03)}
.cart-item{display:flex;gap:12px;align-items:center;padding:8px;border-radius:10px;margin-bottom:10px;background:linear-gradient(180deg,rgba(255,255,255,0.9),rgba(255,255,255,0.95));box-shadow:var(--shadow)}
.cart-item-thumb{width:68px;height:68px;border-radius:10px;object-fit:cover}
.cart-item-info{flex:1}
.cart-item-title{display:block;font-weight:800}
.cart-item-meta{display:block;color:var(--muted);font-size:13px}
.cart-item-actions{display:flex;gap:6px;align-items:center}
.cart-item-qty{width:68px;padding:6px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)}
.cart-item-remove{background:transparent;border:0;color:var(--muted);cursor:pointer}

/* -------------------------
   CONTACT / FORMS
   -------------------------*/
.contact{margin:28px auto 60px}
.contact-grid{display:grid;gap:16px}
.contact-card{padding:16px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow)}
.contact-list{list-style:none;padding:0;margin:8px 0 0 0;color:var(--muted)}
.contact-list li{display:flex;gap:8px;align-items:center;padding:6px 0}
.contact-form{background:linear-gradient(180deg,#fff,#fffefc);padding:14px;border-radius:12px;box-shadow:var(--shadow)}
.contact-form .form-row{margin-bottom:10px}
.contact-form label{display:block;margin-bottom:6px;font-weight:700}
.contact-form input, .contact-form textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)}
.form-actions{display:flex;gap:8px;justify-content:flex-end}

/* -------------------------
   ABOUT / FEATURES
   -------------------------*/
.features-grid{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
.features-grid li{list-style:none;background:linear-gradient(180deg,#fff,#fffefc);padding:12px;border-radius:12px;box-shadow:var(--shadow);display:flex;gap:8px;align-items:center;font-weight:700;color:var(--muted)}

/* -------------------------
   FOOTER
   -------------------------*/
.site-footer{background:linear-gradient(180deg,#fffefc,#fff7f0);padding:24px 0;border-top:1px solid rgba(15,23,42,0.03)}
.footer-top{display:flex;gap:20px;flex-direction:column;padding-bottom:12px}
.footer-col{flex:1}
.footer-logo{display:inline-flex;gap:8px;align-items:center;text-decoration:none;color:var(--text);font-weight:800}
.socials a{display:inline-flex;margin-right:8px}
.newsletter-form{display:flex;gap:8px;margin-top:8px}
.newsletter-form input{padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);flex:1}
.footer-bottom{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px dashed rgba(15,23,42,0.03);gap:8px}

  /* Checkout modal specifics (stacked, polished) */
.checkout-modal { display:flex; align-items:center; justify-content:center; }
.checkout-modal .modal-inner { border-radius:18px; box-shadow:0 30px 60px rgba(10,20,30,0.22); }
.checkout-modal .checkout-item { display:flex; gap:10px; align-items:center; padding:8px; border-radius:10px; background:linear-gradient(180deg,#fff,#fffefc); box-shadow:var(--shadow); }
.checkout-modal .checkout-item img { width:64px; height:64px; object-fit:cover; border-radius:8px; }
.checkout-modal .checkout-item .meta { display:flex; flex-direction:column; gap:4px; }
.checkout-modal .checkout-item .meta .title { font-weight:800; }
.checkout-modal .checkout-item .meta .sub { color:var(--muted); font-size:13px; }
.checkout-modal .checkout-summary small { color:var(--muted); font-size:12px; }

  /* Ensure buynow modal matches checkout modal style */
#buynow-modal.checkout-modal .checkout-item { align-items:center; }
#buynow-modal .modal-inner { max-width:980px; }

  /* ---------- Compact mobile header: only logo + cart + hamburger ---------- */
@media (max-width: 720px) {

  /* tighten header height and spacing */
  .header-inner {
    height: 60px;
    padding: 6px 0;
    align-items: center;
    gap: 8px;
  }

  /* push logo to the left and icons to the right */
  .header-inner { display:flex; align-items:center; justify-content:space-between; }

  /* hide the desktop nav */
  .main-nav { display: none !important; }

  /* hide all header-actions children by default, show only cart & hamburger */
  .header-actions > * { display: none !important; }
  .header-actions { gap: 4px; }

  /* show cart + mobile toggle */
  .header-actions #cart-toggle,
  .header-actions #mobile-toggle,
  .header-actions .hamburger {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
  }

  /* make logo slightly smaller on phones */
  .site-logo { height:40px; }

  /* make the hamburger compact and visible */
  .hamburger{
    display:inline-flex !important;
    padding:8px;
    border-radius:10px;
  }

  /* ensure the mobile nav container is available but collapsed by max-height
     (we override inline display:none if present) */
  #mobile-nav { display: flex !important; }

  /* keep mobile-nav closed by default (max-height 0). When JS adds "open" it reveals */
  #mobile-nav { max-height: 0; overflow: hidden; transition: max-height 280ms ease; }
  #mobile-nav.open { max-height: 420px; }

  /* visually emphasize the cart icon */
  #cart-toggle { background: rgba(255,255,255,0.95); border-radius:10px; padding:8px; box-shadow: 0 6px 18px rgba(12,18,28,0.06); }
  #cart-toggle .badge { transform: translateY(-2px); }

  /* Reduce hero caption size a little so it doesn't crowd */
  .hero-caption { padding:12px; bottom:10px; left:10px; width:calc(100% - 20px); max-width:400px; }

  /* hide search field & large CTAs on mobile; keep layout neat */
  .search-wrap, .shop-controls .sort-wrap { display: none !important; }

  /* hide secondary header icons (search, etc.) that might remain */
  .icon-btn[aria-label="Search"], .header-actions .icon-btn:not(#cart-toggle) { display: none !important; }

  /* make product grid comfortable on narrow phones */
  .product-grid { gap:10px; grid-template-columns: 1fr; }

  /* reduce hero min-height on very small screens */
  .hero-slider { min-height: 220px; height: 45vh; }
}

/* optional: make the header compact also apply exactly at the breakpoint via a class
   (JS will toggle the 'compact-header' class for better control) */
.compact-header .main-nav { display: none !important; }
.compact-header .header-actions > * { display: none !important; }
.compact-header .header-actions #cart-toggle,
.compact-header .header-actions #mobile-toggle,
.compact-header .header-actions .hamburger { display:inline-flex !important; }
.compact-header .site-logo { height:40px; }

/* -------------------------
   TOAST
   -------------------------*/
.tiny-toast{
  position:fixed;left:50%;transform:translateX(-50%) translateY(6px);
  bottom:26px;
  background:rgba(20,20,20,0.92);
  color:white;padding:10px 16px;border-radius:999px;opacity:0;transition:all 220ms;z-index:999;
  box-shadow:0 8px 30px rgba(8,20,38,0.3);
}
.tiny-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

  /* LOGO specifics */
.logo{display:flex;align-items:center;gap:12px;text-decoration:none}
.site-logo{
  display:block;
  height:46px;           /* desktop size */
  width:auto;
  object-fit:contain;
  filter: drop-shadow(0 6px 18px rgba(0,0,0,0.08));
  transition: transform var(--transition);
}
.logo:hover .site-logo{ transform: translateY(-3px) scale(1.02); }

/* If you want a small text label next to the logo (optional) */
.brand-name{
  font-weight:800;
  font-size:1.05rem;
  color:var(--text);
  letter-spacing:0.2px;
}
/* -------------------------
   SMALLER SIZING / RESPONSIVE
   -------------------------*/
@media (min-width:520px){
  .product-grid{grid-template-columns: repeat(2, 1fr)}
  .hero-caption{left:24px;bottom:24px;width:46%}
  .hero-slider{min-height:360px}
  .hero-media img{transform:scale(1.03)}
  .modal-grid{grid-template-columns: 1fr 1fr}
  .modal-inner{padding:18px}
  .contact-grid{grid-template-columns: 1fr 1fr}
  .footer-top{flex-direction:row}
  .header-inner{height:76px}
  .main-nav .nav-list{gap:18px}
}
.cart-item-title.clickable { cursor: pointer; display:inline-block; }
.cart-item-title.clickable:hover { text-decoration: underline; color: var(--brand-1); }
.cart-item-thumb { cursor: pointer; }
.cart-item[role="group"]:focus { outline: none; box-shadow: var(--focus); border-radius: 10px; }

@media (min-width:880px){
  .product-grid{grid-template-columns: repeat(3, 1fr)}
  .hero-slider{min-height:420px}
  .hero-caption{max-width:620px}
  .header-inner{height:84px}
}

@media (min-width:1100px){
  .product-grid{grid-template-columns: repeat(4, 1fr)}
  .hero-slider{min-height:500px}
  .modal-inner{max-width:1100px}
  .modal-grid{grid-template-columns:1fr 1fr}
}

/* Accessibility focus states */
a:focus, button:focus, input:focus, select:focus, textarea:focus{
  outline:none;box-shadow:var(--focus);
}
/* small header checkout button */
.cart-header .checkout-header-btn {
  padding: 8px 10px;
  border-radius: 10px;
  font-weight: 700;
  display: inline-flex;
  gap: 8px;
  align-items: center;
}
.cart-header .checkout-header-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* -------------------------
   Subtle micro animations
   -------------------------*/
@keyframes floaty {
  0%{ transform:translateY(0) }
  50%{ transform:translateY(-6px) }
  100%{ transform:translateY(0) }
}
.btn.large{animation:floaty 4s ease-in-out infinite}

/* small helpers */
.lead-strong{font-weight:800}
.center{text-align:center}
.kv{display:flex;align-items:center;gap:8px}

/* -------------------------
   END
   -------------------------*/
</style>
<style> /* HERO: force hero slider to occupy half the viewport */
:root {
  --header-space: 84px; /* change if your header-inner height differs */
}

.hero-slider {
  height: 50vh !important;       /* half the viewport */
  min-height: 220px;             /* fallback on very small screens */
  max-height: 60vh;
  border-radius: var(--radius-lg);
  display: block;
  overflow: hidden;
}

/* make slide children fill that height */
.hero-slider .slide,
.hero-slider .slide-inner,
.hero-media,
.hero-media img {
  height: 100% !important;
}

/* adjust caption positioning to fit smaller height */
.hero-caption {
  bottom: 12px;
  left: 12px;
  padding: 14px;
  width: calc(100% - 32px);
  max-width: 520px;
}
/* =========================
   Mobile UX improvements (phones)
   ========================= */

/* Make hamburger easier to tap and above other UI */
.hamburger{
  touch-action: manipulation;
  -webkit-tap-highlight-color: rgba(0,0,0,0.0);
  z-index: 140; /* above modals/nav */
  padding: 10px 12px;   /* larger hit area */
  font-size: 18px;
}

/* ensure the hamburger icon has visible tap target */
.hamburger .fa-bars { font-size: 20px; }

/* ---------- Phone-specific layout tweaks ---------- */
@media (max-width: 720px) {

  /* 2b: Make shop grid 2 columns on phones (2x2 viewport feel) */
  .product-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 10px;
  }

  /* Make product card contents breathe better in 2-column layout */
  .product-card { padding: 10px; border-radius: 12px; }
  .product-media { padding-top: 66%; } /* balance aspect in smaller columns */

  /* 2c: Enlarge modal & cart close buttons on phones */
  .modal .modal-close,
  .cart-close,
  #checkout-modal .modal-close,
  #buynow-modal .modal-close {
    font-size: 20px;
    padding: 10px;
    border-radius: 12px;
    background: rgba(255,255,255,0.98);
    box-shadow: 0 8px 22px rgba(10,20,30,0.06);
    color: var(--muted);
  }
  .modal .modal-close:focus,
  .cart-close:focus { box-shadow: var(--focus); }

  /* Increase the close icon's clickable area */
  .modal .modal-close i,
  .cart-close i { pointer-events: none; }

  /* 2d: Checkout & BuyNow modal — stack vertically on phones */
  #checkout-modal .modal-inner > div,
  #buynow-modal .modal-inner > div {
    display: grid;
    grid-template-columns: 1fr !important;
    gap: 12px;
  }
  #checkout-modal .modal-inner aside,
  #buynow-modal .modal-inner aside {
    width: 100% !important;
    max-width: none !important;
    box-sizing: border-box;
  }

  /* Make checkout summary area full width and pinned below item list */
  #checkout-modal .modal-inner aside,
  #buynow-modal .modal-inner aside {
    order: 2;
  }
  #checkout-modal .modal-inner > div > :first-child,
  #buynow-modal .modal-inner > div > :first-child {
    order: 1;
  }

  /* Ensure checkout modal is full height scrollable and comfortable on phones */
  #checkout-modal .modal-inner,
  #buynow-modal .modal-inner {
    max-height: calc(100vh - var(--header-space, 84px));
    overflow: auto;
    padding: 14px;
    border-radius: 14px;
  }

  /* Increase CTA sizes inside checkout on phones */
  #checkout-pay, #buynow-pay {
    width: 100%;
    padding: 12px;
    font-size: 1rem;
  }

  /* Make 'Continue shopping' button inside empty cart look tappable */
  .cart-empty .btn { padding: 10px 14px; border-radius: 12px; }

  /* Slightly increase cart toggle sizing */
  #cart-toggle { padding: 10px !important; border-radius: 12px; font-size: 18px; }

  /* Reduce hero caption overlay on very small screens if needed */
  .hero-caption { max-width: 95%; padding: 10px; }

}

</style>
  <style>
    :root {
  /* keep your fallback — JS will update this on load */
  --header-space: 84px;
}

/* make header fixed at the top (replaces previous sticky behavior) */
.site-header{
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 120; /* above most UI elements */
  backdrop-filter: blur(6px);
  background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.85));
  border-bottom: 1px solid rgba(15,23,42,0.04);
  box-shadow: 0 6px 18px rgba(18,24,36,0.03);
}

/* push page content below the fixed header */
body {
  /* keep the existing rules, but add this line: */
  padding-top: var(--header-space);
}

/* cart panel should start below the header and span the rest of the viewport */
.cart-panel{
  position: fixed;
  right: 0;
  top: var(--header-space);                  /* start below header */
  height: calc(100% - var(--header-space));  /* full height minus header */
  width: 100%;
  max-width: 420px;
  background: linear-gradient(180deg,#fff,#fffefc);
  box-shadow: -20px 0 60px rgba(10,20,30,0.16);
  transform: translateX(110%);
  transition: transform 260ms cubic-bezier(.2,.9,.2,1);
  z-index: 110;
  display: flex;
  flex-direction: column;
}
.cart-panel.open{ transform: translateX(0); }

  </style>
  <style>
/* ============ Mobile improvements (phones ≤ 720px) ============ */
@media (max-width:720px) {
  /* 2.a — make hamburger reliably tappable + visible */
  #mobile-toggle, .hamburger {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
    padding: 12px !important;
    border-radius: 12px !important;
    min-width: 44px;
    min-height: 44px;
    touch-action: manipulation;
    z-index: 140; /* above header content so taps register */
    -webkit-tap-highlight-color: rgba(0,0,0,0.06);
  }
  #mobile-toggle .fa-bars, .hamburger .fa-bars { font-size: 20px !important; }

  /* 2.b — shop dresses: show 2 columns on phones (2x2 visible when scrolling) */
  .product-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 10px !important;
  }

  /* make product cards breathe on tiny screens */
  .product-card { border-radius: 12px; }

  /* 2.c — bigger close buttons so they're easier to tap on phones */
  .modal-close, .cart-close, #checkout-modal .modal-close, #buynow-modal .modal-close {
    padding: 10px 12px !important;
    font-size: 18px !important;
    border-radius: 12px !important;
    min-width: 44px;
    min-height: 44px;
    box-shadow: 0 8px 20px rgba(8,20,38,0.08);
  }

  /* make icon-only close buttons have higher hit area */
  .modal .modal-close i, .cart-close i { pointer-events: none; }

  /* 2.d — stack checkout modal vertically on phones */
  /* override inline grid from HTML using !important */
  #checkout-modal .modal-inner > div,
  #buynow-modal .modal-inner > div {
    grid-template-columns: 1fr !important;
    align-items: stretch;
  }
  /* make sidebar area full-width and appear below items */
  #checkout-modal .modal-inner aside,
  #buynow-modal .modal-inner aside {
    width: 100% !important;
    max-width: none !important;
    margin-top: 12px;
  }
  /* ensure modal inner is scrollable vertically and not horizontally */
  #checkout-modal .modal-inner, #buynow-modal .modal-inner {
    max-width: 92vw !important;
    padding: 12px !important;
    overflow: auto !important;
  }

  /* tighten hero caption so it doesn't overlap */
  .hero-caption { max-width: 60%; }

  /* ensure mobile nav is visible and animation is smooth */
  #mobile-nav { display: flex !important; transition: max-height 260ms ease; }
  #mobile-nav.open { max-height: 520px !important; }

  /* enlarge cart button target as well */
  #cart-toggle { padding: 10px !important; min-width: 44px; min-height: 44px; border-radius: 10px; }
  #cart-toggle .fa-shopping-cart { font-size: 18px !important; }

  /* spacing fixes for product-body elements */
  .product-body { padding: 10px !important; }
}
</style>
<style>
/* === Task 3: Bigger header cart icon & badge === */

/* make the cart button larger and more tappable (desktop + mobile) */
.header-actions #cart-toggle {
  padding: 10px 14px !important;    /* larger hit area */
  min-width: 52px !important;
  min-height: 52px !important;
  border-radius: 12px !important;
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
  box-shadow: 0 8px 24px rgba(12,18,28,0.06);
  transition: transform 160ms ease, box-shadow 160ms ease;
}

/* slightly grow on hover/focus for visual affordance */
.header-actions #cart-toggle:hover,
.header-actions #cart-toggle:focus {
  transform: translateY(-3px) scale(1.03);
  box-shadow: 0 12px 30px rgba(12,18,28,0.10);
  outline: none;
}

/* bigger cart glyph */
.header-actions #cart-toggle .fa-shopping-cart {
  font-size: 20px !important; /* desktop */
  line-height: 1;
}

/* badge: larger, more legible */
#cart-badge {
  min-width: 22px !important;
  height: 22px !important;
  padding: 2px 7px !important;
  font-size: 12px !important;
  border-radius: 999px !important;
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(12,18,28,0.08);
}

/* slightly larger for small screens too */
@media (max-width:720px) {
  .header-actions #cart-toggle { padding: 10px !important; min-width:48px !important; min-height:48px !important; }
  .header-actions #cart-toggle .fa-shopping-cart { font-size: 18px !important; }
  #cart-badge { min-width:20px; height:20px; font-size:11px; padding:2px 6px; }
}
</style>
<style>
/* Header search toggle: reveal the shop search on mobile and provide a neat overlay */
body.search-open {
  /* nothing visual by itself; we target the search wrap */
}

/* when search-open is active, show the hidden .search-wrap (mobile override) */
body.search-open .search-wrap {
  display: flex !important;
  position: fixed !important;
  left: 8px !important;
  right: 8px !important;
  top: calc(var(--header-space) + 8px) !important;
  z-index: 220 !important;
  padding: 8px !important;
  border-radius: 12px !important;
  box-shadow: 0 14px 40px rgba(8,20,38,0.12) !important;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.92)) !important;
  align-items: center;
}

/* make the search input wider when overlay active */
body.search-open .search-wrap input[type="search"] {
  width: 100% !important;
  min-width: 140px !important;
  padding: 12px 10px !important;
  font-size: 1rem !important;
}

/* subtle dim behind the header when search is open on mobile (non-invasive) */
body.search-open::before{
  content: "";
  position: fixed;
  inset: 0;
  top: calc(var(--header-space) + 8px);
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(8,15,24,0.18);
  z-index: 210;
  pointer-events: none;
}

/* ensure clear button sits nicely in overlay */
body.search-open #search-clear {
  z-index: 230;
}

/* keep layout consistent on desktop (no visual change) */
@media (min-width:721px) {
  body.search-open .search-wrap { position: static; box-shadow: none; top: auto; left: auto; right: auto; }
  body.search-open::before { display:none; }
}
</style>
<style>
/* ====== Checkout modal: new beautiful style & responsive behavior ====== */
.checkout-modal { z-index:140; display:none; }
.checkout-modal.open { display:flex; }

.checkout-modal .modal-inner {
  width:100%;
  max-width:980px;
  margin:24px auto;
  background: linear-gradient(180deg,#fffefc,#ffffff);
  border-radius:20px;
  padding:18px;
  position:relative;
  box-shadow: 0 30px 80px rgba(16,24,40,0.18);
  overflow: hidden;
  transform-origin: center;
  animation: modalPop 360ms cubic-bezier(.2,.9,.3,1);
  border: 1px solid rgba(15,23,42,0.04);
}

/* entrance */
@keyframes modalPop {
  from { opacity:0; transform: translateY(8px) scale(0.985); }
  to { opacity:1; transform: translateY(0) scale(1); }
}

/* sticker decorations */
.checkout-modal .sticker {
  position:absolute;
  width:72px;height:72px;border-radius:14px;
  display:flex;align-items:center;justify-content:center;
  box-shadow: 0 10px 30px rgba(16,24,40,0.08);
  pointer-events:none; transform: translateZ(0);
}
.checkout-modal .sticker--left {
  left: -18px; top: -18px;
  background: linear-gradient(135deg,var(--brand-1),var(--brand-2));
  color:white; transform: rotate(-8deg);
  animation: floatySt 4200ms ease-in-out infinite;
}
.checkout-modal .sticker--right {
  right: -18px; bottom: -18px;
  background: linear-gradient(135deg,var(--accent),#34d399);
  color:white; transform: rotate(6deg);
  animation: floatySt 5600ms ease-in-out infinite;
}
@keyframes floatySt {
  0% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-8px) rotate(3deg); }
  100% { transform: translateY(0) rotate(0deg); }
}

/* content layout: details first, items below */
.checkout-inner {
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* details card */
.checkout-details {
  background: linear-gradient(180deg,#ffffff,#fffaf8);
  border-radius:12px;
  padding:14px;
  box-shadow: var(--shadow);
  display:grid;
  grid-template-columns: 1fr 220px;
  gap:12px;
  align-items:start;
}

/* left: form fields; right: mini summary */
.checkout-form { display:flex; flex-direction:column; gap:10px; }
.checkout-form .row { display:flex; gap:8px; }
.checkout-form input[type="text"], .checkout-form input[type="email"], .checkout-form input[type="tel"], .checkout-form input[type="number"], .checkout-form select, .checkout-form textarea {
  width:100%; padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06); font-size:0.95rem;
}
.checkout-form textarea { min-height:80px; resize:vertical; }

.checkout-summary-card {
  background: linear-gradient(180deg,#fff,#fffefc);
  padding:12px;border-radius:10px; box-shadow:var(--shadow);
  position:sticky; top:16px; align-self:start;
  min-width:200px;
}

/* items area below */
.checkout-items-wrap {
  display:flex;
  gap:16px;
  align-items:flex-start;
  flex-direction:column;
}
.checkout-items-list {
  display:flex;
  flex-direction:column;
  gap:10px;
  max-height:38vh;
  overflow:auto;
  padding-right:6px;
}
.checkout-item {
  display:flex; gap:12px; align-items:center;
  padding:8px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffefc);border:1px solid rgba(15,23,42,0.03);
}
.checkout-item img { width:64px;height:64px;border-radius:8px; object-fit:cover; }
.checkout-item .meta { font-weight:700; color:var(--text) }
.checkout-item .meta small { display:block;color:var(--muted); font-weight:600; font-size:12px }

/* totals block (keeps visible on right or below on mobile) */
.checkout-totals {
  display:flex; flex-direction:column; gap:8px; margin-top:6px;
}
.checkout-totals .row { display:flex; justify-content:space-between; align-items:center; }
.checkout-totals .total { font-size:1.15rem; font-weight:900; color:var(--brand-1) }

/* action area */
.checkout-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:6px; }
.checkout-actions .btn { min-width:120px; }

/* mobile responsiveness */
@media (max-width: 880px) {
  .checkout-details { grid-template-columns: 1fr; }
  .checkout-summary-card { position:relative; top:auto; min-width:unset; }
  .checkout-item img { width:56px;height:56px; }
  .checkout-inner { gap:12px; }
}

/* ensure modal fits inside viewport and doesn't get covered by header/footer */
.checkout-modal .modal-inner {
  max-height: calc(100vh - var(--header-space,84px) - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 32px);
  overflow:auto;
  margin: 12px;
}

/* make pay button full-width on small screens */
@media (max-width:720px) {
  .checkout-actions { flex-direction:column; align-items:stretch; }
  .checkout-actions .btn { width:100%; }
  .checkout-summary-card { order: 2; }
  .checkout-items-list { max-height: 36vh; }
}

/* small accessibility + focus */
.checkout-form input:focus, .checkout-form select:focus, .checkout-form textarea:focus { outline:none; box-shadow: var(--focus); }

/* hide the legacy small processing text if present */
.checkout-hide-processing-note small { display:none !important; }
</style>
<style>
/* ===== Receipt modal: beautiful, responsive & scrollable ===== */
.receipt-modal { z-index:1500; display:none; }
.receipt-modal.open { display:flex; }

.receipt-modal .modal-inner {
  width:100%;
  max-width:920px;
  margin:16px auto;
  border-radius:16px;
  padding:14px;
  position:relative;
  background: linear-gradient(180deg,#fffefc,#ffffff);
  box-shadow: 0 30px 70px rgba(12,18,28,0.12);
  border: 1px solid rgba(15,23,42,0.04);
  animation: receiptPop 360ms cubic-bezier(.2,.9,.3,1);
  overflow: hidden;
}

/* entrance */
@keyframes receiptPop {
  from { opacity:0; transform: translateY(8px) scale(0.995); }
  to { opacity:1; transform: translateY(0) scale(1); }
}

/* stickers & badges */
.receipt-modal .sticker {
  position:absolute; width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center; color:#fff;
  box-shadow: 0 10px 30px rgba(12,18,28,0.08); pointer-events:none;
}
.receipt-modal .sticker.left { left:-14px; top:-14px; background: linear-gradient(135deg,var(--brand-1),var(--brand-2)); transform: rotate(-8deg); }
.receipt-modal .sticker.right { right:-14px; bottom:-14px; background: linear-gradient(135deg,var(--accent),#34d399); transform: rotate(6deg); }

/* layout */
.receipt-grid { display:grid; grid-template-columns: 1fr 320px; gap:14px; align-items:start; }
.receipt-left { display:flex; flex-direction:column; gap:12px; }
.receipt-right { position:relative; }

/* summary & items */
.receipt-summary { background:linear-gradient(180deg,#fff,#fffefc); padding:12px; border-radius:10px; box-shadow:var(--shadow); }
.receipt-meta { display:flex; gap:12px; align-items:center; justify-content:space-between; }
.receipt-badge { background: linear-gradient(90deg,var(--brand-1),var(--brand-2)); color:#fff; padding:6px 10px; border-radius:999px; font-weight:800; box-shadow:0 8px 28px rgba(255,107,138,0.08); }

/* items list */
.receipt-items { display:flex; flex-direction:column; gap:10px; max-height:44vh; overflow:auto; padding-right:6px; }
.receipt-item { display:flex; gap:10px; align-items:center; padding:10px; border-radius:10px; border:1px solid rgba(15,23,42,0.03); background:linear-gradient(180deg,#fff,#fffefc); }
.receipt-item img { width:64px; height:64px; border-radius:8px; object-fit:cover; }
.receipt-item .it-meta { flex:1; }
.receipt-item .it-price { text-align:right; min-width:96px; font-weight:800; }

/* preview area */
.receipt-preview-wrap { margin-top:10px; border-radius:10px; overflow:hidden; border:1px solid rgba(15,23,42,0.06); background:#fff; }
.receipt-iframe {
  width:100%;
  height:56vh;
  min-height:280px;
  border:0;
  display:block;
}

/* loader overlay inside preview */
.preview-loader {
  position:absolute; left:0; right:0; top:0; bottom:0; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.6);
}

/* actions */
.receipt-actions { display:flex; gap:8px; flex-direction:column; }
.receipt-actions .btn { width:100%; }

/* responsive */
@media (max-width:880px) {
  .receipt-grid { grid-template-columns: 1fr; }
  .receipt-right { order:2; }
  .receipt-preview-wrap .receipt-iframe { height:48vh; min-height:220px; }
  .receipt-items { max-height:32vh; }
  .receipt-actions { flex-direction:row; gap:8px; }
  .receipt-actions .btn { flex:1; }
}

/* ensure modal fits view and respects header/footer */
.receipt-modal .modal-inner {
  max-height: calc(100vh - var(--header-space,84px) - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 24px);
  overflow:auto;
}

/* accessibility focus */
.receipt-modal .modal-inner a:focus, .receipt-modal .modal-inner button:focus, .receipt-modal .modal-inner input:focus { outline:none; box-shadow:var(--focus); }
</style>
<style>
/* History button & modal */
#history-toggle { padding: 10px 12px !important; border-radius: 12px !important; min-width:48px; min-height:48px; display:inline-flex; align-items:center; justify-content:center; }
#history-toggle .fa-history { font-size:18px; }
#history-badge { min-width:18px; height:18px; padding:2px 6px; font-size:11px; margin-left:6px; }

/* History Modal */
#history-modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(8,15,24,0.5); z-index: 1400; padding: 16px; }
#history-modal.open { display: flex; }
#history-modal .modal-inner {
  width: 100%; max-width: 920px; border-radius: 14px; background: linear-gradient(180deg,#fffefc,#ffffff);
  box-shadow: 0 30px 80px rgba(12,18,28,0.12); padding: 14px; max-height: calc(100vh - var(--header-space,84px) - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  overflow:auto;
}

/* history list */
.history-list { display:flex; flex-direction:column; gap:12px; margin-top:10px; }
.history-item { display:flex; gap:12px; align-items:center; justify-content:space-between; padding:10px; border-radius:12px; background:linear-gradient(180deg,#fff,#fffefc); border:1px solid rgba(15,23,42,0.04); box-shadow: var(--shadow); }
.history-left { display:flex; gap:10px; align-items:center; min-width:0; }
.history-thumb { width:64px; height:64px; border-radius:8px; object-fit:cover; background:linear-gradient(90deg,var(--brand-2),var(--brand-1)); display:flex; align-items:center; justify-content:center; color:#fff; font-weight:800; }
.history-meta { min-width:0; overflow:hidden; }
.history-meta .title { font-weight:800; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }
.history-meta .sm { color:var(--muted); font-size:13px; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }

.history-actions { display:flex; gap:8px; align-items:center; }
.history-actions .btn { white-space:nowrap; }

/* responsive */
@media (max-width:720px) {
  #history-modal .modal-inner { width: 96vw; padding:12px; border-radius:12px; }
  .history-item { flex-direction:column; align-items:flex-start; gap:8px; }
  .history-actions { width:100%; display:flex; gap:8px; }
  .history-actions .btn { flex:1; }
}
</style>
<style>
/* Contact section: professional, compact and responsive */
.contact-card { padding:16px; border-radius:12px; background:linear-gradient(180deg,#fff,#fffefc); box-shadow:var(--shadow); border:1px solid rgba(15,23,42,0.04); }
.contact-card--info { transition: transform var(--transition); }
.contact-card--info:hover { transform: translateY(-4px); }

.contact-list.styled { list-style:none;padding:0;margin:6px 0 0 0; display:flex;flex-direction:column; gap:8px; }
.contact-list.styled li { margin:0; }

/* contact action buttons (phone/whatsapp/email) */
.contact-action {
  display:flex;align-items:center;gap:12px;width:100%;border:0;padding:10px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);cursor:pointer;
  box-shadow:0 8px 20px rgba(12,18,28,0.04); transition:all var(--transition); text-align:left;
}
.contact-action:hover, .contact-action:focus { transform: translateY(-3px); box-shadow: 0 14px 40px rgba(12,18,28,0.06); outline:none; }
.contact-action .ci { width:42px;height:42px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:white; font-size:16px; flex-shrink:0; }
.contact-action .ct { flex:1; min-width:0; }
.contact-action .ct-title { font-weight:800; font-size:0.98rem; color:var(--text); }
.contact-action .ct-sub { color:var(--muted); font-size:0.9rem; }
.contact-action .cta { font-weight:700; color:var(--brand-1); font-size:0.9rem; }

/* social icons (compact) */
.contact-socials a { display:inline-flex; align-items:center; justify-content:center; width:40px;height:40px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc); border:1px solid rgba(15,23,42,0.03); margin-right:8px; color:var(--muted); transition:all var(--transition); }
.contact-socials a:hover { transform:translateY(-4px); color:var(--brand-1); box-shadow: 0 10px 30px rgba(16,24,40,0.06); }

/* form styling */
.contact-form .form-row { margin-bottom:10px; }
.form-label { display:block; margin-bottom:6px; font-weight:700; font-size:0.92rem; }
.contact-form input, .contact-form textarea, .contact-form select {
  width:100%; padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06); font-size:0.95rem; outline:none; transition:box-shadow var(--transition);
}
.contact-form input:focus, .contact-form textarea:focus, .contact-form select:focus { box-shadow:var(--focus); }

.row-2 { display:flex; gap:10px; }
@media (max-width:720px) {
  .row-2 { flex-direction:column; }
}

/* small responsive tweaks */
#contact { margin:28px auto 60px; }
@media (max-width:880px) {
  #contact .contact-card, #contact .contact-form { width:100%; }
  #contact > div { flex-direction:column; gap:12px; }
}
</style>
<style>
/* ===== Task 6: Professional footer styles ===== */
.site-footer {
  background: linear-gradient(180deg,#fffefc,#fff7f0);
  border-top: 1px solid rgba(15,23,42,0.03);
  padding: 28px 0 36px;
  color: var(--text);
  font-size: 14px;
  position: relative;
  z-index: 20;
}

/* container inside footer */
.footer-grid {
  display: grid;
  grid-template-columns: 1.6fr 1fr 1fr 1.2fr;
  gap: 18px;
  width:90%; max-width: var(--max-width);
  margin: 0 auto;
  align-items:start;
}

/* brand area */
.footer-brand {
  display:flex; gap:12px; align-items:flex-start;
}
.footer-brand .logo-badge {
  width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center;
  background: linear-gradient(90deg,var(--brand-1),var(--brand-2)); color:white; font-weight:800;
  box-shadow: 0 10px 30px rgba(255,107,138,0.08);
}
.footer-brand .brand-copy { color:var(--muted); margin-top:6px; font-size:0.95rem; }

/* link columns */
.footer-col h4 { margin:0 0 8px 0; font-size:1rem; color:var(--text); }
.footer-links { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px; }
.footer-links a { color:var(--muted); text-decoration:none; display:inline-flex; gap:8px; align-items:center; padding:6px; border-radius:8px; transition:all 180ms; }
.footer-links a:hover { color:var(--text); transform:translateY(-3px); background: linear-gradient(90deg, rgba(255,107,138,0.03), rgba(255,209,102,0.03)); }

/* contact & newsletter */
.footer-newsletter { display:flex; flex-direction:column; gap:8px; }
.footer-newsletter form { display:flex; gap:8px; align-items:center; }
.footer-newsletter input[type="email"] {
  padding:10px 12px; border-radius:10px; border:1px solid rgba(15,23,42,0.06); flex:1; font-size:0.95rem;
}
.footer-newsletter .btn { padding:10px 12px; border-radius:10px; }

/* social icons row */
.footer-socials { display:flex; gap:8px; margin-top:6px; }
.footer-socials a { display:inline-flex; align-items:center; justify-content:center; width:44px;height:44px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);border:1px solid rgba(15,23,42,0.04); color:var(--muted); transition:all 160ms; }
.footer-socials a:hover { color:var(--brand-1); transform:translateY(-4px); box-shadow:0 10px 30px rgba(16,24,40,0.06); }

/* payment badges (placeholders) */
.footer-payments { display:flex; gap:8px; align-items:center; margin-top:10px; }
.payment-badge { display:inline-flex; align-items:center; justify-content:center; min-width:48px; height:32px; border-radius:8px; background:linear-gradient(180deg,#fff,#fffefc); border:1px solid rgba(15,23,42,0.04); padding:6px 8px; color:var(--muted); font-weight:700; font-size:12px; }

/* bottom legal row */
.footer-bottom {
  width:90%; max-width:var(--max-width); margin:12px auto 0; display:flex; justify-content:space-between; align-items:center; gap:12px;
  padding-top:12px; border-top:1px dashed rgba(15,23,42,0.03);
}
.legal { display:flex; gap:12px; list-style:none; margin:0; padding:0; color:var(--muted); }
.legal a { color:var(--muted); text-decoration:none; }
.legal a:hover { color:var(--text); text-decoration:underline; }

/* small attribution */
.footer-copyright { color:var(--muted); font-size:13px; }

/* back-to-top button */
#back-to-top {
  position: fixed;
  right: 18px;
  bottom: 18px;
  z-index: 220;
  width:48px; height:48px; border-radius:12px;
  display:flex; align-items:center; justify-content:center; background:linear-gradient(90deg,var(--brand-1),var(--brand-2));
  color:white; box-shadow: 0 10px 30px rgba(255,107,138,0.12); border:0; cursor:pointer;
  transition: transform 180ms ease, opacity 160ms;
  opacity: 0; pointer-events: none;
}
#back-to-top.show { opacity:1; pointer-events:auto; transform: translateY(0); }
#back-to-top:focus { outline:none; box-shadow:var(--focus); }

/* responsive */
@media (max-width:1100px) {
  .footer-grid { grid-template-columns: 1fr 1fr; gap:14px; }
}
@media (max-width:720px) {
  .footer-grid { grid-template-columns: 1fr; gap:12px; }
  .footer-brand .brand-copy { font-size:0.92rem; }
  .footer-newsletter form { flex-direction:column; align-items:stretch; }
  .footer-newsletter .btn { width:100%; }
}

/* subtle micro animation */
.footer-links a i { width:18px; display:inline-block; text-align:center; }
</style>
<style>
/* ----------------------------
   GLOBAL RESPONSIVE HELPERS
   ----------------------------*/

/* ensure header-space available; JS also sets it dynamically but keep a safe fallback */
:root {
  --header-space: 84px;
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

/* make images & media fluid by default */
img, picture, video, iframe { max-width:100%; height:auto; display:block; }

/* default responsive typography (use clamp to scale a little) */
h1 { font-size: clamp(1.25rem, 2.2vw, 1.8rem); }
h2 { font-size: clamp(1.05rem, 1.8vw, 1.5rem); }
p, li, small, button { font-size: clamp(0.95rem, 1.2vw, 1rem); }

/* touch-friendly: ensure interactive elements large enough on mobile */
button, .icon-btn, .hamburger, .cart-close, .modal-close {
  min-height:44px;
  min-width:44px;
  padding: 10px;
}

/* reduce layout thrash on small screens */
.container, .footer-grid { width: min(92%, var(--max-width)); margin-inline:auto; }

/* modal inner: never exceed viewport and respect header safe areas */
.modal .modal-inner,
.checkout-modal .modal-inner,
.receipt-modal .modal-inner,
#history-modal .modal-inner {
  max-height: calc(100vh - var(--header-space) - var(--safe-top) - var(--safe-bottom) - 24px);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* ensure any iframe preview is comfortably tall on phones */
.receipt-iframe {
  min-height: 40vh;
  height: clamp(260px, 48vh, 640px);
}

/* ----------------------------
   GRID / PRODUCT LAYOUT
   ----------------------------*/

/* mobile-first: base defined already (1 column). Now breakpoints expand columns */
@media (min-width:520px) {
  .product-grid { grid-template-columns: repeat(2, 1fr); gap:12px; }
  .contact-grid{ grid-template-columns: repeat(2, 1fr); gap:16px; }
}

@media (min-width:880px) {
  .product-grid { grid-template-columns: repeat(3, 1fr); gap:14px; }
  .hero-caption { left: 28px; bottom:28px; max-width:46%; }
  .modal-grid { grid-template-columns: 1fr 420px; gap:18px; }
}

/* large screens: 4 columns */
@media (min-width:1100px) {
  .product-grid { grid-template-columns: repeat(4, 1fr); gap:16px; }
  .modal-inner { max-width: 1100px; }
}

/* very large wide screens: add spacing */
@media (min-width:1400px) {
  .container { max-width: 1300px; }
  .product-grid { gap:18px; }
}

/* ensure product cards retain comfortable padding on tiny screens */
@media (max-width:420px) {
  .product-card { padding:8px; border-radius:10px; }
  .product-media { padding-top:72%; }
}

/* ----------------------------
   HEADER / NAV RESPONSIVENESS
   ----------------------------*/

/* when compact header toggled (JS toggles .compact-header) */
.compact-header .main-nav { display:none !important; }
.compact-header .header-actions > * { display:none !important; }
.compact-header .header-actions #cart-toggle,
.compact-header .header-actions #mobile-toggle,
.compact-header .header-actions .hamburger { display:inline-flex !important; }

/* mobile nav & search overlay fixes */
@media (max-width:720px) {
  .site-header { height: auto; padding: 8px 0; }
  body { padding-top: calc(var(--header-space)); } /* keep content below header (JS adjusts var) */
  .main-nav, .hero-controls { display:none; }
  #mobile-nav { display:flex !important; transition: max-height 240ms ease; overflow:hidden; }
  #mobile-nav.open { max-height:520px; }

  /* ensure header buttons are visible */
  .header-actions #history-toggle, .header-actions #cart-toggle { display:inline-flex !important; }
}

/* prevent header overlap on landscape phones: increase modal top gap */
@media (orientation: landscape) and (max-height:420px) {
  .modal .modal-inner, .checkout-modal .modal-inner { max-height: calc(100vh - var(--header-space) - 12px); padding:12px; }
}

/* ----------------------------
   CART PANEL & SLIDE-OUTS
   ----------------------------*/
@media (max-width:920px) {
  .cart-panel { max-width: 100%; width:100%; right:0; top:var(--header-space); height: calc(100% - var(--header-space)); }
  .cart-panel .cart-header { padding:12px; }
  .cart-contents { padding:12px; }
}
@media (min-width:921px) {
  .cart-panel { width:100%; max-width:420px; }
}

/* ----------------------------
   MODALS: stacking & scroll behavior
   ----------------------------*/
/* ensure stacked modals on narrow screens are full-width and scrollable */
@media (max-width:720px) {
  .modal { align-items:flex-start; padding:12px; }
  .modal .modal-inner { width:92vw; margin:8px auto; border-radius:12px; padding:14px; }
  .modal .modal-inner:focus { outline:none; }
  .checkout-details, .receipt-grid { grid-template-columns: 1fr !important; }
}

/* keep focus trap & keyboard accessibility: highlight focused modal close */
.modal .modal-close:focus { box-shadow: var(--focus); }

/* prevent body from scrolling when modal open - add class via JS if needed */
body.modal-open { overflow: hidden; touch-action: none; }

/* ----------------------------
   FORMS & TAP TARGETS
   ----------------------------*/
input, select, textarea, .btn { min-height:44px; }
.form-actions { gap:10px; display:flex; flex-wrap:wrap; justify-content:flex-end; }
@media (max-width:720px) {
  .form-actions { flex-direction:column; align-items:stretch; }
  .form-actions .btn { width:100%; }
}

/* ----------------------------
   HERO / SLIDER RESPONSIVENESS
   ----------------------------*/
.hero-slider {
  height: clamp(200px, 48vh, 600px);
  min-height:220px;
  max-height: 75vh;
}
.hero-caption { padding: clamp(10px, 1.5vw, 18px); }

/* ----------------------------
   RECEIPT / PDF PRINT RULES
   ----------------------------*/
@media print {
  /* minimize UI clutter */
  body * { visibility: hidden; }
  .receipt-iframe, #receipt-preview, #receipt-preview * { visibility: visible; }
  #receipt-preview { position: absolute; top:0; left:0; width:100%; height:100%; }
  /* ensure invoices print in portrait A4 */
  @page { size: A4 portrait; margin: 12mm; }
}

/* ----------------------------
   FOOTER / CONTACT / GET IN TOUCH
   ----------------------------*/
@media (max-width:880px) {
  .footer-grid { grid-template-columns: 1fr 1fr; gap:12px; }
}
@media (max-width:720px) {
  .footer-grid { grid-template-columns: 1fr; gap:12px; }
  .footer-socials a { width:40px; height:40px; }
}

/* ----------------------------
   ACCESSIBILITY / FOCUS
   ----------------------------*/
a:focus, button:focus, input:focus, select:focus, textarea:focus {
  outline-offset: 3px;
  box-shadow: var(--focus);
}

/* ----------------------------
   MINOR FIXES: keep modal content from being hidden by mobile "notch" UI
   ----------------------------*/
.modal .modal-inner { padding-bottom: calc(16px + var(--safe-bottom)); }
.checkout-modal .modal-inner, .receipt-modal .modal-inner { padding-bottom: calc(18px + var(--safe-bottom)); }

/* ----------------------------
   END
   ----------------------------*/
</style>

</head>
<body>
  <!-- SITE HEADER -->
  <header class="site-header" role="banner">
    <div class="container header-inner">
      <!-- Replace the old logo <a> in your header with this -->
<a href="#" class="logo" aria-label="April Blossoms">
  <img src="logo.jpg" alt="April Blossoms logo" class="site-logo" />
  <span class="brand-name sr-only">April Blossoms</span>
</a>


  <nav class="main-nav" role="navigation" aria-label="Primary">
    <ul class="nav-list">
      <li><a href="#hero"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="#shop"><i class="fa fa-shopping-bag"></i> Shop</a></li>
      <li><a href="#contact"><i class="fa fa-envelope"></i> Contact</a></li>
      <li><a href="#about"><i class="fa fa-info-circle"></i> About</a></li>
    </ul>
  </nav>

<div class="header-actions">
  <button id="search-toggle" class="icon-btn" aria-label="Search">
    <i class="fa fa-search"></i>
  </button>

  <!-- History (recent purchases) -->
  <button id="history-toggle" class="icon-btn" aria-label="Purchase history" title="Purchase history" aria-haspopup="true" aria-controls="history-modal">
    <i class="fa fa-history"></i>
    <span id="history-badge" class="badge" aria-live="polite">0</span>
  </button>

  <button id="cart-toggle" class="icon-btn" aria-label="Open cart" aria-haspopup="true" aria-controls="cart-panel">
    <i class="fa fa-shopping-cart"></i>
    <span id="cart-badge" class="badge" aria-live="polite">0</span>
  </button>

  <!-- HAMBURGER / MOBILE TOGGLE -->
  <button id="mobile-toggle" class="hamburger" aria-label="Open menu" aria-expanded="false">
    <span class="hamburger-lines" aria-hidden="true"></span>
    <i class="fa fa-bars" aria-hidden="true"></i>
  </button>
</div>

</div>

<!-- MOBILE NAV (will be toggled by JS) -->
<nav id="mobile-nav" class="mobile-nav" aria-hidden="true" aria-label="Mobile navigation" style="display: none">
  <ul>
    <li><a href="#hero"><i class="fa fa-home"></i> Home</a></li>
    <li><a href="#shop"><i class="fa fa-shopping-bag"></i> Shop</a></li>
    <li><a href="#contact"><i class="fa fa-envelope"></i> Contact</a></li>
    <li><a href="#about"><i class="fa fa-info-circle"></i> About</a></li>
  </ul>
  <div class="mobile-nav-footer">
    <a class="btn tiny" href="#"><i class="fa fa-user"></i> Admin</a>
  </div>
</nav>

  </header>

  <main id="main" role="main">

<!-- HERO / SLIDESHOW -->
<section id="hero" class="hero">
  <div class="hero-slider" data-slides="3" aria-roledescription="carousel">
    <div class="slide" data-slide="1" role="group" aria-roledescription="slide" aria-label="Slide 1 of 3">
      <div class="slide-inner">
        <picture class="hero-media">
          <img src="hero-1.jpg" alt="Bright kids dresses on display">
        </picture>
        <div class="hero-caption">
          <h1>Unique Dresses — Only One of Each</h1>
          <p>Handmade kids' dresses. Once it's sold, it's gone. Find the one that fits her best.</p>
          <div class="hero-cta">
            <a class="btn large" href="#shop"><i class="fa fa-shopping-bag"></i> Shop Now</a>
            <a class="btn outline" href="#about"><i class="fa fa-info-circle"></i> Learn More</a>
          </div>
        </div>
      </div>
    </div>

    <div class="slide" data-slide="2" role="group" aria-roledescription="slide" aria-label="Slide 2 of 3">
      <div class="slide-inner">
        <picture class="hero-media">
          <img src="hero-2.jpg" alt="Child wearing a floral dress">
        </picture>
        <div class="hero-caption">
          <h2>Playful, Pretty & Practical</h2>
          <p>Comfortable fabrics, joyful designs — perfect for parties and play dates.</p>
          <div class="hero-cta">
            <a class="btn large" href="#shop"><i class="fa fa-star"></i> Browse Styles</a>
          </div>
        </div>
      </div>
    </div>

    <div class="slide" data-slide="3" role="group" aria-roledescription="slide" aria-label="Slide 3 of 3">
      <div class="slide-inner">
        <picture class="hero-media">
          <img src="hero-4.jpg" alt="Close-up detail of dress fabric">
        </picture>
        <div class="hero-caption">
          <h2>Limited Editions</h2>
          <p>Each dress is one-of-a-kind — grab it before it's gone.</p>
          <div class="hero-cta">
            <a class="btn large" href="#shop"><i class="fa fa-bolt"></i> Limited Picks</a>
          </div>
        </div>
      </div>
    </div>

    <!-- hero controls (JS will hook these) -->
    <div class="hero-controls">
      <button class="hero-prev" aria-label="Previous slide"><i class="fa fa-chevron-left"></i></button>
      <button class="hero-next" aria-label="Next slide"><i class="fa fa-chevron-right"></i></button>
      <div class="hero-dots" role="tablist" aria-label="Slide indicators"></div>
    </div>
  </div>
</section>

<!-- CATEGORIES (AGE RANGES) -->
<section class="categories" aria-label="Age categories">
  <div class="container">
    <h3 class="section-title"><i class="fa fa-list"></i> Sizes & Age Groups</h3>
    <div class="category-chips" role="toolbar" aria-label="Filter by age">
      <button class="chip" data-filter="0-3">0–3 yrs <i class="fa fa-baby"></i></button>
      <button class="chip" data-filter="4-5">4–5 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="5-6">5–6 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="6-7">6–7 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="7-8">7–8 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="8-9">8–9 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="9-10">9–10 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="10-12">10–12 yrs <i class="fa fa-teen"></i></button>
      <button class="chip" data-filter="adult">Adult <i class="fa fa-user"></i></button>
    </div>
  </div>
</section>

<!-- SHOP / PRODUCT GRID -->
<section id="shop" class="shop container" aria-labelledby="shop-heading">
  <div class="shop-header">
    <h2 id="shop-heading"><i class="fa fa-store"></i> Shop Dresses</h2>
    <div class="shop-controls">
      <div class="search-wrap">
        <input id="search-input" type="search" placeholder="Search by name, color or id..." aria-label="Search products">
        <button id="search-clear" class="icon-btn" aria-label="Clear search"><i class="fa fa-times"></i></button>
      </div>

      <div class="sort-wrap">
        <label for="sort-select" class="sr-only">Sort</label>
        <select id="sort-select" aria-label="Sort products">
          <option value="featured">Featured</option>
          <option value="newest">Newest</option>
          <option value="price-asc">Price: Low → High</option>
          <option value="price-desc">Price: High → Low</option>
        </select>
      </div>
    </div>
  </div>

 
  <div id="product-grid" class="product-grid" data-total-products="50" aria-live="polite">
    <!-- JS will inject product cards here using the template below -->
  </div>

  <!-- Load more to reveal more products in batches of 10 -->
  <div class="load-more-wrap">
    <button id="load-more" class="btn" aria-controls="product-grid" aria-label="Load more products">
      More dresses <i class="fa fa-chevron-down"></i>
    </button>
  </div>
</section>

<!-- PRODUCT CARD TEMPLATE (to be cloned by JS) -->
<template id="product-card-template">
  <article class="product-card" role="article" aria-label="Product">
    <div class="product-media">
      <button class="quickview" data-action="open-modal" aria-label="Quick view product">
        <i class="fa fa-search-plus"></i>
      </button>
      <img src="" alt="" class="product-image" />
      <div class="product-tag">
        <span class="tag-text">One-of-a-kind</span>
        <i class="fa fa-tag"></i>
      </div>
    </div>

    <div class="product-body">
      <h3 class="product-title"></h3>
      <p class="product-meta">
        <span class="product-size"></span>
        <span class="product-id"></span>
      </p>
      <div class="product-bottom">
        <div class="price-wrap">
          <span class="price"></span>
        </div>
        <div class="card-actions">
          <button class="btn tiny add-cart" data-action="add-to-cart" aria-label="Add to cart">
            <i class="fa fa-shopping-cart"></i> Add
          </button>
          <button class="btn outline tiny more-info" data-action="more-info" aria-label="More details">
            <i class="fa fa-info-circle"></i> More
          </button>
        </div>
      </div>
    </div>
  </article>
</template>

<!-- PRODUCT QUICK-VIEW / DETAILS MODAL -->
<div id="product-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title">
  <div class="modal-inner">
    <button class="modal-close" aria-label="Close product" data-action="close-modal">
      <i class="fa fa-times"></i>
    </button>

    <div class="modal-grid">
      <div class="modal-media">
        <div class="gallery" id="modal-gallery" aria-live="polite">
          <!-- JS will fill with <img> thumbnails and main image -->
        </div>
        <div class="gallery-thumbs" id="modal-thumbs">
          <!-- thumbnails -->
        </div>
      </div>

      <div class="modal-info">
        <h2 id="modal-title" class="modal-title"></h2>
        <p class="modal-id"></p>

        <div class="price-row">
          <div class="modal-price"></div>
          <div class="availability"><i class="fa fa-check-circle"></i> In stock</div>
        </div>

        <p class="modal-desc"></p>

        <div class="modal-controls">
          <label for="modal-size">Size</label>
          <select id="modal-size" name="size" aria-label="Choose size">
            <option value="">Select size</option>
          </select>

          <label for="modal-qty">Qty</label>
          <input id="modal-qty" type="number" min="1" value="1" aria-label="Quantity" />

          <div class="modal-cta">
            <button id="modal-add" class="btn large" data-action="add-to-cart-modal">
              <i class="fa fa-shopping-cart"></i> Add to cart
            </button>

            <button id="modal-buy" class="btn accent" data-action="checkout-now">
              <i class="fa fa-credit-card"></i> Buy now
            </button>
          </div>
        </div>

        <div class="modal-meta">
          <small><i class="fa fa-calendar"></i> Unique piece ID: <span class="meta-id"></span></small>
          <small><i class="fa fa-star"></i> Handmade details</small>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CART PANEL (slide-out) -->
<aside id="cart-panel" class="cart-panel" aria-hidden="true" role="region" aria-label="Shopping cart">
 <div class="cart-header">
    <h3><i class="fa fa-shopping-cart"></i> Your Cart</h3>
    <div class="cart-header-actions" style="display:flex;align-items:center;gap:8px">
      <button id="cart-header-checkout" class="btn tiny checkout-header-btn" data-action="checkout" aria-label="Checkout" disabled>
        <i class="fa fa-credit-card"></i> Checkout
      </button>
      <button class="cart-close icon-btn" aria-label="Close cart" data-action="close-cart"><i class="fa fa-times"></i></button>
    </div>
  </div>


  <div id="cart-contents" class="cart-contents">
    <!-- JS will inject cart items here -->
    <div class="cart-empty">
      <i class="fa fa-box-open fa-3x"></i>
      <p>Your cart is empty. Add a dress you love!</p>
    </div>
  </div>

  <div class="cart-footer">
    <div class="cart-summary">
      <div class="subtotal">
        <span>Subtotal</span>
        <strong id="cart-subtotal">₵0.00</strong>
      </div>
    </div>

    <div class="cart-actions">
      <!-- Paystack will be handled via frontend JS on checkout -->
      <button id="checkout-btn" class="btn large checkout" data-action="checkout" aria-label="Checkout with Paystack">
        <i class="fa fa-credit-card"></i> Checkout (Paystack)
      </button>
      <button id="clear-cart" class="btn outline" data-action="clear-cart" aria-label="Clear cart">
        <i class="fa fa-trash"></i> Clear
      </button>
    </div>
  </div>
</aside>

<!-- CONTACT SECTION (REPLACEMENT) -->
<section id="contact" class="contact container" aria-labelledby="contact-heading">
  <div style="display:flex;gap:20px;align-items:flex-start;flex-wrap:wrap;">
    <!-- Left: contact card -->
    <div class="contact-card contact-card--info" style="flex:1;min-width:280px;">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
        <div style="width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));box-shadow:0 10px 30px rgba(255,107,138,0.09);color:#fff;font-weight:800;font-size:20px;">
          <i class="fa fa-envelope-open" aria-hidden="true" style="font-size:20px"></i>
        </div>
        <div>
          <h2 id="contact-heading" style="margin:0;font-size:1.15rem;">Get in touch</h2>
          <p class="lead" style="margin:6px 0 0 0;color:var(--muted);">Questions about sizing, custom orders, or shipping — we're happy to help.</p>
        </div>
      </div>

      <div class="contact-grid-info" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;">
        <div class="contact-block">
          <h4>Contact</h4>
          <ul class="contact-list styled">
            <li>
              <button class="contact-action" data-action="call" data-value="+233000000000" aria-label="Call phone">
                <span class="ci"><i class="fa fa-phone"></i></span>
                <div class="ct">
                  <div class="ct-title">Phone</div>
                  <div class="ct-sub">+233 000 000 000</div>
                </div>
                <span class="cta">Call</span>
              </button>
            </li>

            <li>
              <button class="contact-action" data-action="whatsapp" data-value="+233000000000" aria-label="WhatsApp">
                <span class="ci"><i class="fa fa-whatsapp"></i></span>
                <div class="ct">
                  <div class="ct-title">WhatsApp</div>
                  <div class="ct-sub">Chat with us</div>
                </div>
                <span class="cta">Open</span>
              </button>
            </li>

            <li>
              <button class="contact-action" data-action="copy" data-value="hello@tinythreads.example" aria-label="Copy email">
                <span class="ci"><i class="fa fa-envelope"></i></span>
                <div class="ct">
                  <div class="ct-title">Email</div>
                  <div class="ct-sub">hello@tinythreads.example</div>
                </div>
                <span class="cta">Copy</span>
              </button>
            </li>
          </ul>
        </div>

        <div class="contact-block">
          <h4>Hours</h4>
          <div style="color:var(--muted);font-size:0.95rem;">
            <div><strong>Mon–Fri:</strong> 9:00 — 17:00</div>
            <div><strong>Sat:</strong> 10:00 — 14:00</div>
            <div><strong>Sun:</strong> Closed</div>
          </div>

          <h4 style="margin-top:12px;">Follow</h4>
          <div class="socials contact-socials" style="margin-top:6px;">
            <a href="#" aria-label="Instagram"><i class="fa fa-instagram"></i></a>
            <a href="#" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
            <a href="#" aria-label="TikTok"><i class="fa fa-music"></i></a>
          </div>
        </div>
      </div>

      <div style="margin-top:12px;color:var(--muted);font-size:0.92rem;">
        <strong>Retail:</strong> Pickup available at Accra studio. Shipping across Ghana (and international on request).
      </div>
    </div>

    <!-- Right: contact form -->
    <form id="contact-form" class="contact-form contact-card contact-card--form" aria-label="Contact form" novalidate style="flex:1;min-width:320px;">
      <div style="display:flex;align-items:center;gap:10px;">
        <h3 style="margin:0">Send a message</h3>
        <div style="margin-left:auto;color:var(--muted);font-size:0.95rem">We reply within 24 hrs</div>
      </div>

      <div class="form-row">
        <label for="name" class="form-label">Full name</label>
        <input id="name" name="name" type="text" placeholder="Your name" required />
      </div>

      <div class="form-row row-2">
        <div style="flex:1;">
          <label for="email" class="form-label">Email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" required />
        </div>
        <div style="width:140px;">
          <label for="contact-method" class="form-label">Preferred</label>
          <select id="contact-method" name="contact-method" aria-label="Preferred contact method">
            <option value="email">Email</option>
            <option value="whatsapp">WhatsApp</option>
            <option value="phone">Phone</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <label for="message" class="form-label">Message</label>
        <textarea id="message" name="message" rows="5" placeholder="Ask about size, availability, custom orders..." required></textarea>
      </div>

      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:6px;">
        <div style="display:flex;gap:8px;align-items:center;">
          <label style="display:flex;gap:8px;align-items:center;font-size:0.95rem;color:var(--muted);">
            <input type="checkbox" id="contact-consent" /> Receive updates & restocks
          </label>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn"><i class="fa fa-paper-plane"></i> Send message</button>
          <button type="reset" class="btn outline">Reset</button>
        </div>
      </div>
    </form>
  </div>
</section>


<!-- ABOUT / SHOP INFO -->
<section id="about" class="about container" aria-labelledby="about-heading">
  <h2 id="about-heading"><i class="fa fa-info-circle"></i> About Tiny Threads</h2>
  <p class="lead">We make one-off dresses for children and small adults — lovingly crafted and limited in quantity. Each piece is photographed and listed as a single item. When it’s sold, it’s removed from the shop so you know you’re getting something unique.</p>

  <ul class="features-grid">
    <li><i class="fa fa-hand-paper"></i> Ethically made</li>
    <li><i class="fa fa-seedling"></i> Natural fabrics</li>
    <li><i class="fa fa-truck"></i> Fast local shipping</li>
    <li><i class="fa fa-star"></i> Unique designs</li>
  </ul>
</section>
```

  </main>

<footer class="site-footer" role="contentinfo" aria-label="Site footer">
  <div class="footer-grid">
    <!-- Brand & description -->
    <div>
      <div class="footer-brand">
        <div class="logo-badge" aria-hidden="true"><i class="fa fa-heart" style="font-size:20px;"></i></div>
        <div>
          <a class="footer-logo" href="#" style="text-decoration:none;color:var(--text);font-weight:800;font-size:1.05rem">Tiny Threads</a>
          <div class="brand-copy" style="max-width:360px;">One-of-a-kind kids dresses. Small batches, big smiles — handmade with care.</div>

          <div class="footer-socials" aria-label="Social links" style="margin-top:12px;">
            <a href="#" aria-label="Instagram"><i class="fa fa-instagram"></i></a>
            <a href="#" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
            <a href="#" aria-label="TikTok"><i class="fa fa-music"></i></a>
          </div>

          <div class="footer-payments" aria-hidden="true" style="margin-top:10px;">
            <div class="payment-badge">Visa</div>
            <div class="payment-badge">Momo</div>
            <div class="payment-badge">Paystack</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick links -->
    <div>
      <h4>Shop</h4>
      <ul class="footer-links">
        <li><a href="#shop"><i class="fa fa-angle-right"></i> Shop</a></li>
        <li><a href="#about"><i class="fa fa-angle-right"></i> About</a></li>
        <li><a href="#contact"><i class="fa fa-angle-right"></i> Contact</a></li>
        <li><a href="admin.html" target="_blank"><i class="fa fa-angle-right"></i> Admin</a></li>
      </ul>
    </div>

    <!-- Support -->
    <div>
      <h4>Support</h4>
      <ul class="footer-links">
        <li><a href="#"><i class="fa fa-angle-right"></i> Shipping & returns</a></li>
        <li><a href="#"><i class="fa fa-angle-right"></i> FAQs</a></li>
        <li><a href="#"><i class="fa fa-angle-right"></i> Sizing guide</a></li>
        <li><a href="#"><i class="fa fa-angle-right"></i> Contact support</a></li>
      </ul>
    </div>

    <!-- Newsletter & contact -->
    <div>
      <h4>Newsletter</h4>
      <div class="footer-newsletter">
        <p style="margin:0;color:var(--muted);font-size:0.95rem">Get new dress drops & restock alerts. Unsubscribe anytime.</p>
        <form id="footer-newsletter" aria-label="Newsletter sign up">
          <input id="footer-email" type="email" placeholder="you@example.com" aria-label="Email for newsletter" />
          <div style="display:flex;gap:8px;margin-top:8px;">
            <button type="submit" class="btn">Subscribe</button>
            <button type="button" id="footer-newsletter-clear" class="btn outline">Clear</button>
          </div>
        </form>

        <div style="margin-top:12px;">
          <div style="font-weight:700">Contact</div>
          <div style="color:var(--muted);margin-top:6px;font-size:0.95rem">
            <div><i class="fa fa-phone"></i> <a href="tel:+233000000000">+233 000 000 000</a></div>
            <div style="margin-top:6px;"><i class="fa fa-envelope"></i> <a href="mailto:hello@tinythreads.example">hello@tinythreads.example</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- bottom legal row -->
  <div class="footer-bottom">
    <div class="footer-left">
      <small class="footer-copyright">&copy; <span id="footer-year"></span> Tiny Threads — All rights reserved.</small>
    </div>
    <ul class="legal" role="list">
      <li><a href="#" aria-label="Terms">Terms</a></li>
      <li><a href="#" aria-label="Privacy">Privacy</a></li>
      <li><a href="#" aria-label="Cookies">Cookies</a></li>
    </ul>
  </div>
</footer>

<!-- Back to top -->
<button id="back-to-top" aria-label="Back to top" title="Back to top"><i class="fa fa-chevron-up"></i></button>


  <!-- TEMPLATES FOR CART ITEMS -->

 <template id="cart-item-template">
  <div class="cart-item" data-product-id="" tabindex="0" role="group" aria-label="Cart item">
    <img src="" alt="" class="cart-item-thumb" />
    <div class="cart-item-info">
      <strong class="cart-item-title clickable"></strong>
      <small class="cart-item-meta"></small>

      <div class="cart-item-price-row" style="display:flex;gap:10px;align-items:center;margin:6px 0;">
        <span class="unit-price" aria-hidden="true" style="font-size:0.95rem;color:var(--muted)"></span>
        <span class="line-price" style="margin-left:auto;"><strong class="item-price"></strong></span>
      </div>

      <div class="cart-item-actions" style="display:flex;gap:8px;align-items:center;">
        <input type="number" min="1" value="1" class="cart-item-qty" aria-label="Quantity" />
        <button class="icon-btn cart-item-remove" aria-label="Remove item"><i class="fa fa-trash"></i></button>
      </div>
    </div>
  </div>
</template>

<!-- CHECKOUT MODAL (REPLACEMENT) -->
<div id="checkout-modal" class="modal checkout-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="checkout-title">
  <div class="modal-inner" role="document" aria-live="polite">
    <!-- decorative stickers -->
    <div class="sticker sticker--left" aria-hidden="true"><i class="fa fa-gift" style="font-size:22px;"></i></div>
    <div class="sticker sticker--right" aria-hidden="true"><i class="fa fa-heart" style="font-size:20px;"></i></div>

    <button class="modal-close" aria-label="Close checkout" data-action="close-checkout" style="position:absolute; right:14px; top:12px; border:0; background:transparent; padding:8px; cursor:pointer;">
      <i class="fa fa-times" style="font-size:18px;color:var(--muted)"></i>
    </button>

    <div class="checkout-inner">
      <header style="display:flex;align-items:center;justify-content:space-between;">
        <div>
          <h2 id="checkout-title" style="margin:0;font-size:1.15rem;"><i class="fa fa-credit-card"></i> Checkout</h2>
          <p style="margin:6px 0 0 0;color:var(--muted);font-size:0.95rem;">Complete your order — we’ll email a receipt after payment.</p>
        </div>
        <div style="text-align:right;color:var(--muted);font-size:13px;">
          <div id="checkout-ref" style="font-weight:700"></div>
          <div id="checkout-date"></div>
        </div>
      </header>

      <!-- DETAILS CARD (top) -->
      <section class="checkout-details" aria-labelledby="details-heading">
        <div class="checkout-form" aria-describedby="details-heading">
          <h3 id="details-heading" style="margin:0 0 6px 0">Your details</h3>

          <div class="row">
            <input id="checkout-name" name="name" type="text" placeholder="Full name" required />
            <input id="checkout-phone" name="phone" type="tel" placeholder="Phone (WhatsApp preferred)" />
          </div>

          <div class="row">
            <input id="checkout-email" name="email" type="email" placeholder="Email (for receipt)" required />
            <select id="checkout-delivery" name="delivery" aria-label="Delivery method">
              <option value="standard">Standard delivery</option>
              <option value="express">Express delivery (+GHS 15)</option>
              <option value="pickup">Pick up (free)</option>
            </select>
          </div>

          <div class="row">
            <input id="checkout-address1" type="text" placeholder="Address line 1" />
            <input id="checkout-address2" type="text" placeholder="Address line 2 (optional)" />
          </div>

          <div class="row">
            <input id="checkout-city" type="text" placeholder="City/Town" />
            <input id="checkout-region" type="text" placeholder="Region" />
          </div>

          <div class="row">
            <input id="checkout-postal" type="text" placeholder="Postal code" />
            <input id="checkout-promo" type="text" placeholder="Promo code (optional)" />
          </div>

          <div style="display:flex;gap:8px;align-items:center;">
            <label style="display:flex;gap:8px;align-items:center;"><input id="checkout-save" type="checkbox" /> Save these details for next time</label>
          </div>

          <label for="checkout-notes" style="margin-top:6px;font-weight:700">Order notes</label>
          <textarea id="checkout-notes" placeholder="Add delivery instructions, gift note, etc."></textarea>
        </div>

        <aside class="checkout-summary-card" aria-labelledby="summary-title">
          <h4 id="summary-title" style="margin:0 0 6px 0">Order summary</h4>
          <div style="font-size:0.95rem;color:var(--muted)">Items: <strong id="checkout-count">0</strong></div>
          <div style="display:flex;justify-content:space-between;margin-top:8px;"><div style="color:var(--muted)">Subtotal</div><div id="checkout-subtotal">₵0.00</div></div>
          <div class="checkout-hide-processing-note" style="display:flex;justify-content:space-between;margin-top:6px;"><div style="color:var(--muted)">Processing fee</div><div id="checkout-fee">₵0.00</div></div>
          <div style="display:flex;justify-content:space-between;margin-top:10px;font-size:1.05rem;"><div style="font-weight:700">Total</div><div id="checkout-total" class="total">₵0.00</div></div>
          <div style="margin-top:10px; font-size:12px; color:var(--muted)">We accept Paystack payments. You will receive a printable receipt after payment.</div>
        </aside>
      </section>

      <!-- ITEMS (below) -->
      <section class="checkout-items-wrap" aria-labelledby="items-heading">
        <h3 id="items-heading" style="margin:0 0 6px 0;"><i class="fa fa-receipt"></i> Order & items</h3>

        <div style="display:flex;gap:16px;flex-direction:row;align-items:flex-start;flex-wrap:wrap;">
          <div style="flex:1; min-width:280px;">
            <div id="checkout-items" class="checkout-items-list" aria-live="polite" aria-atomic="true">
              <!-- JS injects item rows here -->
            </div>

            <div style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
              <button id="checkout-pay" class="btn large" type="button"><i class="fa fa-credit-card"></i> Pay securely</button>
              <button id="checkout-cancel" class="btn outline" type="button"><i class="fa fa-times"></i> Cancel</button>
              <button id="checkout-clear" class="btn tiny" type="button" title="Clear cart"><i class="fa fa-trash"></i></button>
            </div>
          </div>

          <!-- small mobile-friendly totals (duplicated for convenience) -->
          <div style="width:240px;min-width:220px;">
            <div style="padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow);">
              <div style="display:flex;justify-content:space-between;"><div style="color:var(--muted)">Subtotal</div><div id="checkout-subtotal-2">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:6px;"><div style="color:var(--muted)">Processing</div><div id="checkout-fee-2">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:10px;font-weight:800;font-size:1.1rem;"><div>Total</div><div id="checkout-total-2">₵0.00</div></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>

<!-- PURCHASE HISTORY MODAL -->
<div id="history-modal" role="dialog" aria-modal="true" aria-labelledby="history-title">
  <div class="modal-inner" role="document">
    <button class="modal-close" aria-label="Close history" id="history-close" style="position:absolute; right:12px; top:12px; border:0; background:transparent; padding:8px; cursor:pointer;"><i class="fa fa-times" style="color:var(--muted)"></i></button>

    <header style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
      <div>
        <h3 id="history-title" style="margin:0;"><i class="fa fa-history"></i> Recent purchases</h3>
        <p style="margin:6px 0 0 0;color:var(--muted);font-size:0.95rem;">Your recent orders are stored locally on this device. Click View to open the receipt (PDF).</p>
      </div>
      <div style="text-align:right;color:var(--muted)"><small id="history-count">0</small></div>
    </header>

    <div style="margin-top:12px;">
      <div id="history-list" class="history-list" aria-live="polite"></div>

      <div style="margin-top:14px;display:flex;gap:8px;justify-content:flex-end;">
        <button id="history-clear-all" class="btn tiny outline">Clear history</button>
        <button id="history-close-bottom" class="btn tiny">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- BUY NOW (single product) MODAL -->
<div id="buynow-modal" class="modal checkout-modal" role="dialog" aria-modal="true" aria-hidden="true" style="z-index:130;display:none;">
  <div class="modal-inner" style="max-width:980px; padding:18px;">
    <button class="modal-close" aria-label="Close buy now" data-action="close-buynow" style="right:16px;top:12px">
      <i class="fa fa-times"></i>
    </button>
    <div style="display:grid;grid-template-columns:1fr 340px;gap:16px;">
      <!-- LEFT: single product preview -->
      <div style="padding:8px 6px; max-height:60vh; overflow:auto;">
        <h2 style="margin:0 0 8px 0; font-size:1.1rem;"><i class="fa fa-bolt"></i> Buy this item</h2>
        <div id="buynow-item" aria-live="polite" style="display:flex;flex-direction:column;gap:10px;margin-top:10px;">
          <!-- JS injects single item row (thumbnail, title, size, qty, price) -->
        </div>
      </div>

      <!-- RIGHT: buyer details + summary -->
      <aside style="padding:8px 12px; background:linear-gradient(180deg,#fff,#fffefc); border-radius:12px; box-shadow:var(--shadow);">
        <h3 style="margin:0 0 8px 0;">Your details</h3>
        <form id="buynow-form" novalidate>
          <div style="display:flex;flex-direction:column;gap:8px;">
            <label class="sr-only" for="buynow-name">Full name</label>
            <input id="buynow-name" name="name" type="text" placeholder="Full name" required style="padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)" />

            <label class="sr-only" for="buynow-email">Email</label>
            <input id="buynow-email" name="email" type="email" placeholder="Email (for receipt)" required style="padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)" />

            <label class="sr-only" for="buynow-phone">Phone</label>
            <input id="buynow-phone" name="phone" type="tel" placeholder="Phone number (WhatsApp preferred)" style="padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)" />
          </div>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(15,23,42,0.04)" />

          <div style="display:flex;flex-direction:column;gap:6px;">
           <div style="display:flex;justify-content:space-between"><span>Subtotal</span><strong id="buynow-subtotal">₵0.00</strong></div>
            <div style="display:flex;justify-content:space-between"><span>Processing fee <small>(1.95% + 1%)</small></span><strong id="buynow-fee">₵0.00</strong></div>
            <div style="display:flex;justify-content:space-between;font-size:1.05rem;margin-top:6px;"><span>Total</span><strong id="buynow-total">₵0.00</strong></div>
          </div>

          <div style="display:flex;gap:8px;margin-top:12px;">
            <button id="buynow-pay" class="btn large" type="button"><i class="fa fa-credit-card"></i> Pay</button>
            <button id="buynow-cancel" class="btn outline" type="button"><i class="fa fa-times"></i> Cancel</button>
          </div>
        </form>
      </aside>
    </div>
  </div>
</div>

  <!-- PAYMENT RECEIPT MODAL (REPLACEMENT) -->
<div id="receipt-modal" class="modal receipt-modal" role="dialog" aria-modal="true" aria-labelledby="receipt-title" style="display:none;">
  <div class="modal-inner" role="document">
    <div class="sticker left" aria-hidden="true"><i class="fa fa-receipt" style="font-size:20px;"></i></div>
    <div class="sticker right" aria-hidden="true"><i class="fa fa-smile" style="font-size:18px;"></i></div>

    <button class="modal-close" aria-label="Close receipt" id="receipt-close" style="position:absolute; right:12px; top:10px; border:0; background:transparent; padding:8px; cursor:pointer;">
      <i class="fa fa-times" style="color:var(--muted);font-size:18px;"></i>
    </button>

    <header style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:6px;">
      <div>
        <h2 id="receipt-title" style="margin:0;font-size:1.15rem;"><i class="fa fa-file-invoice"></i> Payment receipt</h2>
        <p id="receipt-sub" class="lead" style="margin:6px 0 0 0;color:var(--muted);">Receipt and PDF preview. Use the actions to view, download, or print the invoice.</p>
      </div>
      <div style="text-align:right;">
        <div id="receipt-ref" style="font-weight:700"></div>
        <div id="receipt-date" style="color:var(--muted);font-size:13px"></div>
      </div>
    </header>

    <div class="receipt-grid" style="align-items:start;">
      <div class="receipt-left">
        <div class="receipt-summary" id="receipt-summary" aria-live="polite">
          <!-- populated by JS: Buyer / items summary / totals -->
        </div>

        <div style="display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap;">
          <div style="flex:1">
            <h4 style="margin:10px 0 6px 0;">Items</h4>
            <div class="receipt-items" id="receipt-items">
              <!-- JS: item rows -->
            </div>
          </div>

          <div style="width:280px;min-width:220px;">
            <div class="receipt-summary" style="padding:12px;">
              <div style="display:flex;justify-content:space-between;"><div style="color:var(--muted)">Subtotal</div><div id="receipt-subtotal">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:6px;"><div style="color:var(--muted)">Processing</div><div id="receipt-processing">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:10px;font-weight:900;font-size:1.15rem;"><div>Total paid</div><div id="receipt-total" style="color:var(--brand-1)"></div></div>
              <div style="margin-top:12px;">
                <button id="receipt-view" class="btn large"><i class="fa fa-eye"></i> View PDF</button>
                <button id="receipt-download" class="btn outline" style="margin-top:8px;"><i class="fa fa-download"></i> Download</button>
                <button id="receipt-print" class="btn tiny" style="margin-top:8px;"><i class="fa fa-print"></i> Print</button>
              </div>
            </div>
          </div>
        </div>

        <div id="receipt-preview-wrap" class="receipt-preview-wrap" style="margin-top:12px; display:none; position:relative;">
          <div style="font-size:0.95rem; color:var(--muted); margin-bottom:6px;"><strong>PDF preview</strong> — scroll within the frame or open it in a new tab.</div>
          <div style="position:relative;">
            <div class="preview-loader" id="preview-loader" style="display:none;">
              <div class="lead">Loading PDF…</div>
            </div>
            <iframe id="receipt-preview" class="receipt-iframe" title="Receipt preview" sandbox=""></iframe>
          </div>
        </div>
      </div>

      <aside class="receipt-right" aria-label="Receipt actions & status">
        <div style="position:sticky; top:16px;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
            <div class="receipt-badge" id="receipt-status">PAID</div>
            <div style="font-size:0.95rem;color:var(--muted)"><strong id="receipt-method">Paystack</strong></div>
          </div>

          <div style="padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow);">
            <div style="font-weight:700">Order details</div>
            <div style="margin-top:8px;color:var(--muted);font-size:13px" id="receipt-order-meta"></div>
            <div style="margin-top:12px;">
              <small style="color:var(--muted)">Receipt reference</small>
              <div style="font-weight:800" id="receipt-ref-2"></div>
            </div>
          </div>

          <div style="margin-top:12px;">
            <button id="receipt-close-bottom" class="btn outline">Close</button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>

<script>
/* ------------------------------------------------------------
   Consolidated app script — paste to replace the previous script
   - Fixes modal close buttons
   - Removes iframe sandbox so blob URLs show correctly
   - Keeps Paystack simulation when key missing
   - Keeps jsPDF invoice generation and ensures blob URL not revoked
   ------------------------------------------------------------*/
(function () {
  'use strict';

  /* ---------------------
     Config
     ---------------------*/
  let PAYSTACK_PUBLIC_KEY = 'pk_test_297586e51710e83d3c159bfe71ff45c7e23411fa';
  const PAYSTACK_CURRENCY = 'GHS';
  const CURRENCY_SYMBOL = '₵';
  const STORAGE_KEYS = { PRODUCTS: 'tiny_products_v1', CART: 'tiny_cart_v1', ORDERS: 'tiny_orders_v1' };
  const LOAD_BATCH = 10;
  const MOBILE_BREAKPOINT = 720;

  /* ---------------------
     Small helpers
     ---------------------*/
  const $ = (s, root = document) => root.querySelector(s);
  const $$ = (s, root = document) => Array.from(root.querySelectorAll(s));
  const formatPrice = (n) => `${CURRENCY_SYMBOL}${Number(n || 0).toFixed(2)}`;
  const nowISO = () => new Date().toISOString();

  function toast(msg, timeout = 2000) {
    try {
      const t = document.createElement('div');
      t.className = 'tiny-toast';
      t.textContent = msg;
      document.body.appendChild(t);
      requestAnimationFrame(() => t.classList.add('show'));
      setTimeout(() => { t.classList.remove('show'); setTimeout(()=>t.remove(),300); }, timeout);
    } catch (e) { console.warn(e); }
  }

  /* ---------------------
     Load products (use existing local storage or built-in)
     ---------------------*/
  // For brevity reuse products stored earlier if present; otherwise fallback to any inline sample in page.
  let builtIn = [];
  try {
    const maybe = localStorage.getItem(STORAGE_KEYS.PRODUCTS);
    if (maybe) builtIn = JSON.parse(maybe);
  } catch (e) {}
  // If nothing in storage, try to reuse page's global 'builtInProducts' if present (older script); otherwise create small fallback.
  let products = window.builtInProducts && Array.isArray(window.builtInProducts)
    ? JSON.parse(JSON.stringify(window.builtInProducts))
    : (Array.isArray(builtIn) && builtIn.length ? JSON.parse(JSON.stringify(builtIn)) : [
      { id: "DRESS-001", title: "Floral Ruffles", price: 40.00, description: "One-of-a-kind floral ruffle dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5700.JPG","IMG_5700.JPG"], available: true, createdAt: new Date(Date.now()-1*86400000).toISOString() },
  { id: "DRESS-002", title: "Sunshine Dress", price: 30.00, description: "Bright yellow play dress", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5701.JPG"], available: true, createdAt: new Date(Date.now()-2*86400000).toISOString() },
  { id: "DRESS-003", title: "Party Bow Dress", price: 35.00, description: "Elegant dress for special occasions", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5702.JPG","IMG_5702.JPG"], available: true, createdAt: new Date(Date.now()-3*86400000).toISOString() },
  { id: "DRESS-004", title: "Polka Play", price: 35.00, description: "Polka-dot twirl dress", sizes: ["0-3M","3-6M"], ageCategory: "4-5", images: ["IMG_5703.JPG"], available: true, createdAt: new Date(Date.now()-4*86400000).toISOString() },
  { id: "DRESS-005", title: "Candy Stripes", price: 35.00, description: "Soft striped cotton dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5704.JPG","IMG_5704.JPG"], available: true, createdAt: new Date(Date.now()-5*86400000).toISOString() },
  { id: "DRESS-006", title: "Meadow Tiny", price: 35.00, description: "Hand-stitched meadow pattern", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5705.JPG"], available: true, createdAt: new Date(Date.now()-6*86400000).toISOString() },
  { id: "DRESS-007", title: "Lace Halo", price: 40.00, description: "Lace-trim party dress", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5706.JPG","IMG_5706.JPG"], available: true, createdAt: new Date(Date.now()-7*86400000).toISOString() },
  { id: "DRESS-008", title: "Seaside Sundress", price: 35.00, description: "Cool and breezy sun dress", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5707.JPG"], available: true, createdAt: new Date(Date.now()-8*86400000).toISOString() },
  { id: "DRESS-009", title: "Minty Bow", price: 100.00, description: "White Shirt with skirt", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5708.JPG","IMG_5708.JPG"], available: true, createdAt: new Date(Date.now()-9*86400000).toISOString() },
  { id: "DRESS-010", title: "Rosette Charm", price: 35.00, description: "Rosette detailing, comfy fit", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5709.JPG"], available: true, createdAt: new Date(Date.now()-10*86400000).toISOString() },

  { id: "DRESS-011", title: "Blossom Day", price: 30.00, description: "Lightweight blossom print dress", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5710.JPG","IMG_5710.JPG"], available: true, createdAt: new Date(Date.now()-11*86400000).toISOString() },
  { id: "DRESS-012", title: "Vintage Coral", price: 40.00, description: "Retro coral dress with pockets", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5711.JPG"], available: true, createdAt: new Date(Date.now()-12*86400000).toISOString() },
  { id: "DRESS-013", title: "Petal Puff", price: 30.00, description: "Petal-pattern puff sleeve dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5712.JPG","IMG_5712.JPG"], available: true, createdAt: new Date(Date.now()-13*86400000).toISOString() },
  { id: "DRESS-014", title: "Lemon Drop", price: 65.00, description: "Blue jeans trousers", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5713.JPG"], available: true, createdAt: new Date(Date.now()-14*86400000).toISOString() },
  { id: "DRESS-015", title: "Bluebell Classic", price: 65.00, description: "Black jeans trousers", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5714.JPG","IMG_5714.JPG"], available: true, createdAt: new Date(Date.now()-15*86400000).toISOString() },
  { id: "DRESS-016", title: "Gingham Girl", price: 35.00, description: "Cute gingham for playdates", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5715.JPG"], available: true, createdAt: new Date(Date.now()-16*86400000).toISOString() },
  { id: "DRESS-017", title: "Velvet Holiday", price: 50.00, description: "Velvet holiday edition", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5716.JPG","IMG_5716.JPG"], available: true, createdAt: new Date(Date.now()-17*86400000).toISOString() },
  { id: "DRESS-018", title: "Daisy Chain", price: 70.00, description: "Daisy print with soft lining", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5717.JPG"], available: true, createdAt: new Date(Date.now()-18*86400000).toISOString() },
  { id: "DRESS-019", title: "Sunset Ombre", price: 50.00, description: "Ombre fade summer dress", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5718.JPG","IMG_5718.JPG"], available: true, createdAt: new Date(Date.now()-19*86400000).toISOString() },
  { id: "DRESS-020", title: "Coral Petals", price: 70.00, description: "Coral floral with ruffled hem", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5719.JPG"], available: true, createdAt: new Date(Date.now()-20*86400000).toISOString() },

  { id: "DRESS-021", title: "Lavender Mist", price: 28.00, description: "Soft lavender cotton dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5720.JPG","IMG_5720.JPG"], available: true, createdAt: new Date(Date.now()-21*86400000).toISOString() },
  { id: "DRESS-022", title: "Plaid Picnic", price: 28.00, description: "Cute plaid button dress", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5720.JPG"], available: true, createdAt: new Date(Date.now()-22*86400000).toISOString() },
  { id: "DRESS-023", title: "Rosebud Twirl", price: 120.00, description: "Lightweight twirl skirt", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5721.JPG","IMG_5721.JPG"], available: true, createdAt: new Date(Date.now()-23*86400000).toISOString() },
  { id: "DRESS-024", title: "Mint Sprig", price: 80.00, description: "Refreshingly cool mint dress", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5722.JPG"], available: true, createdAt: new Date(Date.now()-24*86400000).toISOString() },
  { id: "DRESS-025", title: "Buttercup", price: 35.00, description: "Premium buttercup fabric", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5723.JPG","IMG_5723.JPG"], available: true, createdAt: new Date(Date.now()-25*86400000).toISOString() },
  { id: "DRESS-026", title: "Peach Dream", price: 60.00, description: "Soft peach party dress", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5724.JPG"], available: true, createdAt: new Date(Date.now()-26*86400000).toISOString() },
  { id: "DRESS-027", title: "Ivy Garden", price: 35.00, description: "Ivy print with tiny pleats", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5725.JPG","IMG_5725.JPG"], available: true, createdAt: new Date(Date.now()-27*86400000).toISOString() },
  { id: "DRESS-028", title: "Ocean Breeze", price: 45.00, description: "Nautical details and stripes", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5726.JPG"], available: true, createdAt: new Date(Date.now()-28*86400000).toISOString() },
  { id: "DRESS-029", title: "Lilac Lace", price: 35.00, description: "Delicate lilac lace overlay", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5727.JPG","IMG_5727.JPG"], available: true, createdAt: new Date(Date.now()-29*86400000).toISOString() },
  { id: "DRESS-030", title: "Maple Sweet", price: 40.00, description: "Warm tones for autumn play", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5728.JPG"], available: true, createdAt: new Date(Date.now()-30*86400000).toISOString() },

  { id: "DRESS-031", title: "Cherry Puff", price: 40.00, description: "Cherry prints and puff sleeves", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5729.JPG","IMG_5729.JPG"], available: true, createdAt: new Date(Date.now()-31*86400000).toISOString() },
  { id: "DRESS-032", title: "Starry Night", price: 35.00, description: "Dark blue with star pattern", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5730.JPG"], available: true, createdAt: new Date(Date.now()-32*86400000).toISOString() },
  { id: "DRESS-033", title: "Palm Picnic", price: 35.00, description: "Tropical print for sunny days", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5731.JPG","IMG_5731.JPG"], available: true, createdAt: new Date(Date.now()-33*86400000).toISOString() },
  { id: "DRESS-034", title: "Velvet Ribbon", price: 40.00, description: "Lux velvet with ribbon tie", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5732.JPG"], available: true, createdAt: new Date(Date.now()-34*86400000).toISOString() },
  { id: "DRESS-035", title: "Rose Quartz", price: 35.00, description: "Soft pink, comfy cotton", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5733.JPG","IMG_5733.JPG"], available: true, createdAt: new Date(Date.now()-35*86400000).toISOString() },
  { id: "DRESS-036", title: "Star Bloom", price: 30.00, description: "Star bloom pattern, breezy", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5734.JPG"], available: true, createdAt: new Date(Date.now()-36*86400000).toISOString() },
  { id: "DRESS-037", title: "Meadow Stitch", price: 40.00, description: "Detailed stitching, floral", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5735.JPG","IMG_5735.JPG"], available: true, createdAt: new Date(Date.now()-37*86400000).toISOString() },
  { id: "DRESS-038", title: "Denim Dolly", price: 50.00, description: "Soft denim dress with buttons", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5736.JPG"], available: true, createdAt: new Date(Date.now()-38*86400000).toISOString() },
  { id: "DRESS-039", title: "Citrine Bloom", price: 65.00, description: "Sunny citrine color", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5737.JPG","IMG_5737.JPG"], available: true, createdAt: new Date(Date.now()-39*86400000).toISOString() },
  { id: "DRESS-040", title: "Cloud Puff", price: 25.00, description: "Puffy clouds print", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5738.JPG"], available: true, createdAt: new Date(Date.now()-40*86400000).toISOString() },

  { id: "DRESS-041", title: "Mint Melody", price: 28.00, description: "Light mint with trims", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5739.JPG","IMG_5739.JPG"], available: true, createdAt: new Date(Date.now()-41*86400000).toISOString() },
  { id: "DRESS-042", title: "Petite Pearl", price: 25.00, description: "Pearl button detail", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5740.JPG"], available: true, createdAt: new Date(Date.now()-42*86400000).toISOString() },
  { id: "DRESS-043", title: "Coral Breeze", price: 35.00, description: "Soft coral shade", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5741.JPG","IMG_5741.JPG"], available: true, createdAt: new Date(Date.now()-43*86400000).toISOString() },
  { id: "DRESS-044", title: "Pineapple Pop", price: 30.00, description: "Fun pineapple print", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5742.JPG"], available: true, createdAt: new Date(Date.now()-44*86400000).toISOString() },
  { id: "DRESS-045", title: "Willow Whisper", price: 40.00, description: "Earthy willow tones", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5743.JPG","IMG_5743.JPG"], available: true, createdAt: new Date(Date.now()-45*86400000).toISOString() },
  { id: "DRESS-046", title: "Sunbeam Tuck", price: 35.00, description: "Tucked waist, sunny print", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5744.JPG"], available: true, createdAt: new Date(Date.now()-46*86400000).toISOString() },
  { id: "DRESS-047", title: "Peppermint Twist", price: 30.00, description: "Mint stripes and soft collar", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5745.JPG","IMG_5745.JPG"], available: true, createdAt: new Date(Date.now()-47*86400000).toISOString() },
  { id: "DRESS-048", title: "Dotted Dreams", price: 60.00, description: "Subtle dotted pattern", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5746.JPG"], available: true, createdAt: new Date(Date.now()-48*86400000).toISOString() },
  { id: "DRESS-049", title: "Little Luxe", price: 80.00, description: "Tiny luxe finish", sizes: ["9","10"], ageCategory: "7-8", images: ["IMG_5747.JPG","IMG_5747.JPG"], available: true, createdAt: new Date(Date.now()-49*86400000).toISOString() },
  { id: "DRESS-050", title: "Pocket Garden", price: 40.00, description: "Playful pockets and cotton", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5748.JPG"], available: true, createdAt: new Date(Date.now()-50*86400000).toISOString() }
    ]);

  function persistProducts() { try { localStorage.setItem(STORAGE_KEYS.PRODUCTS, JSON.stringify(products)); } catch(e){} }

  /* ---------------------
     Cart & orders persistence
     ---------------------*/
  function loadCart() { try { const r = localStorage.getItem(STORAGE_KEYS.CART); return r ? JSON.parse(r) : []; } catch(e){ return []; } }
  function saveCart(c) { try { localStorage.setItem(STORAGE_KEYS.CART, JSON.stringify(c||[])); } catch(e){} }
  function loadOrders() { try { const r = localStorage.getItem(STORAGE_KEYS.ORDERS); return r ? JSON.parse(r) : []; } catch(e){ return []; } }
  function saveOrders(arr) { try { localStorage.setItem(STORAGE_KEYS.ORDERS, JSON.stringify(arr||[])); } catch(e){} }
  function pushOrder(o) { const arr = loadOrders(); arr.unshift(o); saveOrders(arr); }

  let cart = loadCart();

  /* ---------------------
     Generic modal open/close utilities
     ---------------------*/
  function openModal(modalEl) {
    if (!modalEl) return;
    modalEl.setAttribute('aria-hidden', 'false');
    modalEl.style.display = 'flex';
    modalEl.classList.add('open');
    document.body.classList.add('modal-open');
    // focus first focusable control inside
    setTimeout(() => {
      const focusEl = modalEl.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if (focusEl) try { focusEl.focus(); } catch(e) {}
    }, 80);
  }
  function closeModal(modalEl) {
    if (!modalEl) return;
    modalEl.setAttribute('aria-hidden','true');
    modalEl.classList.remove('open');
    modalEl.style.display = 'none';
    document.body.classList.remove('modal-open');
    // revoke any stored blob URL on the modal (receipt modal uses _invoiceBlob)
    try {
      if (modalEl._invoiceBlobUrl) {
        // keep a short delay for UX (not necessary) then revoke
        const url = modalEl._invoiceBlobUrl;
        modalEl._invoiceBlobUrl = null;
        setTimeout(()=>{ try{ URL.revokeObjectURL(url); }catch(e){} }, 60000);
      }
    } catch(e){}
  }

  // close by delegation: any element with data-action starting with "close" will close its nearest .modal ancestor
  document.addEventListener('click', (ev) => {
    const target = ev.target;
    // if clicking a close button (data-action or .modal-close)
    const actionEl = target.closest('[data-action]') || target.closest('.modal-close');
    if (actionEl) {
      const act = actionEl.getAttribute('data-action') || actionEl.dataset.action || '';
      if (act && act.startsWith('close')) {
        const modal = actionEl.closest('.modal');
        if (modal) closeModal(modal);
        // some actions like close-cart
        if (act === 'close-cart') {
          const cp = document.getElementById('cart-panel'); if (cp) closeModal(cp);
        }
        return;
      }
    }
    // clicking outside modal content to close
    const modalRoot = target.closest('.modal');
    if (modalRoot && modalRoot.classList.contains('open') && target === modalRoot) {
      closeModal(modalRoot);
    }
  });

  // ESC to close topmost modal
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      const openModalEl = document.querySelector('.modal.open');
      if (openModalEl) closeModal(openModalEl);
    }
  });

  /* ---------------------
     Product rendering
     ---------------------*/
  const productGrid = $('#product-grid');
  const productTemplate = document.getElementById('product-card-template')?.content;

  function createProductCard(product) {
    if (!productTemplate) {
      const p = document.createElement('article');
      p.textContent = product.title || product.id;
      return p;
    }
    const node = document.importNode(productTemplate, true);
    const art = node.querySelector('.product-card');
    art.dataset.productId = product.id;
    const img = node.querySelector('.product-image');
    img.src = (product.images && product.images[0]) || '';
    img.alt = product.title || product.id;
    node.querySelector('.product-title').textContent = product.title || product.id;
    node.querySelector('.product-size').textContent = (product.sizes||[]).join(' • ');
    node.querySelector('.product-id').textContent = product.id;
    node.querySelector('.price').textContent = formatPrice(product.price);
    // actions
    node.querySelector('[data-action="add-to-cart"]')?.addEventListener('click', (e) => {
      e.preventDefault();
      if (!product.available) { toast('Sold out'); return; }
      // if product has sizes, open modal
      if (product.sizes && product.sizes.length) openProductModal(product.id);
      else addToCart(product.id,1,'');
    });
    node.querySelector('.more-info')?.addEventListener('click', (e)=>{ e.preventDefault(); openProductModal(product.id); });
    node.querySelector('[data-action="open-modal"]')?.addEventListener('click', (e)=>{ e.preventDefault(); openProductModal(product.id); });
    return node;
  }

  function renderProducts(reset = true) {
    if (!productGrid) return;
    if (reset) productGrid.innerHTML = '';
    const list = products.filter(p => p.available !== false);
    const toShow = list.slice(0, LOAD_BATCH * (parseInt(productGrid.dataset.renderBatch||1) || 1));
    toShow.forEach(p => productGrid.appendChild(createProductCard(p)));
    const loadMore = $('#load-more');
    if (list.length <= toShow.length) loadMore && (loadMore.style.display = 'none'); else loadMore && (loadMore.style.display = 'inline-block');
  }

  // Load more
  $('#load-more')?.addEventListener('click', (e) => {
    e.preventDefault();
    productGrid.dataset.renderBatch = (parseInt(productGrid.dataset.renderBatch||1) + 1).toString();
    renderProducts(false);
  });

  /* ---------------------
     Simple product modal
     ---------------------*/
  const productModal = $('#product-modal');
  function openProductModal(id) {
    const p = products.find(x => x.id === id);
    if (!p) { toast('Product not found'); return; }
    // fill content
    const gallery = $('#modal-gallery'); const thumbs = $('#modal-thumbs');
    const title = $('#modal-title'); const desc = $('.modal-desc'); const priceEl = document.querySelector('.modal-price');
    const metaId = document.querySelector('.meta-id'); const qty = $('#modal-qty');
    if (gallery) gallery.innerHTML = '';
    if (thumbs) thumbs.innerHTML = '';
    (p.images || []).forEach((src, idx) => {
      const img = document.createElement('img'); img.src = src; img.alt = p.title + ' ' + (idx+1); img.dataset.idx = idx;
      if (idx !== 0) img.style.display = 'none';
      img.className = 'modal-main-img';
      gallery && gallery.appendChild(img);
      const t = document.createElement('img'); t.src = src; t.className = 'thumb'; t.addEventListener('click', ()=> {
        $$('.modal-main-img', gallery).forEach(i=>i.style.display='none');
        gallery.querySelector(`img[data-idx="${idx}"]`).style.display = '';
      });
      thumbs && thumbs.appendChild(t);
    });
    if (title) title.textContent = p.title || '';
    if (priceEl) priceEl.textContent = formatPrice(p.price || 0);
    if (desc) desc.textContent = p.description || '';
    if (metaId) metaId.textContent = p.id || '';
    if (qty) qty.value = 1;
    // open
    productModal && openModal(productModal);
    // set current product pointer
    productModal._currentProduct = p;
  }

  /* ---------------------
     Cart UI functions
     ---------------------*/
  const cartPanel = $('#cart-panel');
  function updateCartUI() {
    const cartContents = $('#cart-contents');
    const cartBadge = $('#cart-badge');
    const cartSubtotalEl = $('#cart-subtotal');
    if (!cartContents) return;
    cartContents.innerHTML = '';
    if (!cart || cart.length === 0) {
      cartContents.innerHTML = `<div class="cart-empty"><i class="fa fa-box-open fa-3x"></i><p>Your cart is empty. Add a dress you love!</p></div>`;
      if (cartBadge) cartBadge.textContent = '0';
      if (cartSubtotalEl) cartSubtotalEl.textContent = formatPrice(0);
      $('#cart-header-checkout') && ($('#cart-header-checkout').disabled = true);
      $('#checkout-btn') && ($('#checkout-btn').disabled = true);
      return;
    }
    let subtotal = 0;
    cart.forEach(item => {
      const prod = products.find(p => p.id === item.id) || {};
      const tpl = document.getElementById('cart-item-template').content.cloneNode(true);
      const el = tpl.querySelector('.cart-item');
      el.dataset.productId = item.id;
      el.querySelector('.cart-item-thumb').src = (prod.images && prod.images[0]) || '';
      el.querySelector('.cart-item-title').textContent = prod.title || item.id;
      el.querySelector('.cart-item-meta').textContent = `${item.size || ''} • ${prod.id || ''}`;
      el.querySelector('.unit-price').textContent = `Unit: ${formatPrice(prod.price||0)}`;
      el.querySelector('.cart-item-qty').value = item.qty || 1;
      el.querySelector('.item-price').textContent = formatPrice((prod.price||0) * (item.qty||1));
      // qty change
      el.querySelector('.cart-item-qty').addEventListener('change', (ev)=>{
        let v = Number(ev.target.value||1); if (v < 1) v = 1;
        item.qty = v; saveCart(cart); updateCartUI();
      });
      el.querySelector('.cart-item-remove').addEventListener('click', (ev)=>{
        ev.preventDefault();
        cart = cart.filter(c => c.id !== item.id);
        saveCart(cart);
        updateCartUI();
      });
      cartContents.appendChild(tpl);
      subtotal += (prod.price || 0) * (item.qty || 1);
    });
    if (cartBadge) cartBadge.textContent = String(cart.length || 0);
    if (cartSubtotalEl) cartSubtotalEl.textContent = formatPrice(subtotal);
    $('#cart-header-checkout') && ($('#cart-header-checkout').disabled = false);
    $('#checkout-btn') && ($('#checkout-btn').disabled = false);
  }

  // open/close cart
  $('#cart-toggle')?.addEventListener('click', ()=> {
    if (!cartPanel) return;
    const open = cartPanel.classList.contains('open');
    if (open) closeModal(cartPanel); else { openModal(cartPanel); updateCartUI(); }
  });
  document.querySelectorAll('[data-action="close-cart"]').forEach(btn => btn.addEventListener('click', ()=> closeModal(cartPanel)));
  $('#clear-cart')?.addEventListener('click', (e) => { e.preventDefault(); cart = []; saveCart(cart); updateCartUI(); toast('Cart cleared'); });

  function addToCart(id, qty = 1, size = '') {
    const p = products.find(pp => pp.id === id);
    if (!p || p.available === false) { toast('Item unavailable'); return; }
    if (cart.some(c => c.id === id)) { toast('Item already in cart'); return; }
    cart.push({ id, qty: Math.max(1, Number(qty||1)), size: size || '' });
    saveCart(cart); updateCartUI();
    toast('Added to cart');
    openModal(cartPanel);
  }

  /* ---------------------
     Checkout modal & pay flow (uses PaystackPop or simulation)
     ---------------------*/
  async function openCheckoutModal(items) {
    const modalEl = $('#checkout-modal');
    if (!modalEl) return;
    const itemsWrap = $('#checkout-items');
    const sub = $('#checkout-subtotal');
    const sub2 = $('#checkout-subtotal-2');
    const feeEl = $('#checkout-fee');
    const feeEl2 = $('#checkout-fee-2');
    const totEl = $('#checkout-total');
    const totEl2 = $('#checkout-total-2');
    const countEl = $('#checkout-count');
    if (!itemsWrap) return;
    itemsWrap.innerHTML = '';
    const enriched = items.map(it => {
      const p = products.find(pp => pp.id === it.id) || {};
      const unit = p.price || 0; const qty = Number(it.qty||1); const line = +(unit * qty);
      return { id: it.id, title: p.title||it.id, image: (p.images&&p.images[0])||'', size: it.size||'', qty, unit, line };
    });
    const subtotal = enriched.reduce((s,x)=>s + x.line, 0);
    const fee = +(subtotal * 0.0295).toFixed(2);
    const total = +(subtotal + fee).toFixed(2);
    enriched.forEach(it => {
      const row = document.createElement('div'); row.className = 'checkout-item';
      row.innerHTML = `<img src="${it.image}" alt="${it.title}" /><div class="meta">${it.title}<small style="display:block;color:var(--muted)">${it.size?('Size: '+it.size+' • '):''}Qty: ${it.qty} • ID: ${it.id}</small></div><div style="margin-left:auto;text-align:right"><div style="font-weight:800">${formatPrice(it.unit)}</div><div style="color:var(--muted)">${formatPrice(it.line)}</div></div>`;
      itemsWrap.appendChild(row);
    });
    sub && (sub.textContent = formatPrice(subtotal));
    sub2 && (sub2.textContent = formatPrice(subtotal));
    feeEl && (feeEl.textContent = formatPrice(fee));
    feeEl2 && (feeEl2.textContent = formatPrice(fee));
    totEl && (totEl.textContent = formatPrice(total));
    totEl2 && (totEl2.textContent = formatPrice(total));
    countEl && (countEl.textContent = String(enriched.length));
    // attach snapshot for later
    modalEl._checkoutItems = enriched;
    modalEl._checkoutSubtotal = subtotal;
    modalEl._checkoutFee = fee;
    modalEl._checkoutTotal = total;
    // wire actions
    $('#checkout-cancel')?.addEventListener('click', ()=> closeModal(modalEl));
    $('#checkout-clear')?.addEventListener('click', ()=> { cart = []; saveCart(cart); updateCartUI(); toast('Cart cleared'); closeModal(modalEl); });
    $('#checkout-pay')?.onclick = async function () {
      // minimal validation
      const name = (document.getElementById('checkout-name')?.value || '').trim();
      const email = (document.getElementById('checkout-email')?.value || '').trim();
      if (!name) { toast('Enter your name'); return; }
      if (!email || !email.includes('@')) { toast('Provide a valid email'); return; }
      // prepare buyer snapshot
      modalEl._buyer = {
        name, email,
        phone: (document.getElementById('checkout-phone')?.value||'').trim(),
        address1: (document.getElementById('checkout-address1')?.value||'').trim(),
        city: (document.getElementById('checkout-city')?.value||'').trim(),
        postal: (document.getElementById('checkout-postal')?.value||'').trim(),
      };
      // call process
      await processCheckoutPayment();
    };
    openModal(modalEl);
  }

  function closeCheckoutModal() { closeModal($('#checkout-modal')); }

  async function processCheckoutPayment() {
    const modal = $('#checkout-modal');
    if (!modal || !modal._checkoutItems) return;
    const subtotal = modal._checkoutSubtotal || 0;
    const fee = modal._checkoutFee || 0;
    const total = modal._checkoutTotal || subtotal + fee;
    const buyer = modal._buyer || {};
    const email = buyer.email || '';
    const name = buyer.name || '';
    // check Paystack
    if (!window.PaystackPop || !PAYSTACK_PUBLIC_KEY || PAYSTACK_PUBLIC_KEY.includes('YOUR_PAYSTACK_PUBLIC_KEY_HERE')) {
      // simulate
      const ok = confirm(`Paystack not configured. Simulate payment of ${formatPrice(total)}?`);
      if (!ok) return;
      const fakeRef = 'SIM-' + Math.random().toString(36).slice(2, 10).toUpperCase();
      await handleSuccessfulPayment(fakeRef, email || name || 'guest@example.com', modal._checkoutItems.map(i=>({ id: i.id, qty: i.qty, size: i.size })), total, { name: buyer.name, phone: buyer.phone, address1: buyer.address1 });
      closeCheckoutModal();
      return;
    }
    try {
      const amount = Math.round(total * 100);
      const handler = PaystackPop.setup({
        key: PAYSTACK_PUBLIC_KEY,
        email: email,
        amount: amount,
        currency: PAYSTACK_CURRENCY,
        metadata: { custom_fields: [ { display_name: 'Buyer', variable_name:'buyer', value: buyer.name || '' } ] },
        callback: function(response){
          try {
            handleSuccessfulPayment(response.reference, email, modal._checkoutItems.map(i=>({ id: i.id, qty: i.qty, size: i.size })), total, { name: buyer.name, phone: buyer.phone });
          } catch(err) { console.error(err); }
          closeCheckoutModal();
        },
        onClose: function(){ toast('Payment closed'); }
      });
      handler.openIframe();
    } catch (err) {
      console.error('Paystack error', err);
      toast('Could not start payment — see console.');
    }
  }

  /* ---------------------
     Buy now (single item)
     ---------------------*/
  function openBuyNowModal(single) {
    const modal = $('#buynow-modal'); if (!modal) return;
    const wrap = $('#buynow-item'); if (!wrap) return;
    const p = products.find(pp=>pp.id === single.id);
    if (!p) { toast('Item not found'); return; }
    wrap.innerHTML = '';
    const row = document.createElement('div'); row.className = 'checkout-item';
    row.innerHTML = `<img src="${(p.images && p.images[0]) || ''}" alt="${p.title}" /><div class="meta">${p.title}<small style="display:block;color:var(--muted)">${single.size?('Size: '+single.size+' • '):''}Qty: ${single.qty}</small></div><div style="margin-left:auto;text-align:right"><div style="font-weight:800">${formatPrice(p.price)}</div><div style="color:var(--muted)">${formatPrice((p.price||0)*single.qty)}</div></div>`;
    wrap.appendChild(row);
    // attach totals
    $('#buynow-subtotal') && ($('#buynow-subtotal').textContent = formatPrice((p.price||0)*single.qty));
    const fee = +(((p.price||0)*single.qty) * 0.0295).toFixed(2);
    $('#buynow-fee') && ($('#buynow-fee').textContent = formatPrice(fee));
    $('#buynow-total') && ($('#buynow-total').textContent = formatPrice((p.price||0)*single.qty + fee));
    modal._buynowItem = { id: single.id, qty: single.qty, size: single.size, subtotal: (p.price||0)*single.qty, fee, total: (p.price||0)*single.qty + fee };
    // wire cancel/pay
    $('#buynow-cancel')?.addEventListener('click', ()=> closeModal(modal));
    $('#buynow-pay')?.addEventListener('click', async ()=> {
      const name = (document.getElementById('buynow-name')?.value||'').trim();
      const email = (document.getElementById('buynow-email')?.value||'').trim();
      if (!name) { toast('Name required'); return; }
      if (!email || !email.includes('@')) { toast('Valid email required'); return; }
      // simulate/pay as checkout
      if (!window.PaystackPop || !PAYSTACK_PUBLIC_KEY || PAYSTACK_PUBLIC_KEY.includes('YOUR_PAYSTACK_PUBLIC_KEY_HERE')) {
        const ok = confirm(`Paystack not configured. Simulate payment of ${formatPrice(modal._buynowItem.total)}?`);
        if (!ok) return;
        const fakeRef = 'SIM-' + Math.random().toString(36).slice(2,10).toUpperCase();
        await handleSuccessfulPayment(fakeRef, email, [{ id: modal._buynowItem.id, qty: modal._buynowItem.qty, size: modal._buynowItem.size }], modal._buynowItem.total, { name, phone: (document.getElementById('buynow-phone')?.value||'').trim() });
        closeModal(modal);
        return;
      }
      // otherwise use Paystack similar to checkout
      try {
        const amount = Math.round(modal._buynowItem.total * 100);
        const handler = PaystackPop.setup({
          key: PAYSTACK_PUBLIC_KEY,
          email,
          amount,
          currency: PAYSTACK_CURRENCY,
          metadata: { custom_fields: [{ display_name: "Buyer", variable_name: "buyer_name", value: name }] },
          callback: function(response) {
            handleSuccessfulPayment(response.reference, email, [{ id: modal._buynowItem.id, qty: modal._buynowItem.qty, size: modal._buynowItem.size }], modal._buynowItem.total, { name });
          },
          onClose: function(){ toast('Payment closed'); }
        });
        handler.openIframe();
      } catch (err) { console.error(err); toast('Payment error'); }
    });
    openModal(modal);
  }

  // hook modal buy button on product modal
  $('#modal-buy')?.addEventListener('click', (e) => {
    e.preventDefault();
    const p = productModal && productModal._currentProduct;
    if (!p) return;
    const qty = Number($('#modal-qty')?.value || 1);
    openBuyNowModal({ id: p.id, qty, size: '' });
  });
  // hook modal add-to-cart inside product modal
  $('#modal-add')?.addEventListener('click', (e) => {
    e.preventDefault();
    const p = productModal && productModal._currentProduct;
    if (!p) return;
    const qty = Number($('#modal-qty')?.value || 1);
    addToCart(p.id, qty, '');
    closeModal(productModal);
  });

  /* ---------------------
     Simple invoice PDF generation using jsPDF
     Returns object { url, blob }
     ---------------------*/
  async function fetchImageAsDataURL(url) {
    if (!url) return null;
    try {
      const res = await fetch(url, { cache:'no-cache' });
      if (!res.ok) return null;
      const blob = await res.blob();
      return await new Promise((resolve, reject) => {
        const r = new FileReader();
        r.onloadend = () => resolve(r.result);
        r.onerror = reject;
        r.readAsDataURL(blob);
      });
    } catch (e) { return null; }
  }

  async function generateInvoiceBlobUrl(order) {
    const { jsPDF } = window.jspdf || {};
    if (!jsPDF) throw new Error('jsPDF missing');
    const doc = new jsPDF({ unit: 'pt', format: 'a4' });
    let y = 40;
    doc.setFontSize(18); doc.text('Tiny Threads — Invoice', 40, y); y += 24;
    doc.setFontSize(11);
    doc.text(`Ref: ${(order.reference||'REF-'+Math.random().toString(36).slice(2,8).toUpperCase())}`, 40, y); y += 16;
    doc.text(`Date: ${new Date(order.paidAt||nowISO()).toLocaleString()}`, 40, y); y += 18;
    doc.setFont('helvetica','bold'); doc.text('Billed to:', 40, y); doc.setFont('helvetica','normal'); y += 14;
    const buyerName = (order.buyerDetails && order.buyerDetails.name) || order.buyerEmail || '—';
    doc.text(String(buyerName), 40, y); y += 14;
    if (order.buyerDetails && order.buyerDetails.address1) { doc.text(String(order.buyerDetails.address1), 40, y); y += 14; }
    y += 8;
    // items
    doc.setFont('helvetica','bold'); doc.text('Items', 40, y); y += 14;
    doc.setFont('helvetica','normal');
    for (const it of (order.items||[])) {
      const prod = products.find(p => p.id === it.id) || {};
      const title = prod.title || it.id;
      const qty = Number(it.qty||1);
      const unit = Number(prod.price || it.unit || 0);
      const line = +(qty * unit);
      const text = `${title} — ${it.size ? 'Size: '+it.size+' • ' : ''}ID: ${it.id}`;
      const lines = doc.splitTextToSize(text, 380);
      doc.text(lines, 40, y); // multi line
      // price at right
      doc.text(formatPrice(line), 520, y, { align: 'right' });
      // compute line height
      y += (lines.length * 12) + 6;
      if (y > doc.internal.pageSize.getHeight() - 120) { doc.addPage(); y = 40; }
    }
    y += 10;
    doc.setFont('helvetica','bold');
    doc.text('Subtotal', 360, y); doc.text(formatPrice(order.total ? (order.total - (order.processingFee||0)) : 0), 520, y, { align: 'right' }); y += 14;
    doc.text('Processing fee', 360, y); doc.text(formatPrice(order.processingFee || 0), 520, y, { align: 'right' }); y += 16;
    doc.setFontSize(14); doc.setFont('helvetica','bold');
    doc.text('Total', 360, y); doc.text(formatPrice(order.total || 0), 520, y, { align: 'right' });
    // footer
    doc.setFontSize(9); doc.setFont('helvetica','normal');
    doc.text('Thank you for shopping with Tiny Threads', 40, doc.internal.pageSize.getHeight() - 40);
    const blob = doc.output('blob');
    const url = URL.createObjectURL(blob);
    return { url, blob };
  }

  /* ---------------------
     showReceiptModal wiring
     ---------------------*/
  function showReceiptModal(order, pdfInfo) {
    const modal = $('#receipt-modal'); if (!modal) return;
    const summary = $('#receipt-summary'); const itemsWrap = $('#receipt-items');
    const totalEl = $('#receipt-total'); const subEl = $('#receipt-subtotal'); const procEl = $('#receipt-processing');
    const refEl = $('#receipt-ref'); const refEl2 = $('#receipt-ref-2'); const dateEl = $('#receipt-date'); const methodEl = $('#receipt-method'); const statusEl = $('#receipt-status');
    const viewBtn = $('#receipt-view'); const dlBtn = $('#receipt-download'); const printBtn = $('#receipt-print');
    const previewWrap = $('#receipt-preview-wrap'); const previewFrame = $('#receipt-preview'); const loader = $('#preview-loader');

    // clear previous
    itemsWrap && (itemsWrap.innerHTML = '');
    summary && (summary.innerHTML = '');

    // header
    const reference = order.reference || ('REF-' + Math.random().toString(36).slice(2,8).toUpperCase());
    refEl && (refEl.textContent = reference);
    refEl2 && (refEl2.textContent = reference);
    dateEl && (dateEl.textContent = new Date(order.paidAt||nowISO()).toLocaleString());
    methodEl && (methodEl.textContent = order.method || 'Paystack');
    statusEl && (statusEl.textContent = (order.status||'paid').toUpperCase());

    // summary block
    const buyerName = (order.buyerDetails && order.buyerDetails.name) || order.buyerEmail || '—';
    const buyerEmail = order.buyerEmail || (order.buyerDetails && order.buyerDetails.email) || '';
    summary && (summary.innerHTML = `<div style="font-weight:800">${buyerName}</div><div style="color:var(--muted)">${buyerEmail}</div>`);

    // items
    (order.items||[]).forEach(it => {
      const prod = products.find(p => p.id === it.id) || {};
      const title = prod.title || it.id;
      const unit = prod.price || it.unit || 0;
      const qty = Number(it.qty||1);
      const line = +(unit * qty);
      const node = document.createElement('div'); node.className = 'receipt-item';
      node.innerHTML = `<img src="${(prod.images && prod.images[0])||''}" alt="${title}" /><div class="it-meta"><div style="font-weight:800">${title}</div><div style="color:var(--muted);font-size:13px">${it.size?('Size: '+it.size+' • '):''}ID: ${it.id}</div></div><div class="it-price"><div>${formatPrice(unit)}</div><div style="color:var(--muted);font-size:13px">${qty} ×</div><div style="font-weight:900;margin-top:6px">${formatPrice(line)}</div></div>`;
      itemsWrap && itemsWrap.appendChild(node);
    });

    // totals
    const processingFee = Number(order.processingFee || ((order.total||0) * 0.0295));
    const subtotal = +(((order.total||0) - processingFee).toFixed(2));
    subEl && (subEl.textContent = formatPrice(subtotal));
    procEl && (procEl.textContent = formatPrice(processingFee));
    totalEl && (totalEl.textContent = formatPrice(order.total || 0));

    // preview & actions
    previewWrap && (previewWrap.style.display = 'none');
    previewFrame && (previewFrame.src = '');
    // important: remove sandbox attribute if present so blob URI can render
    if (previewFrame && previewFrame.hasAttribute('sandbox')) previewFrame.removeAttribute('sandbox');

    // clear previous stored blob on modal
    if (modal._invoiceBlobUrl) {
      try { URL.revokeObjectURL(modal._invoiceBlobUrl); } catch(e) {}
      modal._invoiceBlobUrl = null;
    }

    // disable actions by default
    if (viewBtn) viewBtn.disabled = true;
    if (dlBtn) dlBtn.disabled = true;
    if (printBtn) printBtn.disabled = true;

    if (pdfInfo && pdfInfo.url) {
      modal._invoiceBlobUrl = pdfInfo.url;
      if (viewBtn) {
        viewBtn.disabled = false;
        viewBtn.onclick = (ev) => {
          ev.preventDefault();
          previewWrap.style.display = '';
          loader.style.display = '';
          previewFrame.onload = () => { try { loader.style.display = 'none'; } catch(e) {} };
          previewFrame.src = pdfInfo.url;
          // open in new tab as well (try; may be blocked by popup blocker)
          try { window.open(pdfInfo.url, '_blank'); } catch(e) {}
        };
      }
      if (dlBtn) {
        dlBtn.disabled = false;
        dlBtn.onclick = (ev) => {
          ev.preventDefault();
          const a = document.createElement('a');
          a.href = pdfInfo.url;
          a.download = `Invoice-${reference}.pdf`;
          document.body.appendChild(a);
          a.click();
          a.remove();
        };
      }
      if (printBtn) {
        printBtn.disabled = false;
        printBtn.onclick = (ev) => {
          ev.preventDefault();
          // prefer direct iframe print
          if (previewFrame && previewFrame.src) {
            try {
              // focus and print the iframe content
              previewFrame.contentWindow.focus();
              previewFrame.contentWindow.print();
            } catch (e) {
              // fallback: open new tab then call print
              const win = window.open(pdfInfo.url, '_blank');
              if (!win) { toast('Popup blocked — use Download'); return; }
              win.onload = () => { try { win.focus(); win.print(); } catch(e){} };
            }
          } else {
            // ensure preview loaded then print
            previewWrap.style.display = '';
            loader.style.display = '';
            previewFrame.onload = () => { try { loader.style.display = 'none'; previewFrame.contentWindow.focus(); previewFrame.contentWindow.print(); } catch(e){} };
            previewFrame.src = pdfInfo.url;
          }
        };
      }

      // pre-load into iframe (improves UX)
      setTimeout(()=> {
        try {
          previewWrap.style.display = '';
          loader.style.display = '';
          previewFrame.onload = () => { try { loader.style.display = 'none'; } catch(e){} };
          previewFrame.src = pdfInfo.url;
        } catch(e){}
      }, 120);
    } else {
      // no pdf available: keep buttons disabled and show modal (user can still close)
      if (viewBtn) viewBtn.onclick = () => toast('No PDF available');
      if (dlBtn) dlBtn.onclick = () => toast('No PDF available');
      if (printBtn) printBtn.onclick = () => toast('No PDF available');
    }

    // wire close buttons
    $('#receipt-close')?.addEventListener('click', ()=> closeModal(modal));
    $('#receipt-close-bottom')?.addEventListener('click', ()=> closeModal(modal));

    openModal(modal);
  }

  /* ---------------------
     Payment success handling: mark items sold, save order locally, generate invoice and show receipt
     ---------------------*/
  async function handleSuccessfulPayment(reference, buyerEmail, items, total, buyerDetails = {}) {
    try {
      // normalize items array
      const snapshotItems = (items||[]).map(it => ({ id: it.id, qty: it.qty || 1, size: it.size || '' }));
      // mark items as unavailable
      snapshotItems.forEach(it => {
        const p = products.find(pp => pp.id === it.id);
        if (p) p.available = false;
      });
      persistProducts();
      // calculate processing fee
      const processingFee = +((total * 0.0295) || 0).toFixed(2);
      const order = {
        reference: reference || ('REF-' + Math.random().toString(36).slice(2,8).toUpperCase()),
        buyerEmail: buyerEmail || '',
        buyerDetails: buyerDetails || {},
        items: snapshotItems,
        total: +(total || 0).toFixed(2),
        processingFee,
        paidAt: nowISO(),
        status: 'paid',
        method: 'Paystack'
      };
      // store order locally
      pushOrder(order);
      // remove purchased from cart
      const purchasedIds = snapshotItems.map(i => i.id);
      cart = cart.filter(c => !purchasedIds.includes(c.id));
      saveCart(cart);
      updateCartUI();
      renderProducts(true);
      // generate invoice and show receipt
      toast('Payment successful — generating receipt...');
      try {
        const pdfInfo = await generateInvoiceBlobUrl(order);
        showReceiptModal(order, pdfInfo);
      } catch (err) {
        console.error('Invoice generation failed', err);
        showReceiptModal(order, null);
      }
      return order;
    } catch (err) {
      console.error('handleSuccessfulPayment error', err);
      toast('Payment recorded but an error occurred (see console)');
      return null;
    }
  }

  // expose globally for Paystack callback compatibility
  window.handleSuccessfulPayment = handleSuccessfulPayment;

  /* ---------------------
     Purchase history panel
     ---------------------*/
  (function historyInit(){
    const historyToggle = $('#history-toggle');
    const historyModal = $('#history-modal');
    const historyList = $('#history-list');
    const historyBadge = $('#history-badge');
    const historyCount = $('#history-count');

    function render() {
      const orders = loadOrders();
      historyBadge && (historyBadge.textContent = String(orders.length || 0));
      historyCount && (historyCount.textContent = (orders.length || 0) + ' order' + (orders.length === 1 ? '' : 's'));
      if (!historyList) return;
      historyList.innerHTML = '';
      if (!orders || orders.length === 0) {
        historyList.innerHTML = `<div style="padding:18px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);text-align:center;color:var(--muted)"><i class="fa fa-box-open fa-2x"></i><div style="margin-top:8px">No purchases yet.</div></div>`;
        return;
      }
      orders.forEach(order => {
        const div = document.createElement('div'); div.className = 'history-item';
        const first = order.items && order.items[0] ? (products.find(p=>p.id===order.items[0].id) || {}) : {};
        const thumb = (first.images && first.images[0]) || '';
        const title = first.title || (order.items && order.items[0] && order.items[0].id) || 'Order';
        div.innerHTML = `<div class="history-left"><div class="history-thumb">${thumb ? `<img src="${thumb}" style="width:100%;height:100%;object-fit:cover;border-radius:8px">` : title.charAt(0)||'O'}</div><div class="history-meta"><div class="title">${title}</div><div class="sm">${new Date(order.paidAt).toLocaleString()} • ${order.items.length} item${order.items.length===1?'':'s'} • ${formatPrice(order.total)}</div></div></div><div class="history-actions"><button class="btn tiny outline view-receipt" data-ref="${order.reference}">View PDF</button><button class="btn tiny download-receipt" data-ref="${order.reference}">Download</button><button class="btn tiny delete-order" data-ref="${order.reference}"><i class="fa fa-trash"></i></button></div>`;
        historyList.appendChild(div);
      });
      // wire buttons
      historyList.querySelectorAll('.view-receipt').forEach(btn => btn.addEventListener('click', async (e) => {
        const ref = btn.dataset.ref;
        const orders = loadOrders();
        const order = orders.find(o => o.reference === ref);
        if (!order) { toast('Order not found'); return; }
        try {
          const pdfInfo = await generateInvoiceBlobUrl(order);
          showReceiptModal(order, pdfInfo);
        } catch (err) {
          console.error(err); showReceiptModal(order, null);
        }
      }));
      historyList.querySelectorAll('.download-receipt').forEach(btn => btn.addEventListener('click', async (e)=> {
        const ref = btn.dataset.ref;
        const orders = loadOrders();
        const order = orders.find(o => o.reference === ref);
        if (!order) { toast('Order not found'); return; }
        try {
          const pdfInfo = await generateInvoiceBlobUrl(order);
          const a = document.createElement('a'); a.href = pdfInfo.url; a.download = `Invoice-${order.reference}.pdf`; document.body.appendChild(a); a.click(); a.remove();
          setTimeout(()=>{ try{ URL.revokeObjectURL(pdfInfo.url); }catch(e){} }, 60000);
        } catch (err) { console.error(err); toast('Could not create PDF'); }
      }));
      historyList.querySelectorAll('.delete-order').forEach(btn => btn.addEventListener('click', (e)=>{
        const ref = btn.dataset.ref;
        if (!confirm('Remove this order from local history?')) return;
        const arr = loadOrders().filter(o=>o.reference !== ref);
        saveOrders(arr);
        render();
        toast('Order removed from history');
      }));
    }

    historyToggle?.addEventListener('click', (e)=>{
      e.preventDefault();
      if (!historyModal) return;
      const open = historyModal.classList.contains('open');
      if (open) closeModal(historyModal);
      else { render(); openModal(historyModal); }
    });

    $('#history-close')?.addEventListener('click', ()=> closeModal($('#history-modal')));
    $('#history-close-bottom')?.addEventListener('click', ()=> closeModal($('#history-modal')));
    $('#history-clear-all')?.addEventListener('click', ()=>{
      if (!confirm('Clear all saved purchase history from this device?')) return;
      localStorage.removeItem(STORAGE_KEYS.ORDERS);
      render();
      toast('Purchase history cleared');
    });

    render();
  })();

  /* ---------------------
     Mobile nav toggle
     ---------------------*/
  (function mobileNav() {
    const toggle = $('#mobile-toggle'); const nav = $('#mobile-nav');
    if (!toggle || !nav) return;
    toggle.addEventListener('click', (e)=> {
      e.preventDefault();
      nav.classList.toggle('open');
      const open = nav.classList.contains('open');
      nav.setAttribute('aria-hidden', open ? 'false' : 'true');
      toggle.setAttribute('aria-expanded', String(open));
    });
    // close when clicking a link
    $$('#mobile-nav a').forEach(a => a.addEventListener('click', ()=> { nav.classList.remove('open'); nav.setAttribute('aria-hidden','true'); toggle.setAttribute('aria-expanded','false'); }));
    // ensure visibility on resize
    window.addEventListener('resize', ()=> {
      if (window.innerWidth > MOBILE_BREAKPOINT) { nav.classList.remove('open'); nav.setAttribute('aria-hidden','true'); toggle.setAttribute('aria-expanded','false'); }
    });
  })();

  /* ---------------------
     UI fixes: footer year & newsletter binding
     ---------------------*/
  document.addEventListener('DOMContentLoaded', ()=> {
    // set footer year
    const fy = document.getElementById('footer-year');
    if (fy) fy.textContent = new Date().getFullYear();

    // newsletter
    const newsletter = document.getElementById('footer-newsletter');
    newsletter?.addEventListener('submit', (e) => {
      e.preventDefault();
      const em = document.getElementById('footer-email')?.value || '';
      if (!em || !em.includes('@')) { toast('Provide a valid email'); return; }
      toast('Subscribed (demo). Add backend to save emails.');
      newsletter.reset();
    });

    // contact form
    const contactForm = document.getElementById('contact-form');
    contactForm?.addEventListener('submit', (e) => {
      e.preventDefault();
      toast('Thanks! Message sent (demo). Owner needs a backend to actually receive messages.');
      contactForm.reset();
    });

    // initial render & cart UI
    renderProducts(true);
    updateCartUI();
  });

  /* ---------------------
     Expose small debug API
     ---------------------*/
  window._tinyThreads = {
    getState: ()=> ({ products, cart, orders: loadOrders() }),
    setPaystackKey: (k) => { if (!k) return; PAYSTACK_PUBLIC_KEY = k; console.log('Paystack key set'); }
  };

  console.log('[tinythreads] script loaded — modal close + receipt preview fix applied');
})();
</script>


</body>
</html>
