<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kids Wear — One-off Dresses</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Lexend:wght@600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4Q5GR0GCN9"></script>
  <!-- Paystack inline -->
  <script src="https://js.paystack.co/v1/inline.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- STYLE: full page styles (place inside <head> or a CSS file) -->




<style>

:root{
  --brand-1: #ff6b8a;        /* playful pink */
  --brand-2: #ffd166;        /* sunny yellow */
  --accent:   #6ee7b7;       /* mint accent */
  --bg:       #fffaf6;
  --muted:    #6b7280;
  --card:     #ffffff;
  --glass:    rgba(255,255,255,0.6);
  --shadow:   0 8px 24px rgba(23,23,23,0.08);
  --radius-lg: 18px;
  --radius-md: 12px;
  --radius-sm: 8px;
  --max-width: 1200px;
  --transition-fast: 180ms;
  --transition: 280ms;
  --elev: 0 10px 30px rgba(16,24,40,0.08);
  --focus: 0 0 0 4px rgba(110,231,183,0.18);
  --text: #0f172a;
  --success: #10b981;
}

/* quick reset */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg, #fffaf6 0%, #fff7f0 40%);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.45;
  scroll-behavior:smooth;
  -webkit-tap-highlight-color: transparent;
}

/* container helper */
.container{
  width:90%;
  max-width:var(--max-width);
  margin:0 auto;
}

/* simple utilities */
.sr-only{
  position:absolute!important;
  width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
}
.lead{font-size:1.05rem;color:var(--muted)}

/* -------------------------
   HEADER
   -------------------------*/
.site-header{
  position:sticky;
  top:0;
  z-index:60;
  backdrop-filter: blur(6px);
  background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.65));
  border-bottom: 1px solid rgba(15,23,42,0.04);
  box-shadow: 0 6px 18px rgba(18,24,36,0.03);
}
.header-inner{
  display:flex;
  align-items:center;
  gap:12px;
  height:72px;
  width:90%;
  max-width:var(--max-width);
  margin:0 auto;
  padding:8px 0;
}
.logo{
  display:flex;
  gap:10px;
  align-items:center;
  text-decoration:none;
  color:var(--text);
  font-weight:700;
  font-size:1.1rem;
}
.logo-ico{
  font-size:20px;
  color:var(--brand-1);
  transform:translateY(-1px);
  text-shadow: 0 2px 8px rgba(255,107,138,0.12);
}
.brand-name{letter-spacing:0.2px}
.main-nav{margin-left:16px;flex:1}
.main-nav .nav-list{
  display:flex;
  gap:12px;
  align-items:center;
  list-style:none;
  padding:0;margin:0;
}
.main-nav a{
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:8px 12px;
  border-radius:10px;
  color:var(--muted);
  text-decoration:none;
  font-weight:600;
  transition:all var(--transition);
}
.main-nav a:hover, .main-nav a:focus{
  color:var(--text);
  transform:translateY(-2px);
  background:linear-gradient(90deg, rgba(255,107,138,0.06), rgba(255,209,102,0.04));
}

.header-actions{
  display:flex;
  gap:8px;
  align-items:center;
}

/* icon buttons */
.icon-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border:0;
  background:transparent;
  padding:8px;
  border-radius:10px;
  cursor:pointer;
  color:var(--muted);
  transition:all var(--transition);
}
.icon-btn:focus{outline:none;box-shadow:var(--focus)}
.icon-btn:hover{transform:translateY(-3px); color:var(--text)}

/* badge */
.badge{
  display:inline-block;
  min-width:20px;
  background:var(--brand-1);
  color:#fff;
  padding:2px 6px;
  font-size:12px;
  border-radius:999px;
  margin-left:6px;
  vertical-align:middle;
  text-align:center;
}

/* hamburger mobile */
.hamburger{
  display:inline-flex;
  align-items:center;
  gap:8px;
  background:var(--card);
  border-radius:12px;
  border:1px solid rgba(15,23,42,0.04);
  padding:8px 10px;
}
.hamburger .fa-bars{font-size:18px}

/* MOBILE NAV */
.mobile-nav{
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:14px;
  border-top:1px solid rgba(15,23,42,0.03);
  background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.95));
  transform-origin:top;
  transition:all 220ms ease;
  overflow:hidden;
  max-height:0;
}
.mobile-nav.open{max-height:420px}
.mobile-nav ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:6px}
.mobile-nav a{padding:12px;border-radius:10px;text-decoration:none;color:var(--text);font-weight:600}
.mobile-nav-footer{margin-top:12px}

/* -------------------------
   HERO / SLIDER
   -------------------------*/
.hero{
  margin:18px auto;
  width:100%;
}
.hero-slider{
  position:relative;
  border-radius:var(--radius-lg);
  overflow:hidden;
  box-shadow:var(--elev);
  min-height:300px;
}
.slide{
  display:block;
  width:100%;
  height:100%;
  position:relative;
}
.slide-inner{
  display:grid;
  grid-template-columns: 1fr;
  align-items:center;
  min-height:320px;
}

/* hero image */
.hero-media img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  filter:contrast(1.02) saturate(1.05);
  transform:scale(1.02);
  transition:transform 6s ease;
}
.hero-slider .slide.active .hero-media img{ transform: scale(1); }

/* caption overlay */
.hero-caption{
  position:absolute;
  left:14px;
  bottom:18px;
  z-index:3;
  background:linear-gradient(90deg, rgba(255,255,255,0.92), rgba(255,255,255,0.72));
  padding:18px;
  border-radius:14px;
  width:calc(100% - 40px);
  max-width:560px;
  box-shadow:var(--shadow);
}
.hero-caption h1, .hero-caption h2{
  margin:0 0 6px 0;
  font-size:1.45rem;
  line-height:1.1;
  color:var(--text);
}
.hero-caption p{margin:0 0 12px 0;color:var(--muted)}
.hero-cta{display:flex;gap:10px;flex-wrap:wrap}

/* hero controls */
.hero-controls{
  position:absolute;
  right:12px;
  top:12px;
  display:flex;
  gap:10px;
  align-items:center;
  z-index:4;
}
.hero-prev, .hero-next{
  border:0;
  background:rgba(255,255,255,0.9);
  padding:8px 10px;
  border-radius:10px;
  cursor:pointer;
  box-shadow:0 6px 18px rgba(12,18,28,0.06);
}
.hero-dots{display:flex;gap:6px;margin-left:8px}
.hero-dots .dot{
  width:10px;height:10px;border-radius:999px;border:0;background:rgba(12,18,28,0.12);cursor:pointer;
}
.hero-dots .dot.active{background:linear-gradient(90deg,var(--brand-1),var(--brand-2))}

/* -------------------------
   CATEGORIES (CHIPS)
   -------------------------*/
.categories{margin:20px auto}
.section-title{display:flex;align-items:center;gap:8px;font-size:1.05rem;margin:6px 0 10px 0}
.category-chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{
  border:1px solid rgba(15,23,42,0.06);
  background:linear-gradient(180deg,white, rgba(255,255,255,0.92));
  padding:8px 12px;
  border-radius:999px;
  cursor:pointer;
  font-weight:600;
  display:inline-flex;
  align-items:center;
  gap:8px;
  transition:all var(--transition);
}
.chip:hover{transform:translateY(-3px)}
.chip.active{
  background:linear-gradient(90deg,var(--brand-1),var(--brand-2));
  color:white;
  box-shadow: 0 10px 30px rgba(255,107,138,0.12);
}

/* -------------------------
   SHOP / PRODUCT GRID
   -------------------------*/
.shop{margin:20px auto 36px}
.shop-header{display:flex;flex-direction:column;gap:12px;margin-bottom:8px}
.shop-header h2{margin:0;display:flex;align-items:center;gap:8px;font-size:1.15rem}
.shop-controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.search-wrap{display:flex;gap:6px;align-items:center;border-radius:12px;padding:6px;background:var(--card);box-shadow:var(--shadow)}
.search-wrap input[type="search"]{
  border:0;padding:10px 8px;min-width:150px;border-radius:10px;outline:none;font-size:0.95rem;
}
.search-wrap .icon-btn{padding:8px 10px}
.sort-wrap select{
  padding:8px 10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);background:var(--card);
}

/* product grid */
.product-grid{
  display:grid;
  gap:12px;
  width:100%;
  margin-top:12px;
}

/* grid columns: mobile-first (1 column) */
.product-grid{grid-template-columns: 1fr}

/* product card */
.product-card{
  display:flex;
  flex-direction:column;
  background:var(--card);
  border-radius:14px;
  overflow:hidden;
  box-shadow:var(--shadow);
  transition:transform var(--transition), box-shadow var(--transition);
  border:1px solid rgba(15,23,42,0.03);
}
.product-card:hover{transform:translateY(-6px);box-shadow:0 18px 50px rgba(16,24,40,0.06)}
.product-media{position:relative;padding-top:70%;overflow:hidden;background:linear-gradient(180deg,rgba(255,246,245,1),rgba(255,250,245,0.6))}
.product-media img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;display:block}
.product-media .quickview{
  position:absolute;right:8px;top:8px;background:rgba(255,255,255,0.9);border-radius:10px;padding:8px;border:0;cursor:pointer;box-shadow:0 6px 18px rgba(12,18,28,0.06)
}
.product-tag{
  position:absolute;left:8px;top:8px;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:white;padding:6px 10px;border-radius:999px;font-weight:700;display:inline-flex;gap:8px;align-items:center;font-size:13px
}

.product-body{padding:12px 14px 16px;display:flex;flex-direction:column;gap:10px}
.product-title{font-size:1rem;margin:0;color:var(--text)}
.product-meta{margin:0;color:var(--muted);font-size:13px}
.product-bottom{display:flex;align-items:center;justify-content:space-between;gap:8px}
.price-wrap .price{font-weight:800;color:var(--brand-1)}
.card-actions{display:flex;align-items:center;gap:8px}
.btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;border:0;cursor:pointer;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:white;font-weight:700;transition:transform var(--transition)}
.btn:hover{transform:translateY(-3px)}
.btn.tiny{padding:6px 8px;font-weight:700;border-radius:10px;font-size:0.92rem}
.btn.large{padding:12px 18px;font-size:1rem;border-radius:14px}
.btn.outline{background:transparent;border:1px solid rgba(15,23,42,0.06);color:var(--text);font-weight:700}
.btn.accent{background:linear-gradient(90deg,var(--accent), #34d399);color:#083325}

/* sold-out style */
.product-card.sold-out{
  opacity:0.62;filter:grayscale(0.2);pointer-events:none;
}

/* load more */
.load-more-wrap{text-align:center;margin:18px 0}
.load-more-wrap .btn{background:linear-gradient(90deg,var(--brand-2),var(--brand-1));}

/* no results */
.no-results{padding:38px;text-align:center;color:var(--muted)}

/* -------------------------
   PRODUCT MODAL
   -------------------------*/
.modal{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
  background:rgba(8,15,24,0.5);
  padding:20px;
  opacity:0;pointer-events:none;transition:opacity 220ms ease;
  z-index:120;
}
.modal.open{opacity:1;pointer-events:auto}
.modal-inner{
  width:100%;
  max-width:980px;
  background:linear-gradient(180deg,#fff,#fffefc);
  border-radius:18px;
  padding:16px;
  box-shadow:0 30px 60px rgba(10,20,30,0.2);
  position:relative;
}
.modal-close{position:absolute;right:14px;top:14px;border:0;background:transparent;padding:8px;border-radius:10px;cursor:pointer;color:var(--muted)}
.modal-grid{display:grid;grid-template-columns:1fr;gap:12px}
.modal-media{background:var(--card);border-radius:12px;padding:8px;display:flex;flex-direction:column;gap:8px}
#modal-gallery{min-height:260px;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center}
#modal-gallery img{max-width:100%;max-height:320px;object-fit:contain}
#modal-thumbs{display:flex;gap:8px;overflow:auto;padding:6px}
#modal-thumbs .thumb{height:64px;border-radius:8px;object-fit:cover;cursor:pointer;box-shadow:0 10px 30px rgba(16,24,40,0.06)}
.modal-info{padding:6px 6px 12px}
.modal-title{font-size:1.15rem;margin:0 0 6px 0}
.modal-price{font-weight:900;font-size:1.15rem;color:var(--brand-1);margin-bottom:8px}
.price-row{display:flex;gap:12px;align-items:center;margin-bottom:8px}
.availability{color:var(--success);font-weight:700;font-size:0.95rem}
.modal-desc{color:var(--muted);margin-bottom:12px}
.modal-controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.modal-controls label{font-weight:700;font-size:0.9rem}
.modal-controls select, .modal-controls input[type="number"]{padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);min-width:120px}
.modal-cta{display:flex;gap:8px;margin-left:auto}

/* modal meta */
.modal-meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);margin-top:12px}

/* -------------------------
   CART PANEL (slide out)
   -------------------------*/
.cart-panel{
  position:fixed;
  right:0;
  top:0;
  height:100%;
  width:100%;
  max-width:420px;
  background:linear-gradient(180deg,#fff,#fffefc);
  box-shadow:-20px 0 60px rgba(10,20,30,0.16);
  transform:translateX(110%);
  transition:transform 260ms cubic-bezier(.2,.9,.2,1);
  z-index:110;
  display:flex;
  flex-direction:column;
}
.cart-panel.open{transform:translateX(0)}
.cart-header{display:flex;align-items:center;justify-content:space-between;padding:14px;border-bottom:1px solid rgba(15,23,42,0.03)}
.cart-contents{padding:14px;flex:1;overflow:auto}
.cart-footer{padding:14px;border-top:1px solid rgba(15,23,42,0.03)}
.cart-item{display:flex;gap:12px;align-items:center;padding:8px;border-radius:10px;margin-bottom:10px;background:linear-gradient(180deg,rgba(255,255,255,0.9),rgba(255,255,255,0.95));box-shadow:var(--shadow)}
.cart-item-thumb{width:68px;height:68px;border-radius:10px;object-fit:cover}
.cart-item-info{flex:1}
.cart-item-title{display:block;font-weight:800}
.cart-item-meta{display:block;color:var(--muted);font-size:13px}
.cart-item-actions{display:flex;gap:6px;align-items:center}
.cart-item-qty{width:68px;padding:6px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)}
.cart-item-remove{background:transparent;border:0;color:var(--muted);cursor:pointer}

/* -------------------------
   CONTACT / FORMS
   -------------------------*/
.contact{margin:28px auto 60px}
.contact-grid{display:grid;gap:16px}
.contact-card{padding:16px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow)}
.contact-list{list-style:none;padding:0;margin:8px 0 0 0;color:var(--muted)}
.contact-list li{display:flex;gap:8px;align-items:center;padding:6px 0}
.contact-form{background:linear-gradient(180deg,#fff,#fffefc);padding:14px;border-radius:12px;box-shadow:var(--shadow)}
.contact-form .form-row{margin-bottom:10px}
.contact-form label{display:block;margin-bottom:6px;font-weight:700}
.contact-form input, .contact-form textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)}
.form-actions{display:flex;gap:8px;justify-content:flex-end}

/* -------------------------
   ABOUT / FEATURES
   -------------------------*/
.features-grid{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
.features-grid li{list-style:none;background:linear-gradient(180deg,#fff,#fffefc);padding:12px;border-radius:12px;box-shadow:var(--shadow);display:flex;gap:8px;align-items:center;font-weight:700;color:var(--muted)}

/* -------------------------
   FOOTER
   -------------------------*/
.site-footer{background:linear-gradient(180deg,#fffefc,#fff7f0);padding:24px 0;border-top:1px solid rgba(15,23,42,0.03)}
.footer-top{display:flex;gap:20px;flex-direction:column;padding-bottom:12px}
.footer-col{flex:1}
.footer-logo{display:inline-flex;gap:8px;align-items:center;text-decoration:none;color:var(--text);font-weight:800}
.socials a{display:inline-flex;margin-right:8px}
.newsletter-form{display:flex;gap:8px;margin-top:8px}
.newsletter-form input{padding:8px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);flex:1}
.footer-bottom{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px dashed rgba(15,23,42,0.03);gap:8px}

  /* Checkout modal specifics (stacked, polished) */
.checkout-modal { display:flex; align-items:center; justify-content:center; }
.checkout-modal .modal-inner { border-radius:18px; box-shadow:0 30px 60px rgba(10,20,30,0.22); }
.checkout-modal .checkout-item { display:flex; gap:10px; align-items:center; padding:8px; border-radius:10px; background:linear-gradient(180deg,#fff,#fffefc); box-shadow:var(--shadow); }
.checkout-modal .checkout-item img { width:64px; height:64px; object-fit:cover; border-radius:8px; }
.checkout-modal .checkout-item .meta { display:flex; flex-direction:column; gap:4px; }
.checkout-modal .checkout-item .meta .title { font-weight:800; }
.checkout-modal .checkout-item .meta .sub { color:var(--muted); font-size:13px; }
.checkout-modal .checkout-summary small { color:var(--muted); font-size:12px; }

  /* Ensure buynow modal matches checkout modal style */
#buynow-modal.checkout-modal .checkout-item { align-items:center; }
#buynow-modal .modal-inner { max-width:980px; }

  /* ---------- Compact mobile header: only logo + cart + hamburger ---------- */
@media (max-width: 720px) {

  /* tighten header height and spacing */
  .header-inner {
    height: 60px;
    padding: 6px 0;
    align-items: center;
    gap: 8px;
  }

  /* push logo to the left and icons to the right */
  .header-inner { display:flex; align-items:center; justify-content:space-between; }

  /* hide the desktop nav */
  .main-nav { display: none !important; }

  /* hide all header-actions children by default, show only cart & hamburger */
  .header-actions > * { display: none !important; }
  .header-actions { gap: 4px; }

  /* show cart + mobile toggle */
  .header-actions #cart-toggle,
  .header-actions #mobile-toggle,
  .header-actions .hamburger {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
  }

  /* make logo slightly smaller on phones */
  .site-logo { height:40px; }

  /* make the hamburger compact and visible */
  .hamburger{
    display:inline-flex !important;
    padding:8px;
    border-radius:10px;
  }

  /* ensure the mobile nav container is available but collapsed by max-height
     (we override inline display:none if present) */
  #mobile-nav { display: flex !important; }

  /* keep mobile-nav closed by default (max-height 0). When JS adds "open" it reveals */
  #mobile-nav { max-height: 0; overflow: hidden; transition: max-height 280ms ease; }
  #mobile-nav.open { max-height: 420px; }

  /* visually emphasize the cart icon */
  #cart-toggle { background: rgba(255,255,255,0.95); border-radius:10px; padding:8px; box-shadow: 0 6px 18px rgba(12,18,28,0.06); }
  #cart-toggle .badge { transform: translateY(-2px); }

  /* Reduce hero caption size a little so it doesn't crowd */
  .hero-caption { padding:12px; bottom:10px; left:10px; width:calc(100% - 20px); max-width:400px; }

  /* hide search field & large CTAs on mobile; keep layout neat */
  .search-wrap, .shop-controls .sort-wrap { display: none !important; }

  /* hide secondary header icons (search, etc.) that might remain */
  .icon-btn[aria-label="Search"], .header-actions .icon-btn:not(#cart-toggle) { display: none !important; }

  /* make product grid comfortable on narrow phones */
  .product-grid { gap:10px; grid-template-columns: 1fr; }

  /* reduce hero min-height on very small screens */
  .hero-slider { min-height: 220px; height: 45vh; }
}

/* optional: make the header compact also apply exactly at the breakpoint via a class
   (JS will toggle the 'compact-header' class for better control) */
.compact-header .main-nav { display: none !important; }
.compact-header .header-actions > * { display: none !important; }
.compact-header .header-actions #cart-toggle,
.compact-header .header-actions #mobile-toggle,
.compact-header .header-actions .hamburger { display:inline-flex !important; }
.compact-header .site-logo { height:40px; }

/* -------------------------
   TOAST
   -------------------------*/
.tiny-toast{
  position:fixed;left:50%;transform:translateX(-50%) translateY(6px);
  bottom:26px;
  background:rgba(20,20,20,0.92);
  color:white;padding:10px 16px;border-radius:999px;opacity:0;transition:all 220ms;z-index:999;
  box-shadow:0 8px 30px rgba(8,20,38,0.3);
}
.tiny-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

  /* LOGO specifics */
.logo{display:flex;align-items:center;gap:12px;text-decoration:none}
.site-logo{
  display:block;
  height:46px;           /* desktop size */
  width:auto;
  object-fit:contain;
  filter: drop-shadow(0 6px 18px rgba(0,0,0,0.08));
  transition: transform var(--transition);
}
.logo:hover .site-logo{ transform: translateY(-3px) scale(1.02); }

/* If you want a small text label next to the logo (optional) */
.brand-name{
  font-weight:800;
  font-size:1.05rem;
  color:var(--text);
  letter-spacing:0.2px;
}
/* -------------------------
   SMALLER SIZING / RESPONSIVE
   -------------------------*/
@media (min-width:520px){
  .product-grid{grid-template-columns: repeat(2, 1fr)}
  .hero-caption{left:24px;bottom:24px;width:46%}
  .hero-slider{min-height:360px}
  .hero-media img{transform:scale(1.03)}
  .modal-grid{grid-template-columns: 1fr 1fr}
  .modal-inner{padding:18px}
  .contact-grid{grid-template-columns: 1fr 1fr}
  .footer-top{flex-direction:row}
  .header-inner{height:76px}
  .main-nav .nav-list{gap:18px}
}
.cart-item-title.clickable { cursor: pointer; display:inline-block; }
.cart-item-title.clickable:hover { text-decoration: underline; color: var(--brand-1); }
.cart-item-thumb { cursor: pointer; }
.cart-item[role="group"]:focus { outline: none; box-shadow: var(--focus); border-radius: 10px; }

@media (min-width:880px){
  .product-grid{grid-template-columns: repeat(3, 1fr)}
  .hero-slider{min-height:420px}
  .hero-caption{max-width:620px}
  .header-inner{height:84px}
}

@media (min-width:1100px){
  .product-grid{grid-template-columns: repeat(4, 1fr)}
  .hero-slider{min-height:500px}
  .modal-inner{max-width:1100px}
  .modal-grid{grid-template-columns:1fr 1fr}
}

/* Accessibility focus states */
a:focus, button:focus, input:focus, select:focus, textarea:focus{
  outline:none;box-shadow:var(--focus);
}
/* small header checkout button */
.cart-header .checkout-header-btn {
  padding: 8px 10px;
  border-radius: 10px;
  font-weight: 700;
  display: inline-flex;
  gap: 8px;
  align-items: center;
}
.cart-header .checkout-header-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* -------------------------
   Subtle micro animations
   -------------------------*/
@keyframes floaty {
  0%{ transform:translateY(0) }
  50%{ transform:translateY(-6px) }
  100%{ transform:translateY(0) }
}
.btn.large{animation:floaty 4s ease-in-out infinite}

/* small helpers */
.lead-strong{font-weight:800}
.center{text-align:center}
.kv{display:flex;align-items:center;gap:8px}

/* -------------------------
   END
   -------------------------*/
</style>
<style> /* HERO: force hero slider to occupy half the viewport */
:root {
  --header-space: 84px; /* change if your header-inner height differs */
}

.hero-slider {
  height: 50vh !important;       /* half the viewport */
  min-height: 220px;             /* fallback on very small screens */
  max-height: 60vh;
  border-radius: var(--radius-lg);
  display: block;
  overflow: hidden;
}

/* make slide children fill that height */
.hero-slider .slide,
.hero-slider .slide-inner,
.hero-media,
.hero-media img {
  height: 100% !important;
}

/* adjust caption positioning to fit smaller height */
.hero-caption {
  bottom: 12px;
  left: 12px;
  padding: 14px;
  width: calc(100% - 32px);
  max-width: 520px;
}
/* =========================
   Mobile UX improvements (phones)
   ========================= */

/* Make hamburger easier to tap and above other UI */
.hamburger{
  touch-action: manipulation;
  -webkit-tap-highlight-color: rgba(0,0,0,0.0);
  z-index: 140; /* above modals/nav */
  padding: 10px 12px;   /* larger hit area */
  font-size: 18px;
}

/* ensure the hamburger icon has visible tap target */
.hamburger .fa-bars { font-size: 20px; }

/* ---------- Phone-specific layout tweaks ---------- */
@media (max-width: 720px) {

  /* 2b: Make shop grid 2 columns on phones (2x2 viewport feel) */
  .product-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 10px;
  }

  /* Make product card contents breathe better in 2-column layout */
  .product-card { padding: 10px; border-radius: 12px; }
  .product-media { padding-top: 66%; } /* balance aspect in smaller columns */

  /* 2c: Enlarge modal & cart close buttons on phones */
  .modal .modal-close,
  .cart-close,
  #checkout-modal .modal-close,
  #buynow-modal .modal-close {
    font-size: 20px;
    padding: 10px;
    border-radius: 12px;
    background: rgba(255,255,255,0.98);
    box-shadow: 0 8px 22px rgba(10,20,30,0.06);
    color: var(--muted);
  }
  .modal .modal-close:focus,
  .cart-close:focus { box-shadow: var(--focus); }

  /* Increase the close icon's clickable area */
  .modal .modal-close i,
  .cart-close i { pointer-events: none; }

  /* 2d: Checkout & BuyNow modal — stack vertically on phones */
  #checkout-modal .modal-inner > div,
  #buynow-modal .modal-inner > div {
    display: grid;
    grid-template-columns: 1fr !important;
    gap: 12px;
  }
  #checkout-modal .modal-inner aside,
  #buynow-modal .modal-inner aside {
    width: 100% !important;
    max-width: none !important;
    box-sizing: border-box;
  }

  /* Make checkout summary area full width and pinned below item list */
  #checkout-modal .modal-inner aside,
  #buynow-modal .modal-inner aside {
    order: 2;
  }
  #checkout-modal .modal-inner > div > :first-child,
  #buynow-modal .modal-inner > div > :first-child {
    order: 1;
  }

  /* Ensure checkout modal is full height scrollable and comfortable on phones */
  #checkout-modal .modal-inner,
  #buynow-modal .modal-inner {
    max-height: calc(100vh - var(--header-space, 84px));
    overflow: auto;
    padding: 14px;
    border-radius: 14px;
  }

  /* Increase CTA sizes inside checkout on phones */
  #checkout-pay, #buynow-pay {
    width: 100%;
    padding: 12px;
    font-size: 1rem;
  }

  /* Make 'Continue shopping' button inside empty cart look tappable */
  .cart-empty .btn { padding: 10px 14px; border-radius: 12px; }

  /* Slightly increase cart toggle sizing */
  #cart-toggle { padding: 10px !important; border-radius: 12px; font-size: 18px; }

  /* Reduce hero caption overlay on very small screens if needed */
  .hero-caption { max-width: 95%; padding: 10px; }

}

</style>
  <style>
    :root {
  /* keep your fallback — JS will update this on load */
  --header-space: 84px;
}

/* make header fixed at the top (replaces previous sticky behavior) */
.site-header{
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 120; /* above most UI elements */
  backdrop-filter: blur(6px);
  background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.85));
  border-bottom: 1px solid rgba(15,23,42,0.04);
  box-shadow: 0 6px 18px rgba(18,24,36,0.03);
}

/* push page content below the fixed header */
body {
  /* keep the existing rules, but add this line: */
  padding-top: var(--header-space);
}

/* cart panel should start below the header and span the rest of the viewport */
.cart-panel{
  position: fixed;
  right: 0;
  top: var(--header-space);                  /* start below header */
  height: calc(100% - var(--header-space));  /* full height minus header */
  width: 100%;
  max-width: 420px;
  background: linear-gradient(180deg,#fff,#fffefc);
  box-shadow: -20px 0 60px rgba(10,20,30,0.16);
  transform: translateX(110%);
  transition: transform 260ms cubic-bezier(.2,.9,.2,1);
  z-index: 110;
  display: flex;
  flex-direction: column;
}
.cart-panel.open{ transform: translateX(0); }

  </style>
  <style>
/* ============ Mobile improvements (phones ≤ 720px) ============ */
@media (max-width:720px) {
  /* 2.a — make hamburger reliably tappable + visible */
  #mobile-toggle, .hamburger {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
    padding: 12px !important;
    border-radius: 12px !important;
    min-width: 44px;
    min-height: 44px;
    touch-action: manipulation;
    z-index: 140; /* above header content so taps register */
    -webkit-tap-highlight-color: rgba(0,0,0,0.06);
  }
  #mobile-toggle .fa-bars, .hamburger .fa-bars { font-size: 20px !important; }

  /* 2.b — shop dresses: show 2 columns on phones (2x2 visible when scrolling) */
  .product-grid {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 10px !important;
  }

  /* make product cards breathe on tiny screens */
  .product-card { border-radius: 12px; }

  /* 2.c — bigger close buttons so they're easier to tap on phones */
  .modal-close, .cart-close, #checkout-modal .modal-close, #buynow-modal .modal-close {
    padding: 10px 12px !important;
    font-size: 18px !important;
    border-radius: 12px !important;
    min-width: 44px;
    min-height: 44px;
    box-shadow: 0 8px 20px rgba(8,20,38,0.08);
  }

  /* make icon-only close buttons have higher hit area */
  .modal .modal-close i, .cart-close i { pointer-events: none; }

  /* 2.d — stack checkout modal vertically on phones */
  /* override inline grid from HTML using !important */
  #checkout-modal .modal-inner > div,
  #buynow-modal .modal-inner > div {
    grid-template-columns: 1fr !important;
    align-items: stretch;
  }
  /* make sidebar area full-width and appear below items */
  #checkout-modal .modal-inner aside,
  #buynow-modal .modal-inner aside {
    width: 100% !important;
    max-width: none !important;
    margin-top: 12px;
  }
  /* ensure modal inner is scrollable vertically and not horizontally */
  #checkout-modal .modal-inner, #buynow-modal .modal-inner {
    max-width: 92vw !important;
    padding: 12px !important;
    overflow: auto !important;
  }

  /* tighten hero caption so it doesn't overlap */
  .hero-caption { max-width: 60%; }

  /* ensure mobile nav is visible and animation is smooth */
  #mobile-nav { display: flex !important; transition: max-height 260ms ease; }
  #mobile-nav.open { max-height: 520px !important; }

  /* enlarge cart button target as well */
  #cart-toggle { padding: 10px !important; min-width: 44px; min-height: 44px; border-radius: 10px; }
  #cart-toggle .fa-shopping-cart { font-size: 18px !important; }

  /* spacing fixes for product-body elements */
  .product-body { padding: 10px !important; }
}
</style>
<style>
/* === Task 3: Bigger header cart icon & badge === */

/* make the cart button larger and more tappable (desktop + mobile) */
.header-actions #cart-toggle {
  padding: 10px 14px !important;    /* larger hit area */
  min-width: 52px !important;
  min-height: 52px !important;
  border-radius: 12px !important;
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
  box-shadow: 0 8px 24px rgba(12,18,28,0.06);
  transition: transform 160ms ease, box-shadow 160ms ease;
}

/* slightly grow on hover/focus for visual affordance */
.header-actions #cart-toggle:hover,
.header-actions #cart-toggle:focus {
  transform: translateY(-3px) scale(1.03);
  box-shadow: 0 12px 30px rgba(12,18,28,0.10);
  outline: none;
}

/* bigger cart glyph */
.header-actions #cart-toggle .fa-shopping-cart {
  font-size: 20px !important; /* desktop */
  line-height: 1;
}

/* badge: larger, more legible */
#cart-badge {
  min-width: 22px !important;
  height: 22px !important;
  padding: 2px 7px !important;
  font-size: 12px !important;
  border-radius: 999px !important;
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(12,18,28,0.08);
}

/* slightly larger for small screens too */
@media (max-width:720px) {
  .header-actions #cart-toggle { padding: 10px !important; min-width:48px !important; min-height:48px !important; }
  .header-actions #cart-toggle .fa-shopping-cart { font-size: 18px !important; }
  #cart-badge { min-width:20px; height:20px; font-size:11px; padding:2px 6px; }
}
</style>
<style>
/* Header search toggle: reveal the shop search on mobile and provide a neat overlay */
body.search-open {
  /* nothing visual by itself; we target the search wrap */
}

/* when search-open is active, show the hidden .search-wrap (mobile override) */
body.search-open .search-wrap {
  display: flex !important;
  position: fixed !important;
  left: 8px !important;
  right: 8px !important;
  top: calc(var(--header-space) + 8px) !important;
  z-index: 220 !important;
  padding: 8px !important;
  border-radius: 12px !important;
  box-shadow: 0 14px 40px rgba(8,20,38,0.12) !important;
  background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.92)) !important;
  align-items: center;
}

/* make the search input wider when overlay active */
body.search-open .search-wrap input[type="search"] {
  width: 100% !important;
  min-width: 140px !important;
  padding: 12px 10px !important;
  font-size: 1rem !important;
}

/* subtle dim behind the header when search is open on mobile (non-invasive) */
body.search-open::before{
  content: "";
  position: fixed;
  inset: 0;
  top: calc(var(--header-space) + 8px);
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(8,15,24,0.18);
  z-index: 210;
  pointer-events: none;
}

/* ensure clear button sits nicely in overlay */
body.search-open #search-clear {
  z-index: 230;
}

/* keep layout consistent on desktop (no visual change) */
@media (min-width:721px) {
  body.search-open .search-wrap { position: static; box-shadow: none; top: auto; left: auto; right: auto; }
  body.search-open::before { display:none; }
}
</style>
<style>
/* ====== Checkout modal: new beautiful style & responsive behavior ====== */
.checkout-modal { z-index:140; display:none; }
.checkout-modal.open { display:flex; }

.checkout-modal .modal-inner {
  width:100%;
  max-width:980px;
  margin:24px auto;
  background: linear-gradient(180deg,#fffefc,#ffffff);
  border-radius:20px;
  padding:18px;
  position:relative;
  box-shadow: 0 30px 80px rgba(16,24,40,0.18);
  overflow: hidden;
  transform-origin: center;
  animation: modalPop 360ms cubic-bezier(.2,.9,.3,1);
  border: 1px solid rgba(15,23,42,0.04);
}

/* entrance */
@keyframes modalPop {
  from { opacity:0; transform: translateY(8px) scale(0.985); }
  to { opacity:1; transform: translateY(0) scale(1); }
}

/* sticker decorations */
.checkout-modal .sticker {
  position:absolute;
  width:72px;height:72px;border-radius:14px;
  display:flex;align-items:center;justify-content:center;
  box-shadow: 0 10px 30px rgba(16,24,40,0.08);
  pointer-events:none; transform: translateZ(0);
}
.checkout-modal .sticker--left {
  left: -18px; top: -18px;
  background: linear-gradient(135deg,var(--brand-1),var(--brand-2));
  color:white; transform: rotate(-8deg);
  animation: floatySt 4200ms ease-in-out infinite;
}
.checkout-modal .sticker--right {
  right: -18px; bottom: -18px;
  background: linear-gradient(135deg,var(--accent),#34d399);
  color:white; transform: rotate(6deg);
  animation: floatySt 5600ms ease-in-out infinite;
}
@keyframes floatySt {
  0% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-8px) rotate(3deg); }
  100% { transform: translateY(0) rotate(0deg); }
}

/* content layout: details first, items below */
.checkout-inner {
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* details card */
.checkout-details {
  background: linear-gradient(180deg,#ffffff,#fffaf8);
  border-radius:12px;
  padding:14px;
  box-shadow: var(--shadow);
  display:grid;
  grid-template-columns: 1fr 220px;
  gap:12px;
  align-items:start;
}

/* left: form fields; right: mini summary */
.checkout-form { display:flex; flex-direction:column; gap:10px; }
.checkout-form .row { display:flex; gap:8px; }
.checkout-form input[type="text"], .checkout-form input[type="email"], .checkout-form input[type="tel"], .checkout-form input[type="number"], .checkout-form select, .checkout-form textarea {
  width:100%; padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06); font-size:0.95rem;
}
.checkout-form textarea { min-height:80px; resize:vertical; }

.checkout-summary-card {
  background: linear-gradient(180deg,#fff,#fffefc);
  padding:12px;border-radius:10px; box-shadow:var(--shadow);
  position:sticky; top:16px; align-self:start;
  min-width:200px;
}

/* items area below */
.checkout-items-wrap {
  display:flex;
  gap:16px;
  align-items:flex-start;
  flex-direction:column;
}
.checkout-items-list {
  display:flex;
  flex-direction:column;
  gap:10px;
  max-height:38vh;
  overflow:auto;
  padding-right:6px;
}
.checkout-item {
  display:flex; gap:12px; align-items:center;
  padding:8px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffefc);border:1px solid rgba(15,23,42,0.03);
}
.checkout-item img { width:64px;height:64px;border-radius:8px; object-fit:cover; }
.checkout-item .meta { font-weight:700; color:var(--text) }
.checkout-item .meta small { display:block;color:var(--muted); font-weight:600; font-size:12px }

/* totals block (keeps visible on right or below on mobile) */
.checkout-totals {
  display:flex; flex-direction:column; gap:8px; margin-top:6px;
}
.checkout-totals .row { display:flex; justify-content:space-between; align-items:center; }
.checkout-totals .total { font-size:1.15rem; font-weight:900; color:var(--brand-1) }

/* action area */
.checkout-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:6px; }
.checkout-actions .btn { min-width:120px; }

/* mobile responsiveness */
@media (max-width: 880px) {
  .checkout-details { grid-template-columns: 1fr; }
  .checkout-summary-card { position:relative; top:auto; min-width:unset; }
  .checkout-item img { width:56px;height:56px; }
  .checkout-inner { gap:12px; }
}

/* ensure modal fits inside viewport and doesn't get covered by header/footer */
.checkout-modal .modal-inner {
  max-height: calc(100vh - var(--header-space,84px) - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 32px);
  overflow:auto;
  margin: 12px;
}

/* make pay button full-width on small screens */
@media (max-width:720px) {
  .checkout-actions { flex-direction:column; align-items:stretch; }
  .checkout-actions .btn { width:100%; }
  .checkout-summary-card { order: 2; }
  .checkout-items-list { max-height: 36vh; }
}

/* small accessibility + focus */
.checkout-form input:focus, .checkout-form select:focus, .checkout-form textarea:focus { outline:none; box-shadow: var(--focus); }

/* hide the legacy small processing text if present */
.checkout-hide-processing-note small { display:none !important; }
</style>
<style>
/* ===== Receipt modal: beautiful, responsive & scrollable ===== */
.receipt-modal { z-index:1500; display:none; }
.receipt-modal.open { display:flex; }

.receipt-modal .modal-inner {
  width:100%;
  max-width:920px;
  margin:16px auto;
  border-radius:16px;
  padding:14px;
  position:relative;
  background: linear-gradient(180deg,#fffefc,#ffffff);
  box-shadow: 0 30px 70px rgba(12,18,28,0.12);
  border: 1px solid rgba(15,23,42,0.04);
  animation: receiptPop 360ms cubic-bezier(.2,.9,.3,1);
  overflow: hidden;
}

/* entrance */
@keyframes receiptPop {
  from { opacity:0; transform: translateY(8px) scale(0.995); }
  to { opacity:1; transform: translateY(0) scale(1); }
}

/* stickers & badges */
.receipt-modal .sticker {
  position:absolute; width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center; color:#fff;
  box-shadow: 0 10px 30px rgba(12,18,28,0.08); pointer-events:none;
}
.receipt-modal .sticker.left { left:-14px; top:-14px; background: linear-gradient(135deg,var(--brand-1),var(--brand-2)); transform: rotate(-8deg); }
.receipt-modal .sticker.right { right:-14px; bottom:-14px; background: linear-gradient(135deg,var(--accent),#34d399); transform: rotate(6deg); }

/* layout */
.receipt-grid { display:grid; grid-template-columns: 1fr 320px; gap:14px; align-items:start; }
.receipt-left { display:flex; flex-direction:column; gap:12px; }
.receipt-right { position:relative; }

/* summary & items */
.receipt-summary { background:linear-gradient(180deg,#fff,#fffefc); padding:12px; border-radius:10px; box-shadow:var(--shadow); }
.receipt-meta { display:flex; gap:12px; align-items:center; justify-content:space-between; }
.receipt-badge { background: linear-gradient(90deg,var(--brand-1),var(--brand-2)); color:#fff; padding:6px 10px; border-radius:999px; font-weight:800; box-shadow:0 8px 28px rgba(255,107,138,0.08); }

/* items list */
.receipt-items { display:flex; flex-direction:column; gap:10px; max-height:44vh; overflow:auto; padding-right:6px; }
.receipt-item { display:flex; gap:10px; align-items:center; padding:10px; border-radius:10px; border:1px solid rgba(15,23,42,0.03); background:linear-gradient(180deg,#fff,#fffefc); }
.receipt-item img { width:64px; height:64px; border-radius:8px; object-fit:cover; }
.receipt-item .it-meta { flex:1; }
.receipt-item .it-price { text-align:right; min-width:96px; font-weight:800; }

/* preview area */
.receipt-preview-wrap { margin-top:10px; border-radius:10px; overflow:hidden; border:1px solid rgba(15,23,42,0.06); background:#fff; }
.receipt-iframe {
  width:100%;
  height:56vh;
  min-height:280px;
  border:0;
  display:block;
}

/* loader overlay inside preview */
.preview-loader {
  position:absolute; left:0; right:0; top:0; bottom:0; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.6);
}

/* actions */
.receipt-actions { display:flex; gap:8px; flex-direction:column; }
.receipt-actions .btn { width:100%; }

/* responsive */
@media (max-width:880px) {
  .receipt-grid { grid-template-columns: 1fr; }
  .receipt-right { order:2; }
  .receipt-preview-wrap .receipt-iframe { height:48vh; min-height:220px; }
  .receipt-items { max-height:32vh; }
  .receipt-actions { flex-direction:row; gap:8px; }
  .receipt-actions .btn { flex:1; }
}

/* ensure modal fits view and respects header/footer */
.receipt-modal .modal-inner {
  max-height: calc(100vh - var(--header-space,84px) - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 24px);
  overflow:auto;
}

/* accessibility focus */
.receipt-modal .modal-inner a:focus, .receipt-modal .modal-inner button:focus, .receipt-modal .modal-inner input:focus { outline:none; box-shadow:var(--focus); }
</style>
<style>
/* History button & modal */
#history-toggle { padding: 10px 12px !important; border-radius: 12px !important; min-width:48px; min-height:48px; display:inline-flex; align-items:center; justify-content:center; }
#history-toggle .fa-history { font-size:18px; }
#history-badge { min-width:18px; height:18px; padding:2px 6px; font-size:11px; margin-left:6px; }

/* History Modal */
#history-modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(8,15,24,0.5); z-index: 1400; padding: 16px; }
#history-modal.open { display: flex; }
#history-modal .modal-inner {
  width: 100%; max-width: 920px; border-radius: 14px; background: linear-gradient(180deg,#fffefc,#ffffff);
  box-shadow: 0 30px 80px rgba(12,18,28,0.12); padding: 14px; max-height: calc(100vh - var(--header-space,84px) - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  overflow:auto;
}

/* history list */
.history-list { display:flex; flex-direction:column; gap:12px; margin-top:10px; }
.history-item { display:flex; gap:12px; align-items:center; justify-content:space-between; padding:10px; border-radius:12px; background:linear-gradient(180deg,#fff,#fffefc); border:1px solid rgba(15,23,42,0.04); box-shadow: var(--shadow); }
.history-left { display:flex; gap:10px; align-items:center; min-width:0; }
.history-thumb { width:64px; height:64px; border-radius:8px; object-fit:cover; background:linear-gradient(90deg,var(--brand-2),var(--brand-1)); display:flex; align-items:center; justify-content:center; color:#fff; font-weight:800; }
.history-meta { min-width:0; overflow:hidden; }
.history-meta .title { font-weight:800; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }
.history-meta .sm { color:var(--muted); font-size:13px; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }

.history-actions { display:flex; gap:8px; align-items:center; }
.history-actions .btn { white-space:nowrap; }

/* responsive */
@media (max-width:720px) {
  #history-modal .modal-inner { width: 96vw; padding:12px; border-radius:12px; }
  .history-item { flex-direction:column; align-items:flex-start; gap:8px; }
  .history-actions { width:100%; display:flex; gap:8px; }
  .history-actions .btn { flex:1; }
}
</style>
<style>
/* Contact section: professional, compact and responsive */
.contact-card { padding:16px; border-radius:12px; background:linear-gradient(180deg,#fff,#fffefc); box-shadow:var(--shadow); border:1px solid rgba(15,23,42,0.04); }
.contact-card--info { transition: transform var(--transition); }
.contact-card--info:hover { transform: translateY(-4px); }

.contact-list.styled { list-style:none;padding:0;margin:6px 0 0 0; display:flex;flex-direction:column; gap:8px; }
.contact-list.styled li { margin:0; }

/* contact action buttons (phone/whatsapp/email) */
.contact-action {
  display:flex;align-items:center;gap:12px;width:100%;border:0;padding:10px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);cursor:pointer;
  box-shadow:0 8px 20px rgba(12,18,28,0.04); transition:all var(--transition); text-align:left;
}
.contact-action:hover, .contact-action:focus { transform: translateY(-3px); box-shadow: 0 14px 40px rgba(12,18,28,0.06); outline:none; }
.contact-action .ci { width:42px;height:42px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));color:white; font-size:16px; flex-shrink:0; }
.contact-action .ct { flex:1; min-width:0; }
.contact-action .ct-title { font-weight:800; font-size:0.98rem; color:var(--text); }
.contact-action .ct-sub { color:var(--muted); font-size:0.9rem; }
.contact-action .cta { font-weight:700; color:var(--brand-1); font-size:0.9rem; }

/* social icons (compact) */
.contact-socials a { display:inline-flex; align-items:center; justify-content:center; width:40px;height:40px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc); border:1px solid rgba(15,23,42,0.03); margin-right:8px; color:var(--muted); transition:all var(--transition); }
.contact-socials a:hover { transform:translateY(-4px); color:var(--brand-1); box-shadow: 0 10px 30px rgba(16,24,40,0.06); }

/* form styling */
.contact-form .form-row { margin-bottom:10px; }
.form-label { display:block; margin-bottom:6px; font-weight:700; font-size:0.92rem; }
.contact-form input, .contact-form textarea, .contact-form select {
  width:100%; padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06); font-size:0.95rem; outline:none; transition:box-shadow var(--transition);
}
.contact-form input:focus, .contact-form textarea:focus, .contact-form select:focus { box-shadow:var(--focus); }

.row-2 { display:flex; gap:10px; }
@media (max-width:720px) {
  .row-2 { flex-direction:column; }
}

/* small responsive tweaks */
#contact { margin:28px auto 60px; }
@media (max-width:880px) {
  #contact .contact-card, #contact .contact-form { width:100%; }
  #contact > div { flex-direction:column; gap:12px; }
}
</style>
<style>
/* ===== Task 6: Professional footer styles ===== */
.site-footer {
  background: linear-gradient(180deg,#fffefc,#fff7f0);
  border-top: 1px solid rgba(15,23,42,0.03);
  padding: 28px 0 36px;
  color: var(--text);
  font-size: 14px;
  position: relative;
  z-index: 20;
}

/* container inside footer */
.footer-grid {
  display: grid;
  grid-template-columns: 1.6fr 1fr 1fr 1.2fr;
  gap: 18px;
  width:90%; max-width: var(--max-width);
  margin: 0 auto;
  align-items:start;
}

/* brand area */
.footer-brand {
  display:flex; gap:12px; align-items:flex-start;
}
.footer-brand .logo-badge {
  width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center;
  background: linear-gradient(90deg,var(--brand-1),var(--brand-2)); color:white; font-weight:800;
  box-shadow: 0 10px 30px rgba(255,107,138,0.08);
}
.footer-brand .brand-copy { color:var(--muted); margin-top:6px; font-size:0.95rem; }

/* link columns */
.footer-col h4 { margin:0 0 8px 0; font-size:1rem; color:var(--text); }
.footer-links { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px; }
.footer-links a { color:var(--muted); text-decoration:none; display:inline-flex; gap:8px; align-items:center; padding:6px; border-radius:8px; transition:all 180ms; }
.footer-links a:hover { color:var(--text); transform:translateY(-3px); background: linear-gradient(90deg, rgba(255,107,138,0.03), rgba(255,209,102,0.03)); }

/* contact & newsletter */
.footer-newsletter { display:flex; flex-direction:column; gap:8px; }
.footer-newsletter form { display:flex; gap:8px; align-items:center; }
.footer-newsletter input[type="email"] {
  padding:10px 12px; border-radius:10px; border:1px solid rgba(15,23,42,0.06); flex:1; font-size:0.95rem;
}
.footer-newsletter .btn { padding:10px 12px; border-radius:10px; }

/* social icons row */
.footer-socials { display:flex; gap:8px; margin-top:6px; }
.footer-socials a { display:inline-flex; align-items:center; justify-content:center; width:44px;height:44px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);border:1px solid rgba(15,23,42,0.04); color:var(--muted); transition:all 160ms; }
.footer-socials a:hover { color:var(--brand-1); transform:translateY(-4px); box-shadow:0 10px 30px rgba(16,24,40,0.06); }

/* payment badges (placeholders) */
.footer-payments { display:flex; gap:8px; align-items:center; margin-top:10px; }
.payment-badge { display:inline-flex; align-items:center; justify-content:center; min-width:48px; height:32px; border-radius:8px; background:linear-gradient(180deg,#fff,#fffefc); border:1px solid rgba(15,23,42,0.04); padding:6px 8px; color:var(--muted); font-weight:700; font-size:12px; }

/* bottom legal row */
.footer-bottom {
  width:90%; max-width:var(--max-width); margin:12px auto 0; display:flex; justify-content:space-between; align-items:center; gap:12px;
  padding-top:12px; border-top:1px dashed rgba(15,23,42,0.03);
}
.legal { display:flex; gap:12px; list-style:none; margin:0; padding:0; color:var(--muted); }
.legal a { color:var(--muted); text-decoration:none; }
.legal a:hover { color:var(--text); text-decoration:underline; }

/* small attribution */
.footer-copyright { color:var(--muted); font-size:13px; }

/* back-to-top button */
#back-to-top {
  position: fixed;
  right: 18px;
  bottom: 18px;
  z-index: 220;
  width:48px; height:48px; border-radius:12px;
  display:flex; align-items:center; justify-content:center; background:linear-gradient(90deg,var(--brand-1),var(--brand-2));
  color:white; box-shadow: 0 10px 30px rgba(255,107,138,0.12); border:0; cursor:pointer;
  transition: transform 180ms ease, opacity 160ms;
  opacity: 0; pointer-events: none;
}
#back-to-top.show { opacity:1; pointer-events:auto; transform: translateY(0); }
#back-to-top:focus { outline:none; box-shadow:var(--focus); }

/* responsive */
@media (max-width:1100px) {
  .footer-grid { grid-template-columns: 1fr 1fr; gap:14px; }
}
@media (max-width:720px) {
  .footer-grid { grid-template-columns: 1fr; gap:12px; }
  .footer-brand .brand-copy { font-size:0.92rem; }
  .footer-newsletter form { flex-direction:column; align-items:stretch; }
  .footer-newsletter .btn { width:100%; }
}

/* subtle micro animation */
.footer-links a i { width:18px; display:inline-block; text-align:center; }
</style>
<style>
/* ----------------------------
   GLOBAL RESPONSIVE HELPERS
   ----------------------------*/

/* ensure header-space available; JS also sets it dynamically but keep a safe fallback */
:root {
  --header-space: 84px;
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

/* make images & media fluid by default */
img, picture, video, iframe { max-width:100%; height:auto; display:block; }

/* default responsive typography (use clamp to scale a little) */
h1 { font-size: clamp(1.25rem, 2.2vw, 1.8rem); }
h2 { font-size: clamp(1.05rem, 1.8vw, 1.5rem); }
p, li, small, button { font-size: clamp(0.95rem, 1.2vw, 1rem); }

/* touch-friendly: ensure interactive elements large enough on mobile */
button, .icon-btn, .hamburger, .cart-close, .modal-close {
  min-height:44px;
  min-width:44px;
  padding: 10px;
}

/* reduce layout thrash on small screens */
.container, .footer-grid { width: min(92%, var(--max-width)); margin-inline:auto; }

/* modal inner: never exceed viewport and respect header safe areas */
.modal .modal-inner,
.checkout-modal .modal-inner,
.receipt-modal .modal-inner,
#history-modal .modal-inner {
  max-height: calc(100vh - var(--header-space) - var(--safe-top) - var(--safe-bottom) - 24px);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* ensure any iframe preview is comfortably tall on phones */
.receipt-iframe {
  min-height: 40vh;
  height: clamp(260px, 48vh, 640px);
}

/* ----------------------------
   GRID / PRODUCT LAYOUT
   ----------------------------*/

/* mobile-first: base defined already (1 column). Now breakpoints expand columns */
@media (min-width:520px) {
  .product-grid { grid-template-columns: repeat(2, 1fr); gap:12px; }
  .contact-grid{ grid-template-columns: repeat(2, 1fr); gap:16px; }
}

@media (min-width:880px) {
  .product-grid { grid-template-columns: repeat(3, 1fr); gap:14px; }
  .hero-caption { left: 28px; bottom:28px; max-width:46%; }
  .modal-grid { grid-template-columns: 1fr 420px; gap:18px; }
}

/* large screens: 4 columns */
@media (min-width:1100px) {
  .product-grid { grid-template-columns: repeat(4, 1fr); gap:16px; }
  .modal-inner { max-width: 1100px; }
}

/* very large wide screens: add spacing */
@media (min-width:1400px) {
  .container { max-width: 1300px; }
  .product-grid { gap:18px; }
}

/* ensure product cards retain comfortable padding on tiny screens */
@media (max-width:420px) {
  .product-card { padding:8px; border-radius:10px; }
  .product-media { padding-top:72%; }
}

/* ----------------------------
   HEADER / NAV RESPONSIVENESS
   ----------------------------*/

/* when compact header toggled (JS toggles .compact-header) */
.compact-header .main-nav { display:none !important; }
.compact-header .header-actions > * { display:none !important; }
.compact-header .header-actions #cart-toggle,
.compact-header .header-actions #mobile-toggle,
.compact-header .header-actions .hamburger { display:inline-flex !important; }

/* mobile nav & search overlay fixes */
@media (max-width:720px) {
  .site-header { height: auto; padding: 8px 0; }
  body { padding-top: calc(var(--header-space)); } /* keep content below header (JS adjusts var) */
  .main-nav, .hero-controls { display:none; }
  #mobile-nav { display:flex !important; transition: max-height 240ms ease; overflow:hidden; }
  #mobile-nav.open { max-height:520px; }

  /* ensure header buttons are visible */
  .header-actions #history-toggle, .header-actions #cart-toggle { display:inline-flex !important; }
}

/* prevent header overlap on landscape phones: increase modal top gap */
@media (orientation: landscape) and (max-height:420px) {
  .modal .modal-inner, .checkout-modal .modal-inner { max-height: calc(100vh - var(--header-space) - 12px); padding:12px; }
}

/* ----------------------------
   CART PANEL & SLIDE-OUTS
   ----------------------------*/
@media (max-width:920px) {
  .cart-panel { max-width: 100%; width:100%; right:0; top:var(--header-space); height: calc(100% - var(--header-space)); }
  .cart-panel .cart-header { padding:12px; }
  .cart-contents { padding:12px; }
}
@media (min-width:921px) {
  .cart-panel { width:100%; max-width:420px; }
}

/* ----------------------------
   MODALS: stacking & scroll behavior
   ----------------------------*/
/* ensure stacked modals on narrow screens are full-width and scrollable */
@media (max-width:720px) {
  .modal { align-items:flex-start; padding:12px; }
  .modal .modal-inner { width:92vw; margin:8px auto; border-radius:12px; padding:14px; }
  .modal .modal-inner:focus { outline:none; }
  .checkout-details, .receipt-grid { grid-template-columns: 1fr !important; }
}

/* keep focus trap & keyboard accessibility: highlight focused modal close */
.modal .modal-close:focus { box-shadow: var(--focus); }

/* prevent body from scrolling when modal open - add class via JS if needed */
body.modal-open { overflow: hidden; touch-action: none; }

/* ----------------------------
   FORMS & TAP TARGETS
   ----------------------------*/
input, select, textarea, .btn { min-height:44px; }
.form-actions { gap:10px; display:flex; flex-wrap:wrap; justify-content:flex-end; }
@media (max-width:720px) {
  .form-actions { flex-direction:column; align-items:stretch; }
  .form-actions .btn { width:100%; }
}

/* ----------------------------
   HERO / SLIDER RESPONSIVENESS
   ----------------------------*/
.hero-slider {
  height: clamp(200px, 48vh, 600px);
  min-height:220px;
  max-height: 75vh;
}
.hero-caption { padding: clamp(10px, 1.5vw, 18px); }

/* ----------------------------
   RECEIPT / PDF PRINT RULES
   ----------------------------*/
@media print {
  /* minimize UI clutter */
  body * { visibility: hidden; }
  .receipt-iframe, #receipt-preview, #receipt-preview * { visibility: visible; }
  #receipt-preview { position: absolute; top:0; left:0; width:100%; height:100%; }
  /* ensure invoices print in portrait A4 */
  @page { size: A4 portrait; margin: 12mm; }
}

/* ----------------------------
   FOOTER / CONTACT / GET IN TOUCH
   ----------------------------*/
@media (max-width:880px) {
  .footer-grid { grid-template-columns: 1fr 1fr; gap:12px; }
}
@media (max-width:720px) {
  .footer-grid { grid-template-columns: 1fr; gap:12px; }
  .footer-socials a { width:40px; height:40px; }
}

/* ----------------------------
   ACCESSIBILITY / FOCUS
   ----------------------------*/
a:focus, button:focus, input:focus, select:focus, textarea:focus {
  outline-offset: 3px;
  box-shadow: var(--focus);
}

/* ----------------------------
   MINOR FIXES: keep modal content from being hidden by mobile "notch" UI
   ----------------------------*/
.modal .modal-inner { padding-bottom: calc(16px + var(--safe-bottom)); }
.checkout-modal .modal-inner, .receipt-modal .modal-inner { padding-bottom: calc(18px + var(--safe-bottom)); }

/* ----------------------------
   END
   ----------------------------*/
</style>

</head>
<body>
  <!-- SITE HEADER -->
  <header class="site-header" role="banner">
    <div class="container header-inner">
      <!-- Replace the old logo <a> in your header with this -->
<a href="#" class="logo" aria-label="April Blossoms">
  <img src="logo.jpg" alt="April Blossoms logo" class="site-logo" />
  <span class="brand-name sr-only">April Blossoms</span>
</a>


  <nav class="main-nav" role="navigation" aria-label="Primary">
    <ul class="nav-list">
      <li><a href="#hero"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="#shop"><i class="fa fa-shopping-bag"></i> Shop</a></li>
      <li><a href="#contact"><i class="fa fa-envelope"></i> Contact</a></li>
      <li><a href="#about"><i class="fa fa-info-circle"></i> About</a></li>
    </ul>
  </nav>

<div class="header-actions">
  <button id="search-toggle" class="icon-btn" aria-label="Search">
    <i class="fa fa-search"></i>
  </button>

  <!-- History (recent purchases) -->
  <button id="history-toggle" class="icon-btn" aria-label="Purchase history" title="Purchase history" aria-haspopup="true" aria-controls="history-modal">
    <i class="fa fa-history"></i>
    <span id="history-badge" class="badge" aria-live="polite">0</span>
  </button>

  <button id="cart-toggle" class="icon-btn" aria-label="Open cart" aria-haspopup="true" aria-controls="cart-panel">
    <i class="fa fa-shopping-cart"></i>
    <span id="cart-badge" class="badge" aria-live="polite">0</span>
  </button>

  <!-- HAMBURGER / MOBILE TOGGLE -->
  <button id="mobile-toggle" class="hamburger" aria-label="Open menu" aria-expanded="false">
    <span class="hamburger-lines" aria-hidden="true"></span>
    <i class="fa fa-bars" aria-hidden="true"></i>
  </button>
</div>

</div>

<!-- MOBILE NAV (will be toggled by JS) -->
<nav id="mobile-nav" class="mobile-nav" aria-hidden="true" aria-label="Mobile navigation" style="display: none">
  <ul>
    <li><a href="#hero"><i class="fa fa-home"></i> Home</a></li>
    <li><a href="#shop"><i class="fa fa-shopping-bag"></i> Shop</a></li>
    <li><a href="#contact"><i class="fa fa-envelope"></i> Contact</a></li>
    <li><a href="#about"><i class="fa fa-info-circle"></i> About</a></li>
  </ul>
  <div class="mobile-nav-footer">
    <a class="btn tiny" href="#"><i class="fa fa-user"></i> Admin</a>
  </div>
</nav>

  </header>

  <main id="main" role="main">

<!-- HERO / SLIDESHOW -->
<section id="hero" class="hero">
  <div class="hero-slider" data-slides="3" aria-roledescription="carousel">
    <div class="slide" data-slide="1" role="group" aria-roledescription="slide" aria-label="Slide 1 of 3">
      <div class="slide-inner">
        <picture class="hero-media">
          <img src="hero-1.jpg" alt="Bright kids dresses on display">
        </picture>
        <div class="hero-caption">
          <h1>Unique Dresses — Only One of Each</h1>
          <p>Handmade kids' dresses. Once it's sold, it's gone. Find the one that fits her best.</p>
          <div class="hero-cta">
            <a class="btn large" href="#shop"><i class="fa fa-shopping-bag"></i> Shop Now</a>
            <a class="btn outline" href="#about"><i class="fa fa-info-circle"></i> Learn More</a>
          </div>
        </div>
      </div>
    </div>

    <div class="slide" data-slide="2" role="group" aria-roledescription="slide" aria-label="Slide 2 of 3">
      <div class="slide-inner">
        <picture class="hero-media">
          <img src="hero-2.jpg" alt="Child wearing a floral dress">
        </picture>
        <div class="hero-caption">
          <h2>Playful, Pretty & Practical</h2>
          <p>Comfortable fabrics, joyful designs — perfect for parties and play dates.</p>
          <div class="hero-cta">
            <a class="btn large" href="#shop"><i class="fa fa-star"></i> Browse Styles</a>
          </div>
        </div>
      </div>
    </div>

    <div class="slide" data-slide="3" role="group" aria-roledescription="slide" aria-label="Slide 3 of 3">
      <div class="slide-inner">
        <picture class="hero-media">
          <img src="hero-4.jpg" alt="Close-up detail of dress fabric">
        </picture>
        <div class="hero-caption">
          <h2>Limited Editions</h2>
          <p>Each dress is one-of-a-kind — grab it before it's gone.</p>
          <div class="hero-cta">
            <a class="btn large" href="#shop"><i class="fa fa-bolt"></i> Limited Picks</a>
          </div>
        </div>
      </div>
    </div>

    <!-- hero controls (JS will hook these) -->
    <div class="hero-controls">
      <button class="hero-prev" aria-label="Previous slide"><i class="fa fa-chevron-left"></i></button>
      <button class="hero-next" aria-label="Next slide"><i class="fa fa-chevron-right"></i></button>
      <div class="hero-dots" role="tablist" aria-label="Slide indicators"></div>
    </div>
  </div>
</section>

<!-- CATEGORIES (AGE RANGES) -->
<section class="categories" aria-label="Age categories">
  <div class="container">
    <h3 class="section-title"><i class="fa fa-list"></i> Sizes & Age Groups</h3>
    <div class="category-chips" role="toolbar" aria-label="Filter by age">
      <button class="chip" data-filter="0-3">0–3 yrs <i class="fa fa-baby"></i></button>
      <button class="chip" data-filter="4-5">4–5 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="5-6">5–6 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="6-7">6–7 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="7-8">7–8 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="8-9">8–9 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="9-10">9–10 yrs <i class="fa fa-child"></i></button>
      <button class="chip" data-filter="10-12">10–12 yrs <i class="fa fa-teen"></i></button>
      <button class="chip" data-filter="adult">Adult <i class="fa fa-user"></i></button>
    </div>
  </div>
</section>

<!-- SHOP / PRODUCT GRID -->
<section id="shop" class="shop container" aria-labelledby="shop-heading">
  <div class="shop-header">
    <h2 id="shop-heading"><i class="fa fa-store"></i> Shop Dresses</h2>
    <div class="shop-controls">
      <div class="search-wrap">
        <input id="search-input" type="search" placeholder="Search by name, color or id..." aria-label="Search products">
        <button id="search-clear" class="icon-btn" aria-label="Clear search"><i class="fa fa-times"></i></button>
      </div>

      <div class="sort-wrap">
        <label for="sort-select" class="sr-only">Sort</label>
        <select id="sort-select" aria-label="Sort products">
          <option value="featured">Featured</option>
          <option value="newest">Newest</option>
          <option value="price-asc">Price: Low → High</option>
          <option value="price-desc">Price: High → Low</option>
        </select>
      </div>
    </div>
  </div>

 
  <div id="product-grid" class="product-grid" data-total-products="50" aria-live="polite">
    <!-- JS will inject product cards here using the template below -->
  </div>

  <!-- Load more to reveal more products in batches of 10 -->
  <div class="load-more-wrap">
    <button id="load-more" class="btn" aria-controls="product-grid" aria-label="Load more products">
      More dresses <i class="fa fa-chevron-down"></i>
    </button>
  </div>
</section>

<!-- PRODUCT CARD TEMPLATE (to be cloned by JS) -->
<template id="product-card-template">
  <article class="product-card" role="article" aria-label="Product">
    <div class="product-media">
      <button class="quickview" data-action="open-modal" aria-label="Quick view product">
        <i class="fa fa-search-plus"></i>
      </button>
      <img src="" alt="" class="product-image" />
      <div class="product-tag">
        <span class="tag-text">One-of-a-kind</span>
        <i class="fa fa-tag"></i>
      </div>
    </div>

    <div class="product-body">
      <h3 class="product-title"></h3>
      <p class="product-meta">
        <span class="product-size"></span>
        <span class="product-id"></span>
      </p>
      <div class="product-bottom">
        <div class="price-wrap">
          <span class="price"></span>
        </div>
        <div class="card-actions">
          <button class="btn tiny add-cart" data-action="add-to-cart" aria-label="Add to cart">
            <i class="fa fa-shopping-cart"></i> Add
          </button>
          <button class="btn outline tiny more-info" data-action="more-info" aria-label="More details">
            <i class="fa fa-info-circle"></i> More
          </button>
        </div>
      </div>
    </div>
  </article>
</template>

<!-- PRODUCT QUICK-VIEW / DETAILS MODAL -->
<div id="product-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title">
  <div class="modal-inner">
    <button class="modal-close" aria-label="Close product" data-action="close-modal">
      <i class="fa fa-times"></i>
    </button>

    <div class="modal-grid">
      <div class="modal-media">
        <div class="gallery" id="modal-gallery" aria-live="polite">
          <!-- JS will fill with <img> thumbnails and main image -->
        </div>
        <div class="gallery-thumbs" id="modal-thumbs">
          <!-- thumbnails -->
        </div>
      </div>

      <div class="modal-info">
        <h2 id="modal-title" class="modal-title"></h2>
        <p class="modal-id"></p>

        <div class="price-row">
          <div class="modal-price"></div>
          <div class="availability"><i class="fa fa-check-circle"></i> In stock</div>
        </div>

        <p class="modal-desc"></p>

        <div class="modal-controls">
          <label for="modal-size">Size</label>
          <select id="modal-size" name="size" aria-label="Choose size">
            <option value="">Select size</option>
          </select>

          <label for="modal-qty">Qty</label>
          <input id="modal-qty" type="number" min="1" value="1" aria-label="Quantity" />

          <div class="modal-cta">
            <button id="modal-add" class="btn large" data-action="add-to-cart-modal">
              <i class="fa fa-shopping-cart"></i> Add to cart
            </button>

            <button id="modal-buy" class="btn accent" data-action="checkout-now">
              <i class="fa fa-credit-card"></i> Buy now
            </button>
          </div>
        </div>

        <div class="modal-meta">
          <small><i class="fa fa-calendar"></i> Unique piece ID: <span class="meta-id"></span></small>
          <small><i class="fa fa-star"></i> Handmade details</small>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CART PANEL (slide-out) -->
<aside id="cart-panel" class="cart-panel" aria-hidden="true" role="region" aria-label="Shopping cart">
 <div class="cart-header">
    <h3><i class="fa fa-shopping-cart"></i> Your Cart</h3>
    <div class="cart-header-actions" style="display:flex;align-items:center;gap:8px">
      <button id="cart-header-checkout" class="btn tiny checkout-header-btn" data-action="checkout" aria-label="Checkout" disabled>
        <i class="fa fa-credit-card"></i> Checkout
      </button>
      <button class="cart-close icon-btn" aria-label="Close cart" data-action="close-cart"><i class="fa fa-times"></i></button>
    </div>
  </div>


  <div id="cart-contents" class="cart-contents">
    <!-- JS will inject cart items here -->
    <div class="cart-empty">
      <i class="fa fa-box-open fa-3x"></i>
      <p>Your cart is empty. Add a dress you love!</p>
    </div>
  </div>

  <div class="cart-footer">
    <div class="cart-summary">
      <div class="subtotal">
        <span>Subtotal</span>
        <strong id="cart-subtotal">₵0.00</strong>
      </div>
    </div>

    <div class="cart-actions">
      <!-- Paystack will be handled via frontend JS on checkout -->
      <button id="checkout-btn" class="btn large checkout" data-action="checkout" aria-label="Checkout with Paystack">
        <i class="fa fa-credit-card"></i> Checkout (Paystack)
      </button>
      <button id="clear-cart" class="btn outline" data-action="clear-cart" aria-label="Clear cart">
        <i class="fa fa-trash"></i> Clear
      </button>
    </div>
  </div>
</aside>

<!-- CONTACT SECTION (REPLACEMENT) -->
<section id="contact" class="contact container" aria-labelledby="contact-heading">
  <div style="display:flex;gap:20px;align-items:flex-start;flex-wrap:wrap;">
    <!-- Left: contact card -->
    <div class="contact-card contact-card--info" style="flex:1;min-width:280px;">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
        <div style="width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--brand-1),var(--brand-2));box-shadow:0 10px 30px rgba(255,107,138,0.09);color:#fff;font-weight:800;font-size:20px;">
          <i class="fa fa-envelope-open" aria-hidden="true" style="font-size:20px"></i>
        </div>
        <div>
          <h2 id="contact-heading" style="margin:0;font-size:1.15rem;">Get in touch</h2>
          <p class="lead" style="margin:6px 0 0 0;color:var(--muted);">Questions about sizing, custom orders, or shipping — we're happy to help.</p>
        </div>
      </div>

      <div class="contact-grid-info" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;">
        <div class="contact-block">
          <h4>Contact</h4>
          <ul class="contact-list styled">
            <li>
              <button class="contact-action" data-action="call" data-value="+233000000000" aria-label="Call phone">
                <span class="ci"><i class="fa fa-phone"></i></span>
                <div class="ct">
                  <div class="ct-title">Phone</div>
                  <div class="ct-sub">+233 000 000 000</div>
                </div>
                <span class="cta">Call</span>
              </button>
            </li>

            <li>
              <button class="contact-action" data-action="whatsapp" data-value="+233000000000" aria-label="WhatsApp">
                <span class="ci"><i class="fa fa-whatsapp"></i></span>
                <div class="ct">
                  <div class="ct-title">WhatsApp</div>
                  <div class="ct-sub">Chat with us</div>
                </div>
                <span class="cta">Open</span>
              </button>
            </li>

            <li>
              <button class="contact-action" data-action="copy" data-value="hello@tinythreads.example" aria-label="Copy email">
                <span class="ci"><i class="fa fa-envelope"></i></span>
                <div class="ct">
                  <div class="ct-title">Email</div>
                  <div class="ct-sub">hello@tinythreads.example</div>
                </div>
                <span class="cta">Copy</span>
              </button>
            </li>
          </ul>
        </div>

        <div class="contact-block">
          <h4>Hours</h4>
          <div style="color:var(--muted);font-size:0.95rem;">
            <div><strong>Mon–Fri:</strong> 9:00 — 17:00</div>
            <div><strong>Sat:</strong> 10:00 — 14:00</div>
            <div><strong>Sun:</strong> Closed</div>
          </div>

          <h4 style="margin-top:12px;">Follow</h4>
          <div class="socials contact-socials" style="margin-top:6px;">
            <a href="#" aria-label="Instagram"><i class="fa fa-instagram"></i></a>
            <a href="#" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
            <a href="#" aria-label="TikTok"><i class="fa fa-music"></i></a>
          </div>
        </div>
      </div>

      <div style="margin-top:12px;color:var(--muted);font-size:0.92rem;">
        <strong>Retail:</strong> Pickup available at Accra studio. Shipping across Ghana (and international on request).
      </div>
    </div>

    <!-- Right: contact form -->
    <form id="contact-form" class="contact-form contact-card contact-card--form" aria-label="Contact form" novalidate style="flex:1;min-width:320px;">
      <div style="display:flex;align-items:center;gap:10px;">
        <h3 style="margin:0">Send a message</h3>
        <div style="margin-left:auto;color:var(--muted);font-size:0.95rem">We reply within 24 hrs</div>
      </div>

      <div class="form-row">
        <label for="name" class="form-label">Full name</label>
        <input id="name" name="name" type="text" placeholder="Your name" required />
      </div>

      <div class="form-row row-2">
        <div style="flex:1;">
          <label for="email" class="form-label">Email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" required />
        </div>
        <div style="width:140px;">
          <label for="contact-method" class="form-label">Preferred</label>
          <select id="contact-method" name="contact-method" aria-label="Preferred contact method">
            <option value="email">Email</option>
            <option value="whatsapp">WhatsApp</option>
            <option value="phone">Phone</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <label for="message" class="form-label">Message</label>
        <textarea id="message" name="message" rows="5" placeholder="Ask about size, availability, custom orders..." required></textarea>
      </div>

      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:6px;">
        <div style="display:flex;gap:8px;align-items:center;">
          <label style="display:flex;gap:8px;align-items:center;font-size:0.95rem;color:var(--muted);">
            <input type="checkbox" id="contact-consent" /> Receive updates & restocks
          </label>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn"><i class="fa fa-paper-plane"></i> Send message</button>
          <button type="reset" class="btn outline">Reset</button>
        </div>
      </div>
    </form>
  </div>
</section>


<!-- ABOUT / SHOP INFO -->
<section id="about" class="about container" aria-labelledby="about-heading">
  <h2 id="about-heading"><i class="fa fa-info-circle"></i> About Tiny Threads</h2>
  <p class="lead">We make one-off dresses for children and small adults — lovingly crafted and limited in quantity. Each piece is photographed and listed as a single item. When it’s sold, it’s removed from the shop so you know you’re getting something unique.</p>

  <ul class="features-grid">
    <li><i class="fa fa-hand-paper"></i> Ethically made</li>
    <li><i class="fa fa-seedling"></i> Natural fabrics</li>
    <li><i class="fa fa-truck"></i> Fast local shipping</li>
    <li><i class="fa fa-star"></i> Unique designs</li>
  </ul>
</section>
```

  </main>

<footer class="site-footer" role="contentinfo" aria-label="Site footer">
  <div class="footer-grid">
    <!-- Brand & description -->
    <div>
      <div class="footer-brand">
        <div class="logo-badge" aria-hidden="true"><i class="fa fa-heart" style="font-size:20px;"></i></div>
        <div>
          <a class="footer-logo" href="#" style="text-decoration:none;color:var(--text);font-weight:800;font-size:1.05rem">Tiny Threads</a>
          <div class="brand-copy" style="max-width:360px;">One-of-a-kind kids dresses. Small batches, big smiles — handmade with care.</div>

          <div class="footer-socials" aria-label="Social links" style="margin-top:12px;">
            <a href="#" aria-label="Instagram"><i class="fa fa-instagram"></i></a>
            <a href="#" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
            <a href="#" aria-label="TikTok"><i class="fa fa-music"></i></a>
          </div>

          <div class="footer-payments" aria-hidden="true" style="margin-top:10px;">
            <div class="payment-badge">Visa</div>
            <div class="payment-badge">Momo</div>
            <div class="payment-badge">Paystack</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick links -->
    <div>
      <h4>Shop</h4>
      <ul class="footer-links">
        <li><a href="#shop"><i class="fa fa-angle-right"></i> Shop</a></li>
        <li><a href="#about"><i class="fa fa-angle-right"></i> About</a></li>
        <li><a href="#contact"><i class="fa fa-angle-right"></i> Contact</a></li>
        <li><a href="admin.html" target="_blank"><i class="fa fa-angle-right"></i> Admin</a></li>
      </ul>
    </div>

    <!-- Support -->
    <div>
      <h4>Support</h4>
      <ul class="footer-links">
        <li><a href="#"><i class="fa fa-angle-right"></i> Shipping & returns</a></li>
        <li><a href="#"><i class="fa fa-angle-right"></i> FAQs</a></li>
        <li><a href="#"><i class="fa fa-angle-right"></i> Sizing guide</a></li>
        <li><a href="#"><i class="fa fa-angle-right"></i> Contact support</a></li>
      </ul>
    </div>

    <!-- Newsletter & contact -->
    <div>
      <h4>Newsletter</h4>
      <div class="footer-newsletter">
        <p style="margin:0;color:var(--muted);font-size:0.95rem">Get new dress drops & restock alerts. Unsubscribe anytime.</p>
        <form id="footer-newsletter" aria-label="Newsletter sign up">
          <input id="footer-email" type="email" placeholder="you@example.com" aria-label="Email for newsletter" />
          <div style="display:flex;gap:8px;margin-top:8px;">
            <button type="submit" class="btn">Subscribe</button>
            <button type="button" id="footer-newsletter-clear" class="btn outline">Clear</button>
          </div>
        </form>

        <div style="margin-top:12px;">
          <div style="font-weight:700">Contact</div>
          <div style="color:var(--muted);margin-top:6px;font-size:0.95rem">
            <div><i class="fa fa-phone"></i> <a href="tel:+233000000000">+233 000 000 000</a></div>
            <div style="margin-top:6px;"><i class="fa fa-envelope"></i> <a href="mailto:hello@tinythreads.example">hello@tinythreads.example</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- bottom legal row -->
  <div class="footer-bottom">
    <div class="footer-left">
      <small class="footer-copyright">&copy; <span id="footer-year"></span> Tiny Threads — All rights reserved.</small>
    </div>
    <ul class="legal" role="list">
      <li><a href="#" aria-label="Terms">Terms</a></li>
      <li><a href="#" aria-label="Privacy">Privacy</a></li>
      <li><a href="#" aria-label="Cookies">Cookies</a></li>
    </ul>
  </div>
</footer>

<!-- Back to top -->
<button id="back-to-top" aria-label="Back to top" title="Back to top"><i class="fa fa-chevron-up"></i></button>


  <!-- TEMPLATES FOR CART ITEMS -->

 <template id="cart-item-template">
  <div class="cart-item" data-product-id="" tabindex="0" role="group" aria-label="Cart item">
    <img src="" alt="" class="cart-item-thumb" />
    <div class="cart-item-info">
      <strong class="cart-item-title clickable"></strong>
      <small class="cart-item-meta"></small>

      <div class="cart-item-price-row" style="display:flex;gap:10px;align-items:center;margin:6px 0;">
        <span class="unit-price" aria-hidden="true" style="font-size:0.95rem;color:var(--muted)"></span>
        <span class="line-price" style="margin-left:auto;"><strong class="item-price"></strong></span>
      </div>

      <div class="cart-item-actions" style="display:flex;gap:8px;align-items:center;">
        <input type="number" min="1" value="1" class="cart-item-qty" aria-label="Quantity" />
        <button class="icon-btn cart-item-remove" aria-label="Remove item"><i class="fa fa-trash"></i></button>
      </div>
    </div>
  </div>
</template>

<!-- CHECKOUT MODAL (REPLACEMENT) -->
<div id="checkout-modal" class="modal checkout-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="checkout-title">
  <div class="modal-inner" role="document" aria-live="polite">
    <!-- decorative stickers -->
    <div class="sticker sticker--left" aria-hidden="true"><i class="fa fa-gift" style="font-size:22px;"></i></div>
    <div class="sticker sticker--right" aria-hidden="true"><i class="fa fa-heart" style="font-size:20px;"></i></div>

    <button class="modal-close" aria-label="Close checkout" data-action="close-checkout" style="position:absolute; right:14px; top:12px; border:0; background:transparent; padding:8px; cursor:pointer;">
      <i class="fa fa-times" style="font-size:18px;color:var(--muted)"></i>
    </button>

    <div class="checkout-inner">
      <header style="display:flex;align-items:center;justify-content:space-between;">
        <div>
          <h2 id="checkout-title" style="margin:0;font-size:1.15rem;"><i class="fa fa-credit-card"></i> Checkout</h2>
          <p style="margin:6px 0 0 0;color:var(--muted);font-size:0.95rem;">Complete your order — we’ll email a receipt after payment.</p>
        </div>
        <div style="text-align:right;color:var(--muted);font-size:13px;">
          <div id="checkout-ref" style="font-weight:700"></div>
          <div id="checkout-date"></div>
        </div>
      </header>

      <!-- DETAILS CARD (top) -->
      <section class="checkout-details" aria-labelledby="details-heading">
        <div class="checkout-form" aria-describedby="details-heading">
          <h3 id="details-heading" style="margin:0 0 6px 0">Your details</h3>

          <div class="row">
            <input id="checkout-name" name="name" type="text" placeholder="Full name" required />
            <input id="checkout-phone" name="phone" type="tel" placeholder="Phone (WhatsApp preferred)" />
          </div>

          <div class="row">
            <input id="checkout-email" name="email" type="email" placeholder="Email (for receipt)" required />
            <select id="checkout-delivery" name="delivery" aria-label="Delivery method">
              <option value="standard">Standard delivery</option>
              <option value="express">Express delivery (+GHS 15)</option>
              <option value="pickup">Pick up (free)</option>
            </select>
          </div>

          <div class="row">
            <input id="checkout-address1" type="text" placeholder="Address line 1" />
            <input id="checkout-address2" type="text" placeholder="Address line 2 (optional)" />
          </div>

          <div class="row">
            <input id="checkout-city" type="text" placeholder="City/Town" />
            <input id="checkout-region" type="text" placeholder="Region" />
          </div>

          <div class="row">
            <input id="checkout-postal" type="text" placeholder="Postal code" />
            <input id="checkout-promo" type="text" placeholder="Promo code (optional)" />
          </div>

          <div style="display:flex;gap:8px;align-items:center;">
            <label style="display:flex;gap:8px;align-items:center;"><input id="checkout-save" type="checkbox" /> Save these details for next time</label>
          </div>

          <label for="checkout-notes" style="margin-top:6px;font-weight:700">Order notes</label>
          <textarea id="checkout-notes" placeholder="Add delivery instructions, gift note, etc."></textarea>
        </div>

        <aside class="checkout-summary-card" aria-labelledby="summary-title">
          <h4 id="summary-title" style="margin:0 0 6px 0">Order summary</h4>
          <div style="font-size:0.95rem;color:var(--muted)">Items: <strong id="checkout-count">0</strong></div>
          <div style="display:flex;justify-content:space-between;margin-top:8px;"><div style="color:var(--muted)">Subtotal</div><div id="checkout-subtotal">₵0.00</div></div>
          <div class="checkout-hide-processing-note" style="display:flex;justify-content:space-between;margin-top:6px;"><div style="color:var(--muted)">Processing fee</div><div id="checkout-fee">₵0.00</div></div>
          <div style="display:flex;justify-content:space-between;margin-top:10px;font-size:1.05rem;"><div style="font-weight:700">Total</div><div id="checkout-total" class="total">₵0.00</div></div>
          <div style="margin-top:10px; font-size:12px; color:var(--muted)">We accept Paystack payments. You will receive a printable receipt after payment.</div>
        </aside>
      </section>

      <!-- ITEMS (below) -->
      <section class="checkout-items-wrap" aria-labelledby="items-heading">
        <h3 id="items-heading" style="margin:0 0 6px 0;"><i class="fa fa-receipt"></i> Order & items</h3>

        <div style="display:flex;gap:16px;flex-direction:row;align-items:flex-start;flex-wrap:wrap;">
          <div style="flex:1; min-width:280px;">
            <div id="checkout-items" class="checkout-items-list" aria-live="polite" aria-atomic="true">
              <!-- JS injects item rows here -->
            </div>

            <div style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
              <button id="checkout-pay" class="btn large" type="button"><i class="fa fa-credit-card"></i> Pay securely</button>
              <button id="checkout-cancel" class="btn outline" type="button"><i class="fa fa-times"></i> Cancel</button>
              <button id="checkout-clear" class="btn tiny" type="button" title="Clear cart"><i class="fa fa-trash"></i></button>
            </div>
          </div>

          <!-- small mobile-friendly totals (duplicated for convenience) -->
          <div style="width:240px;min-width:220px;">
            <div style="padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow);">
              <div style="display:flex;justify-content:space-between;"><div style="color:var(--muted)">Subtotal</div><div id="checkout-subtotal-2">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:6px;"><div style="color:var(--muted)">Processing</div><div id="checkout-fee-2">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:10px;font-weight:800;font-size:1.1rem;"><div>Total</div><div id="checkout-total-2">₵0.00</div></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>

<!-- PURCHASE HISTORY MODAL -->
<div id="history-modal" role="dialog" aria-modal="true" aria-labelledby="history-title">
  <div class="modal-inner" role="document">
    <button class="modal-close" aria-label="Close history" id="history-close" style="position:absolute; right:12px; top:12px; border:0; background:transparent; padding:8px; cursor:pointer;"><i class="fa fa-times" style="color:var(--muted)"></i></button>

    <header style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
      <div>
        <h3 id="history-title" style="margin:0;"><i class="fa fa-history"></i> Recent purchases</h3>
        <p style="margin:6px 0 0 0;color:var(--muted);font-size:0.95rem;">Your recent orders are stored locally on this device. Click View to open the receipt (PDF).</p>
      </div>
      <div style="text-align:right;color:var(--muted)"><small id="history-count">0</small></div>
    </header>

    <div style="margin-top:12px;">
      <div id="history-list" class="history-list" aria-live="polite"></div>

      <div style="margin-top:14px;display:flex;gap:8px;justify-content:flex-end;">
        <button id="history-clear-all" class="btn tiny outline">Clear history</button>
        <button id="history-close-bottom" class="btn tiny">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- BUY NOW (single product) MODAL -->
<div id="buynow-modal" class="modal checkout-modal" role="dialog" aria-modal="true" aria-hidden="true" style="z-index:130;display:none;">
  <div class="modal-inner" style="max-width:980px; padding:18px;">
    <button class="modal-close" aria-label="Close buy now" data-action="close-buynow" style="right:16px;top:12px">
      <i class="fa fa-times"></i>
    </button>
    <div style="display:grid;grid-template-columns:1fr 340px;gap:16px;">
      <!-- LEFT: single product preview -->
      <div style="padding:8px 6px; max-height:60vh; overflow:auto;">
        <h2 style="margin:0 0 8px 0; font-size:1.1rem;"><i class="fa fa-bolt"></i> Buy this item</h2>
        <div id="buynow-item" aria-live="polite" style="display:flex;flex-direction:column;gap:10px;margin-top:10px;">
          <!-- JS injects single item row (thumbnail, title, size, qty, price) -->
        </div>
      </div>

      <!-- RIGHT: buyer details + summary -->
      <aside style="padding:8px 12px; background:linear-gradient(180deg,#fff,#fffefc); border-radius:12px; box-shadow:var(--shadow);">
        <h3 style="margin:0 0 8px 0;">Your details</h3>
        <form id="buynow-form" novalidate>
          <div style="display:flex;flex-direction:column;gap:8px;">
            <label class="sr-only" for="buynow-name">Full name</label>
            <input id="buynow-name" name="name" type="text" placeholder="Full name" required style="padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)" />

            <label class="sr-only" for="buynow-email">Email</label>
            <input id="buynow-email" name="email" type="email" placeholder="Email (for receipt)" required style="padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)" />

            <label class="sr-only" for="buynow-phone">Phone</label>
            <input id="buynow-phone" name="phone" type="tel" placeholder="Phone number (WhatsApp preferred)" style="padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.06)" />
          </div>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(15,23,42,0.04)" />

          <div style="display:flex;flex-direction:column;gap:6px;">
           <div style="display:flex;justify-content:space-between"><span>Subtotal</span><strong id="buynow-subtotal">₵0.00</strong></div>
            <div style="display:flex;justify-content:space-between"><span>Processing fee <small>(1.95% + 1%)</small></span><strong id="buynow-fee">₵0.00</strong></div>
            <div style="display:flex;justify-content:space-between;font-size:1.05rem;margin-top:6px;"><span>Total</span><strong id="buynow-total">₵0.00</strong></div>
          </div>

          <div style="display:flex;gap:8px;margin-top:12px;">
            <button id="buynow-pay" class="btn large" type="button"><i class="fa fa-credit-card"></i> Pay</button>
            <button id="buynow-cancel" class="btn outline" type="button"><i class="fa fa-times"></i> Cancel</button>
          </div>
        </form>
      </aside>
    </div>
  </div>
</div>

  <!-- PAYMENT RECEIPT MODAL (REPLACEMENT) -->
<div id="receipt-modal" class="modal receipt-modal" role="dialog" aria-modal="true" aria-labelledby="receipt-title" style="display:none;">
  <div class="modal-inner" role="document">
    <div class="sticker left" aria-hidden="true"><i class="fa fa-receipt" style="font-size:20px;"></i></div>
    <div class="sticker right" aria-hidden="true"><i class="fa fa-smile" style="font-size:18px;"></i></div>

    <button class="modal-close" aria-label="Close receipt" id="receipt-close" style="position:absolute; right:12px; top:10px; border:0; background:transparent; padding:8px; cursor:pointer;">
      <i class="fa fa-times" style="color:var(--muted);font-size:18px;"></i>
    </button>

    <header style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:6px;">
      <div>
        <h2 id="receipt-title" style="margin:0;font-size:1.15rem;"><i class="fa fa-file-invoice"></i> Payment receipt</h2>
        <p id="receipt-sub" class="lead" style="margin:6px 0 0 0;color:var(--muted);">Receipt and PDF preview. Use the actions to view, download, or print the invoice.</p>
      </div>
      <div style="text-align:right;">
        <div id="receipt-ref" style="font-weight:700"></div>
        <div id="receipt-date" style="color:var(--muted);font-size:13px"></div>
      </div>
    </header>

    <div class="receipt-grid" style="align-items:start;">
      <div class="receipt-left">
        <div class="receipt-summary" id="receipt-summary" aria-live="polite">
          <!-- populated by JS: Buyer / items summary / totals -->
        </div>

        <div style="display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap;">
          <div style="flex:1">
            <h4 style="margin:10px 0 6px 0;">Items</h4>
            <div class="receipt-items" id="receipt-items">
              <!-- JS: item rows -->
            </div>
          </div>

          <div style="width:280px;min-width:220px;">
            <div class="receipt-summary" style="padding:12px;">
              <div style="display:flex;justify-content:space-between;"><div style="color:var(--muted)">Subtotal</div><div id="receipt-subtotal">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:6px;"><div style="color:var(--muted)">Processing</div><div id="receipt-processing">₵0.00</div></div>
              <div style="display:flex;justify-content:space-between;margin-top:10px;font-weight:900;font-size:1.15rem;"><div>Total paid</div><div id="receipt-total" style="color:var(--brand-1)"></div></div>
              <div style="margin-top:12px;">
                <button id="receipt-view" class="btn large"><i class="fa fa-eye"></i> View PDF</button>
                <button id="receipt-download" class="btn outline" style="margin-top:8px;"><i class="fa fa-download"></i> Download</button>
                <button id="receipt-print" class="btn tiny" style="margin-top:8px;"><i class="fa fa-print"></i> Print</button>
              </div>
            </div>
          </div>
        </div>

        <div id="receipt-preview-wrap" class="receipt-preview-wrap" style="margin-top:12px; display:none; position:relative;">
          <div style="font-size:0.95rem; color:var(--muted); margin-bottom:6px;"><strong>PDF preview</strong> — scroll within the frame or open it in a new tab.</div>
          <div style="position:relative;">
            <div class="preview-loader" id="preview-loader" style="display:none;">
              <div class="lead">Loading PDF…</div>
            </div>
            <iframe id="receipt-preview" class="receipt-iframe" title="Receipt preview" sandbox=""></iframe>
          </div>
        </div>
      </div>

      <aside class="receipt-right" aria-label="Receipt actions & status">
        <div style="position:sticky; top:16px;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
            <div class="receipt-badge" id="receipt-status">PAID</div>
            <div style="font-size:0.95rem;color:var(--muted)"><strong id="receipt-method">Paystack</strong></div>
          </div>

          <div style="padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow);">
            <div style="font-weight:700">Order details</div>
            <div style="margin-top:8px;color:var(--muted);font-size:13px" id="receipt-order-meta"></div>
            <div style="margin-top:12px;">
              <small style="color:var(--muted)">Receipt reference</small>
              <div style="font-weight:800" id="receipt-ref-2"></div>
            </div>
          </div>

          <div style="margin-top:12px;">
            <button id="receipt-close-bottom" class="btn outline">Close</button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</div>

<script>
(() => {
  'use strict';

  /* ============= CONFIG ============= */
  const PAYSTACK_PUBLIC_KEY = 'pk_test_297586e51710e83d3c159bfe71ff45c7e23411fa';
  const PAYSTACK_CURRENCY = 'GHS';
  let CURRENCY_SYMBOL = '₵';
  const STORAGE_KEYS = { PRODUCTS: 'tiny_products_v1', CART: 'tiny_cart_v1', ORDERS: 'tiny_orders_v1' };
  const LOAD_BATCH = 10;
  const MOBILE_BREAKPOINT = 720;

  /* ============= HELPERS ============= */
  const $ = (sel, root = document) => root.querySelector(sel);
  const $$ = (sel, root = document) => Array.from((root || document).querySelectorAll(sel));
  const nowISO = () => new Date().toISOString();
  const formatPrice = (p) => `${CURRENCY_SYMBOL}${Number(p || 0).toFixed(2)}`;

  function toast(msg, time = 2200) {
    try {
      const t = document.createElement('div');
      t.className = 'tiny-toast';
      t.textContent = msg;
      document.body.appendChild(t);
      requestAnimationFrame(() => t.classList.add('show'));
      setTimeout(() => { t.classList.remove('show'); setTimeout(()=>t.remove(), 280); }, time);
    } catch (e) { console.warn(e); }
  }

  async function fetchImageAsDataURL(url) {
    if (!url) return null;
    try {
      const r = await fetch(url, { cache: 'no-cache' });
      if (!r.ok) return null;
      const blob = await r.blob();
      return await new Promise((res, rej) => {
        const fr = new FileReader();
        fr.onloadend = () => res(fr.result);
        fr.onerror = rej;
        fr.readAsDataURL(blob);
      });
    } catch (e) { return null; }
  }

  /* ============= SAMPLE PRODUCTS (local) ============= */
  // Keep your original built-in list — shortened here for brevity in this snippet.
  // The page already has a long builtInProducts list; try to reuse it if present.
  const builtInProducts = (function () {
    try {
      // if the page already defines a global builtInProducts use that (compatibility)
      if (window.builtInProducts && Array.isArray(window.builtInProducts) && window.builtInProducts.length) return window.builtInProducts;
    } catch (e) {}
    // Minimal fallback sample (in case nothing exists)
    return [
      { id: "DRESS-001", title: "Floral Ruffles", price: 40.00, description: "One-of-a-kind floral ruffle dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5700.JPG","IMG_5700.JPG"], available: true, createdAt: new Date(Date.now()-1*86400000).toISOString() },
  { id: "DRESS-002", title: "Sunshine Dress", price: 30.00, description: "Bright yellow play dress", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5701.JPG"], available: true, createdAt: new Date(Date.now()-2*86400000).toISOString() },
  { id: "DRESS-003", title: "Party Bow Dress", price: 35.00, description: "Elegant dress for special occasions", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5702.JPG","IMG_5702.JPG"], available: true, createdAt: new Date(Date.now()-3*86400000).toISOString() },
  { id: "DRESS-004", title: "Polka Play", price: 35.00, description: "Polka-dot twirl dress", sizes: ["0-3M","3-6M"], ageCategory: "4-5", images: ["IMG_5703.JPG"], available: true, createdAt: new Date(Date.now()-4*86400000).toISOString() },
  { id: "DRESS-005", title: "Candy Stripes", price: 35.00, description: "Soft striped cotton dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5704.JPG","IMG_5704.JPG"], available: true, createdAt: new Date(Date.now()-5*86400000).toISOString() },
  { id: "DRESS-006", title: "Meadow Tiny", price: 35.00, description: "Hand-stitched meadow pattern", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5705.JPG"], available: true, createdAt: new Date(Date.now()-6*86400000).toISOString() },
  { id: "DRESS-007", title: "Lace Halo", price: 40.00, description: "Lace-trim party dress", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5706.JPG","IMG_5706.JPG"], available: true, createdAt: new Date(Date.now()-7*86400000).toISOString() },
  { id: "DRESS-008", title: "Seaside Sundress", price: 35.00, description: "Cool and breezy sun dress", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5707.JPG"], available: true, createdAt: new Date(Date.now()-8*86400000).toISOString() },
  { id: "DRESS-009", title: "Minty Bow", price: 100.00, description: "White Shirt with skirt", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5708.JPG","IMG_5708.JPG"], available: true, createdAt: new Date(Date.now()-9*86400000).toISOString() },
  { id: "DRESS-010", title: "Rosette Charm", price: 35.00, description: "Rosette detailing, comfy fit", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5709.JPG"], available: true, createdAt: new Date(Date.now()-10*86400000).toISOString() },

  { id: "DRESS-011", title: "Blossom Day", price: 30.00, description: "Lightweight blossom print dress", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5710.JPG","IMG_5710.JPG"], available: true, createdAt: new Date(Date.now()-11*86400000).toISOString() },
  { id: "DRESS-012", title: "Vintage Coral", price: 40.00, description: "Retro coral dress with pockets", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5711.JPG"], available: true, createdAt: new Date(Date.now()-12*86400000).toISOString() },
  { id: "DRESS-013", title: "Petal Puff", price: 30.00, description: "Petal-pattern puff sleeve dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5712.JPG","IMG_5712.JPG"], available: true, createdAt: new Date(Date.now()-13*86400000).toISOString() },
  { id: "DRESS-014", title: "Lemon Drop", price: 65.00, description: "Blue jeans trousers", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5713.JPG"], available: true, createdAt: new Date(Date.now()-14*86400000).toISOString() },
  { id: "DRESS-015", title: "Bluebell Classic", price: 65.00, description: "Black jeans trousers", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5714.JPG","IMG_5714.JPG"], available: true, createdAt: new Date(Date.now()-15*86400000).toISOString() },
  { id: "DRESS-016", title: "Gingham Girl", price: 35.00, description: "Cute gingham for playdates", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5715.JPG"], available: true, createdAt: new Date(Date.now()-16*86400000).toISOString() },
  { id: "DRESS-017", title: "Velvet Holiday", price: 50.00, description: "Velvet holiday edition", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5716.JPG","IMG_5716.JPG"], available: true, createdAt: new Date(Date.now()-17*86400000).toISOString() },
  { id: "DRESS-018", title: "Daisy Chain", price: 70.00, description: "Daisy print with soft lining", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5717.JPG"], available: true, createdAt: new Date(Date.now()-18*86400000).toISOString() },
  { id: "DRESS-019", title: "Sunset Ombre", price: 50.00, description: "Ombre fade summer dress", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5718.JPG","IMG_5718.JPG"], available: true, createdAt: new Date(Date.now()-19*86400000).toISOString() },
  { id: "DRESS-020", title: "Coral Petals", price: 70.00, description: "Coral floral with ruffled hem", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5719.JPG"], available: true, createdAt: new Date(Date.now()-20*86400000).toISOString() },

  { id: "DRESS-021", title: "Lavender Mist", price: 28.00, description: "Soft lavender cotton dress", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5720.JPG","IMG_5720.JPG"], available: true, createdAt: new Date(Date.now()-21*86400000).toISOString() },
  { id: "DRESS-022", title: "Plaid Picnic", price: 28.00, description: "Cute plaid button dress", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5720.JPG"], available: true, createdAt: new Date(Date.now()-22*86400000).toISOString() },
  { id: "DRESS-023", title: "Rosebud Twirl", price: 120.00, description: "Lightweight twirl skirt", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5721.JPG","IMG_5721.JPG"], available: true, createdAt: new Date(Date.now()-23*86400000).toISOString() },
  { id: "DRESS-024", title: "Mint Sprig", price: 80.00, description: "Refreshingly cool mint dress", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5722.JPG"], available: true, createdAt: new Date(Date.now()-24*86400000).toISOString() },
  { id: "DRESS-025", title: "Buttercup", price: 35.00, description: "Premium buttercup fabric", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5723.JPG","IMG_5723.JPG"], available: true, createdAt: new Date(Date.now()-25*86400000).toISOString() },
  { id: "DRESS-026", title: "Peach Dream", price: 60.00, description: "Soft peach party dress", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5724.JPG"], available: true, createdAt: new Date(Date.now()-26*86400000).toISOString() },
  { id: "DRESS-027", title: "Ivy Garden", price: 35.00, description: "Ivy print with tiny pleats", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5725.JPG","IMG_5725.JPG"], available: true, createdAt: new Date(Date.now()-27*86400000).toISOString() },
  { id: "DRESS-028", title: "Ocean Breeze", price: 45.00, description: "Nautical details and stripes", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5726.JPG"], available: true, createdAt: new Date(Date.now()-28*86400000).toISOString() },
  { id: "DRESS-029", title: "Lilac Lace", price: 35.00, description: "Delicate lilac lace overlay", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5727.JPG","IMG_5727.JPG"], available: true, createdAt: new Date(Date.now()-29*86400000).toISOString() },
  { id: "DRESS-030", title: "Maple Sweet", price: 40.00, description: "Warm tones for autumn play", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5728.JPG"], available: true, createdAt: new Date(Date.now()-30*86400000).toISOString() },

  { id: "DRESS-031", title: "Cherry Puff", price: 40.00, description: "Cherry prints and puff sleeves", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5729.JPG","IMG_5729.JPG"], available: true, createdAt: new Date(Date.now()-31*86400000).toISOString() },
  { id: "DRESS-032", title: "Starry Night", price: 35.00, description: "Dark blue with star pattern", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5730.JPG"], available: true, createdAt: new Date(Date.now()-32*86400000).toISOString() },
  { id: "DRESS-033", title: "Palm Picnic", price: 35.00, description: "Tropical print for sunny days", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5731.JPG","IMG_5731.JPG"], available: true, createdAt: new Date(Date.now()-33*86400000).toISOString() },
  { id: "DRESS-034", title: "Velvet Ribbon", price: 40.00, description: "Lux velvet with ribbon tie", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5732.JPG"], available: true, createdAt: new Date(Date.now()-34*86400000).toISOString() },
  { id: "DRESS-035", title: "Rose Quartz", price: 35.00, description: "Soft pink, comfy cotton", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5733.JPG","IMG_5733.JPG"], available: true, createdAt: new Date(Date.now()-35*86400000).toISOString() },
  { id: "DRESS-036", title: "Star Bloom", price: 30.00, description: "Star bloom pattern, breezy", sizes: ["S","M"], ageCategory: "4-5", images: ["IMG_5734.JPG"], available: true, createdAt: new Date(Date.now()-36*86400000).toISOString() },
  { id: "DRESS-037", title: "Meadow Stitch", price: 40.00, description: "Detailed stitching, floral", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5735.JPG","IMG_5735.JPG"], available: true, createdAt: new Date(Date.now()-37*86400000).toISOString() },
  { id: "DRESS-038", title: "Denim Dolly", price: 50.00, description: "Soft denim dress with buttons", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5736.JPG"], available: true, createdAt: new Date(Date.now()-38*86400000).toISOString() },
  { id: "DRESS-039", title: "Citrine Bloom", price: 65.00, description: "Sunny citrine color", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5737.JPG","IMG_5737.JPG"], available: true, createdAt: new Date(Date.now()-39*86400000).toISOString() },
  { id: "DRESS-040", title: "Cloud Puff", price: 25.00, description: "Puffy clouds print", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5738.JPG"], available: true, createdAt: new Date(Date.now()-40*86400000).toISOString() },

  { id: "DRESS-041", title: "Mint Melody", price: 28.00, description: "Light mint with trims", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5739.JPG","IMG_5739.JPG"], available: true, createdAt: new Date(Date.now()-41*86400000).toISOString() },
  { id: "DRESS-042", title: "Petite Pearl", price: 25.00, description: "Pearl button detail", sizes: ["9","10"], ageCategory: "4-5", images: ["IMG_5740.JPG"], available: true, createdAt: new Date(Date.now()-42*86400000).toISOString() },
  { id: "DRESS-043", title: "Coral Breeze", price: 35.00, description: "Soft coral shade", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5741.JPG","IMG_5741.JPG"], available: true, createdAt: new Date(Date.now()-43*86400000).toISOString() },
  { id: "DRESS-044", title: "Pineapple Pop", price: 30.00, description: "Fun pineapple print", sizes: ["4","5"], ageCategory: "4-5", images: ["IMG_5742.JPG"], available: true, createdAt: new Date(Date.now()-44*86400000).toISOString() },
  { id: "DRESS-045", title: "Willow Whisper", price: 40.00, description: "Earthy willow tones", sizes: ["5","6"], ageCategory: "4-5", images: ["IMG_5743.JPG","IMG_5743.JPG"], available: true, createdAt: new Date(Date.now()-45*86400000).toISOString() },
  { id: "DRESS-046", title: "Sunbeam Tuck", price: 35.00, description: "Tucked waist, sunny print", sizes: ["6","7"], ageCategory: "4-5", images: ["IMG_5744.JPG"], available: true, createdAt: new Date(Date.now()-46*86400000).toISOString() },
  { id: "DRESS-047", title: "Peppermint Twist", price: 30.00, description: "Mint stripes and soft collar", sizes: ["7","8"], ageCategory: "4-5", images: ["IMG_5745.JPG","IMG_5745.JPG"], available: true, createdAt: new Date(Date.now()-47*86400000).toISOString() },
  { id: "DRESS-048", title: "Dotted Dreams", price: 60.00, description: "Subtle dotted pattern", sizes: ["8","9"], ageCategory: "4-5", images: ["IMG_5746.JPG"], available: true, createdAt: new Date(Date.now()-48*86400000).toISOString() },
  { id: "DRESS-049", title: "Little Luxe", price: 80.00, description: "Tiny luxe finish", sizes: ["9","10"], ageCategory: "7-8", images: ["IMG_5747.JPG","IMG_5747.JPG"], available: true, createdAt: new Date(Date.now()-49*86400000).toISOString() },
  { id: "DRESS-050", title: "Pocket Garden", price: 40.00, description: "Playful pockets and cotton", sizes: ["10","12"], ageCategory: "4-5", images: ["IMG_5748.JPG"], available: true, createdAt: new Date(Date.now()-50*86400000).toISOString() }
];

  })();

  let products = (function loadLocalProducts() {
    try {
      const raw = localStorage.getItem(STORAGE_KEYS.PRODUCTS);
      if (raw) { const parsed = JSON.parse(raw); if (Array.isArray(parsed) && parsed.length) return parsed; }
    } catch (e) {}
    // clone builtInProducts to avoid mutation
    return JSON.parse(JSON.stringify(builtInProducts));
  })();

  function saveProductsLocal() {
    try { localStorage.setItem(STORAGE_KEYS.PRODUCTS, JSON.stringify(products)); } catch (e) {}
  }

  /* ============= CART & ORDERS ============= */
  function loadCart() { try { const r = localStorage.getItem(STORAGE_KEYS.CART); return r ? JSON.parse(r) : []; } catch(e){ return []; } }
  function saveCart(c) { try { localStorage.setItem(STORAGE_KEYS.CART, JSON.stringify(c || [])); } catch(e){} }
  function readOrders() { try { const r = localStorage.getItem(STORAGE_KEYS.ORDERS); return r ? JSON.parse(r) : []; } catch(e){ return []; } }
  function pushOrder(o) { try { const arr = readOrders(); arr.unshift(o); localStorage.setItem(STORAGE_KEYS.ORDERS, JSON.stringify(arr)); } catch(e){} }

  let cart = loadCart();
  let currentBatchIndex = 0;
  let activeFilters = { ageCategory: null, search: '', sort: 'featured' };

  /* ============= PRODUCT RENDER ============= */
  const productGrid = $('#product-grid');
  const productTemplate = document.getElementById('product-card-template')?.content;

  function setProductButtonState(productId, inCart) {
    const card = document.querySelector(`.product-card[data-product-id="${productId}"]`);
    if (card) {
      const addBtn = card.querySelector('[data-action="add-to-cart"]');
      if (addBtn) {
        if (inCart) {
          addBtn.innerHTML = '<i class="fa fa-times-circle"></i> Remove';
          addBtn.classList.add('in-cart');
          addBtn.setAttribute('aria-pressed', 'true');
        } else {
          addBtn.innerHTML = '<i class="fa fa-shopping-cart"></i> Add';
          addBtn.classList.remove('in-cart');
          addBtn.setAttribute('aria-pressed', 'false');
        }
      }
    }
    const modalAdd = $('#modal-add');
    if (modalAdd && window.modalCurrentProduct && window.modalCurrentProduct.id === productId) {
      if (inCart) { modalAdd.innerHTML = '<i class="fa fa-times-circle"></i> Remove from cart'; modalAdd.dataset.state = 'remove'; }
      else { modalAdd.innerHTML = '<i class="fa fa-shopping-cart"></i> Add to cart'; modalAdd.dataset.state = 'add'; }
    }
  }

  function createProductCard(p) {
    const node = document.importNode(productTemplate, true);
    const art = node.querySelector('.product-card');
    art.dataset.productId = p.id;
    const img = node.querySelector('.product-image');
    img.src = (p.images && p.images[0]) || '';
    img.alt = p.title || p.id;
    node.querySelector('.product-title').textContent = p.title || p.id;
    node.querySelector('.product-size').textContent = (p.sizes || []).join(' • ');
    node.querySelector('.product-id').textContent = p.id;
    node.querySelector('.price').textContent = formatPrice(p.price);
    const addBtn = node.querySelector('[data-action="add-to-cart"]');
    const moreBtn = node.querySelector('.more-info');
    const quickBtn = node.querySelector('[data-action="open-modal"]');

    if (!p.available) {
      art.classList.add('sold-out');
      const tag = node.querySelector('.product-tag .tag-text'); if (tag) tag.textContent = 'Sold';
      if (addBtn) { addBtn.disabled = true; addBtn.textContent = 'Sold'; }
    }

    // initial state
    setProductButtonState(p.id, cart.some(c => c.id === p.id));

    addBtn && addBtn.addEventListener('click', (ev) => {
      ev.preventDefault();
      const inCart = cart.some(c => c.id === p.id);
      if (inCart) { removeFromCart(p.id); return; }
      if (p.sizes && p.sizes.length) { openProductModal(p.id); return; }
      addToCart(p.id, 1, '');
    });

    [moreBtn, quickBtn].forEach(btn => btn && btn.addEventListener('click', (ev) => { ev.preventDefault(); openProductModal(p.id); }));

    return node;
  }

  function getFilteredSortedProducts() {
    let list = products.slice().filter(x => x.available !== false);
    if (activeFilters.ageCategory) list = list.filter(p => p.ageCategory === activeFilters.ageCategory);
    const q = (activeFilters.search || '').trim().toLowerCase();
    if (q) list = list.filter(p => (p.title||'').toLowerCase().includes(q) || (p.id||'').toLowerCase().includes(q) || (p.description||'').toLowerCase().includes(q));
    switch (activeFilters.sort) {
      case 'newest': list.sort((a,b)=> new Date(b.createdAt)-new Date(a.createdAt)); break;
      case 'price-asc': list.sort((a,b)=> a.price-b.price); break;
      case 'price-desc': list.sort((a,b)=> b.price-a.price); break;
      default: break;
    }
    return list;
  }

  function renderProductsBatch(reset = false) {
    if (!productGrid) return;
    if (reset) { currentBatchIndex = 0; productGrid.innerHTML = ''; }
    const filtered = getFilteredSortedProducts();
    const start = currentBatchIndex * LOAD_BATCH;
    const batch = filtered.slice(start, start + LOAD_BATCH);
    if (batch.length === 0 && start === 0) { productGrid.innerHTML = `<div class="no-results"><i class="fa fa-frown"></i><p>No dresses found.</p></div>`; return; }
    batch.forEach(p => productGrid.appendChild(createProductCard(p)));
    currentBatchIndex++;
    const loadMore = $('#load-more');
    if (start + LOAD_BATCH >= filtered.length) loadMore && (loadMore.style.display = 'none'); else loadMore && (loadMore.style.display = 'inline-block');
  }

  /* ============= MODAL UTILITIES ============= */
  function openModal(modalEl) {
    if (!modalEl) return;
    modalEl.setAttribute('aria-hidden', 'false');
    modalEl.classList.add('open');
    modalEl.style.display = 'flex';
    document.body.classList.add('modal-open');
    // focus first focusable element inside modal
    setTimeout(() => {
      const f = modalEl.querySelector('button, [tabindex], input, a');
      if (f) try { f.focus(); } catch(e) {}
    }, 80);
  }
  function closeModal(modalEl) {
    if (!modalEl) return;
    modalEl.setAttribute('aria-hidden', 'true');
    modalEl.classList.remove('open');
    try { modalEl.style.display = 'none'; } catch(e) {}
    document.body.classList.remove('modal-open');
    // revoke any attached blob url
    try { if (modalEl._pdfUrl && modalEl._pdfUrl.startsWith('blob:')) { URL.revokeObjectURL(modalEl._pdfUrl); modalEl._pdfUrl = null; } } catch(e) {}
  }
  // wire close buttons and backdrop dismiss
  document.addEventListener('click', (ev) => {
    const btn = ev.target.closest('.modal-close, [data-action="close-modal"], [data-action="close-checkout"], [data-action="close-buynow"]');
    if (btn) {
      const modal = btn.closest('.modal');
      if (modal) closeModal(modal);
      return;
    }
    // close when clicking backdrop (only when clicking the modal container itself)
    if (ev.target.classList && ev.target.classList.contains('modal')) closeModal(ev.target);
  });
  document.addEventListener('keydown', (ev) => {
    if (ev.key === 'Escape') {
      // close top-most open modal
      const openModalEl = document.querySelector('.modal.open');
      if (openModalEl) closeModal(openModalEl);
    }
  });

  /* ============= PRODUCT MODAL ============= */
  const productModal = $('#product-modal');
  window.modalCurrentProduct = null;

  function openProductModal(productId) {
    const p = products.find(x => x.id === productId);
    if (!p) return;
    window.modalCurrentProduct = p;

    const gallery = $('#modal-gallery'); const thumbs = $('#modal-thumbs');
    gallery.innerHTML = ''; thumbs.innerHTML = '';
    (p.images||[]).forEach((src, idx) => {
      const main = document.createElement('img'); main.src = src; main.alt = `${p.title} ${idx+1}`; main.dataset.idx = idx; main.className = 'modal-main-img';
      if (idx !== 0) main.style.display = 'none';
      gallery.appendChild(main);
      const t = document.createElement('img'); t.src = src; t.className = 'thumb'; t.dataset.idx = idx; t.alt = `thumb ${idx+1}`;
      t.addEventListener('click', () => {
        $$('.modal-main-img', gallery).forEach(i => i.style.display = 'none');
        gallery.querySelector(`img[data-idx="${idx}"]`).style.display = '';
      });
      thumbs.appendChild(t);
    });

    $('#modal-title').textContent = p.title || '';
    $('.modal-price') && ($('.modal-price').textContent = formatPrice(p.price || 0));
    $('.modal-desc') && ($('.modal-desc').textContent = p.description || '');
    $('.meta-id') && ($('.meta-id').textContent = p.id || '');

    // sizes
    const sizeSel = $('#modal-size');
    if (sizeSel) { sizeSel.innerHTML = '<option value="">Select size</option>'; (p.sizes||[]).forEach(s => { const o = document.createElement('option'); o.value = s; o.textContent = s; sizeSel.appendChild(o); }); }
    $('#modal-qty').value = 1;

    if (p.available === false) { try { $('.availability').textContent = 'Sold'; } catch(e){}; $('#modal-add') && ($('#modal-add').disabled = true); $('#modal-buy') && ($('#modal-buy').disabled = true); }
    else { try { $('.availability').textContent = 'In stock'; } catch(e){}; $('#modal-add') && ($('#modal-add').disabled = false); $('#modal-buy') && ($('#modal-buy').disabled = false); }

    openModal(productModal);
  }

  function closeProductModal() { closeModal(productModal); window.modalCurrentProduct = null; }

  // modal add / buy buttons
  $('#modal-add')?.addEventListener('click', (ev) => {
    ev.preventDefault();
    if (!window.modalCurrentProduct) return;
    const qty = Number($('#modal-qty')?.value || 1);
    const already = cart.some(c => c.id === window.modalCurrentProduct.id);
    if (already) { removeFromCart(window.modalCurrentProduct.id); closeProductModal(); return; }
    addToCart(window.modalCurrentProduct.id, qty, '');
    closeProductModal();
  });
  $('#modal-buy')?.addEventListener('click', (ev) => {
    ev.preventDefault();
    if (!window.modalCurrentProduct) return;
    const qty = Number($('#modal-qty')?.value || 1);
    openBuyNowModal({ id: window.modalCurrentProduct.id, qty, size: '' });
  });

  /* ============= CART ============= */
  const cartPanel = $('#cart-panel');
  const cartBadge = $('#cart-badge');
  const cartContents = $('#cart-contents');
  const cartSubtotalEl = $('#cart-subtotal');

  function updateCartUI() {
    if (!cartContents) return;
    cartContents.innerHTML = '';
    if (!cart || cart.length === 0) {
      cartContents.innerHTML = `<div class="cart-empty"><i class="fa fa-box-open fa-3x"></i><p>Your cart is empty. Add a dress you love!</p></div>`;
      cartBadge && (cartBadge.textContent = 0);
      cartSubtotalEl && (cartSubtotalEl.textContent = '₵0.00');
      $('#cart-header-checkout') && ($('#cart-header-checkout').disabled = true);
      $('#checkout-btn') && ($('#checkout-btn').disabled = true);
      return;
    }
    cartBadge && (cartBadge.textContent = cart.length);
    let subtotal = 0;
    cart.forEach(item => {
      const p = products.find(pp => pp.id === item.id) || {};
      const tpl = document.getElementById('cart-item-template').content.cloneNode(true);
      const el = tpl.querySelector('.cart-item');
      el.dataset.productId = item.id;
      el.querySelector('.cart-item-thumb').src = (p.images && p.images[0]) || '';
      el.querySelector('.cart-item-title').textContent = p.title || item.id;
      el.querySelector('.cart-item-meta').textContent = `${item.size || ''} • ${p.id || ''}`;
      el.querySelector('.unit-price').textContent = `Unit: ${formatPrice(p.price || 0)}`;
      el.querySelector('.cart-item-qty').value = item.qty;
      el.querySelector('.item-price').textContent = formatPrice((p.price || 0) * item.qty);

      el.querySelector('.cart-item-qty').addEventListener('change', (ev) => {
        let v = Number(ev.target.value || 1);
        if (v < 1) { v = 1; ev.target.value = 1; }
        const idx = cart.findIndex(c => c.id === item.id);
        if (idx >= 0) { cart[idx].qty = v; saveCart(cart); updateCartUI(); }
      });

      el.querySelector('.cart-item-remove').addEventListener('click', (ev) => {
        ev.preventDefault();
        removeFromCart(item.id);
      });

      cartContents.appendChild(tpl);
      subtotal += (p.price || 0) * item.qty;
    });
    cartSubtotalEl && (cartSubtotalEl.textContent = formatPrice(subtotal));
    $('#cart-header-checkout') && ($('#cart-header-checkout').disabled = false);
    $('#checkout-btn') && ($('#checkout-btn').disabled = false);
  }

  function addToCart(productId, qty = 1, size = '') {
    const p = products.find(x => x.id === productId);
    if (!p || p.available === false) { toast('Sorry — this dress is not available'); return; }
    if (cart.some(c => c.id === productId)) { toast('Item already in cart'); return; }
    const item = { id: productId, qty: Math.max(1, Number(qty || 1)), size: size || '' };
    cart.push(item);
    saveCart(cart);
    updateCartUI();
    setProductButtonState(productId, true);
    toast('Added to cart');
    openCart();
  }

  function removeFromCart(productId) {
    const existed = cart.some(c => c.id === productId);
    if (!existed) return;
    cart = cart.filter(c => c.id !== productId);
    saveCart(cart);
    setProductButtonState(productId, false);
    updateCartUI();
    toast('Removed from cart');
  }

  function openCart() { if (!cartPanel) return; cartPanel.setAttribute('aria-hidden','false'); cartPanel.classList.add('open'); updateCartUI(); document.body.classList.add('modal-open'); }
  function closeCart() { if (!cartPanel) return; cartPanel.setAttribute('aria-hidden','true'); cartPanel.classList.remove('open'); document.body.classList.remove('modal-open'); }

  $('#cart-toggle')?.addEventListener('click', (e) => { e.preventDefault(); const open = cartPanel?.classList.contains('open'); if (open) closeCart(); else openCart(); });
  $$('.cart-close').forEach(b => b.addEventListener('click', closeCart));
  $('#clear-cart')?.addEventListener('click', (e)=> { e.preventDefault(); cart=[]; saveCart(cart); updateCartUI(); toast('Cart cleared'); });

  /* ============= CHECKOUT & PAYSTACK (fallback sim) ============= */
  $('#checkout-btn')?.addEventListener('click', (e) => { e.preventDefault(); if (!cart || cart.length===0) { toast('Your cart is empty'); return; } startCheckout(cart); });
  $('#cart-header-checkout')?.addEventListener('click', (e) => { e.preventDefault(); if (!cart || cart.length===0) { toast('Your cart is empty'); return; } startCheckout(cart); });

  function startCheckout(items) { openCheckoutModal(items); }

  /* Checkout modal implementation (collects buyer info and triggers payment) */
  function openCheckoutModal(items) {
    const modalEl = $('#checkout-modal'); if (!modalEl) return;
    const itemsWrap = $('#checkout-items'); const subtotalEl = $('#checkout-subtotal'); const subtotalEl2 = $('#checkout-subtotal-2');
    const feeEl = $('#checkout-fee'); const feeEl2 = $('#checkout-fee-2'); const totalEl = $('#checkout-total'); const totalEl2 = $('#checkout-total-2');
    const countEl = $('#checkout-count'); const refEl = $('#checkout-ref'); const dateEl = $('#checkout-date');
    if (!itemsWrap) return;
    // prepare enriched items
    const enriched = items.map(it => { const p = products.find(pp => pp.id === it.id) || {}; const unit = p.price || 0; const qty = Number(it.qty || 1); return { id: it.id, title: p.title || it.id, image: (p.images && p.images[0]) || '', size: it.size || '', qty, unit, line: +(unit * qty) }; });
    const subtotal = enriched.reduce((s,x)=> s + x.line, 0);
    const fee = +(subtotal * 0.0295).toFixed(2);
    const total = +(subtotal + fee).toFixed(2);
    itemsWrap.innerHTML = '';
    enriched.forEach(it => {
      const row = document.createElement('div'); row.className = 'checkout-item';
      row.innerHTML = `<img src="${it.image}" alt="${it.title}" /><div style="flex:1"><div class="meta">${it.title}</div><small>${it.size ? `Size: ${it.size} • ` : ''}Qty: ${it.qty} • ID: ${it.id}</small></div><div style="text-align:right;min-width:96px;"><div style="font-weight:800">${formatPrice(it.unit)}</div><div style="color:var(--muted)">${formatPrice(it.line)}</div></div>`;
      itemsWrap.appendChild(row);
    });
    subtotalEl.textContent = subtotalEl2.textContent = formatPrice(subtotal);
    feeEl.textContent = feeEl2.textContent = formatPrice(fee);
    totalEl.textContent = totalEl2.textContent = formatPrice(total);
    countEl.textContent = enriched.length;
    refEl.textContent = `Ref: ${'CHK-' + Math.random().toString(36).slice(2,8).toUpperCase()}`;
    dateEl.textContent = new Date().toLocaleString();
    modalEl._checkoutItems = enriched; modalEl._checkoutSubtotal = subtotal; modalEl._checkoutFee = fee; modalEl._checkoutTotal = total;
    openModal(modalEl);

    // wire actions
    $('#checkout-cancel').onclick = () => closeModal(modalEl);
    $('#checkout-clear').onclick = (e) => { e.preventDefault(); cart = []; saveCart(cart); updateCartUI(); modalEl._checkoutItems = []; itemsWrap.innerHTML = ''; subtotalEl.textContent = totalEl.textContent = '₵0.00'; toast('Cart cleared'); closeModal(modalEl); };

    $('#checkout-pay').onclick = async () => {
      // simple validation
      const name = ($('#checkout-name')?.value || '').trim(); const email = ($('#checkout-email')?.value || '').trim();
      if (!name) { toast('Please provide your full name'); return; }
      if (!email || !email.includes('@')) { toast('Please provide a valid email'); return; }

      // ensure items still available
      for (const it of modalEl._checkoutItems || []) {
        const prod = products.find(p => p.id === it.id);
        if (!prod || prod.available === false) { toast(`${it.id} is no longer available`); return; }
      }

      // store buyer details
      modalEl._buyer = {
        name, email, phone: ($('#checkout-phone')?.value || '').trim(),
        address1: ($('#checkout-address1')?.value || '').trim(),
        city: ($('#checkout-city')?.value || '').trim(),
        postal: ($('#checkout-postal')?.value || '').trim(),
        delivery: ($('#checkout-delivery')?.value || '').trim(),
        notes: ($('#checkout-notes')?.value || '').trim()
      };

      // If Paystack not available or test key, simulate
      if (!window.PaystackPop || PAYSTACK_PUBLIC_KEY.includes('YOUR_PAYSTACK_PUBLIC_KEY_HERE')) {
        const proceed = confirm(`Paystack not configured. Simulate payment of ${formatPrice(modalEl._checkoutTotal)}?`);
        if (!proceed) return;
        const fakeRef = 'SIM-' + Math.random().toString(36).slice(2,10).toUpperCase();
        await handleSuccessfulPayment(fakeRef, modalEl._buyer.email, (modalEl._checkoutItems || []).map(i=>({id:i.id, qty:i.qty, size:i.size})), modalEl._checkoutTotal, modalEl._buyer);
        closeModal(modalEl);
        return;
      }

      // real Paystack flow - keep in try/catch
      try {
        const amountMinor = Math.round((modalEl._checkoutTotal || 0) * 100);
        const handler = PaystackPop.setup({
          key: PAYSTACK_PUBLIC_KEY,
          email: modalEl._buyer.email,
          amount: amountMinor,
          currency: PAYSTACK_CURRENCY,
          metadata: { custom_fields: [{ display_name: "Name", variable_name: "buyer_name", value: modalEl._buyer.name }] },
          onClose: function() { toast('Payment window closed'); },
          callback: function(response) {
            try {
              handleSuccessfulPayment(response.reference, modalEl._buyer.email, (modalEl._checkoutItems || []).map(i=>({id:i.id, qty:i.qty, size:i.size})), modalEl._checkoutTotal, modalEl._buyer);
            } catch(err) { console.error(err); }
            closeModal(modalEl);
          }
        });
        handler.openIframe();
      } catch (err) {
        console.error('Paystack start failed', err);
        toast('Could not start payment — check console.');
      }
    };
  }

  function closeCheckoutModal() { closeModal($('#checkout-modal')); }

  /* ============= BUY NOW ============= */
  function openBuyNowModal(single) {
    const p = products.find(pp => pp.id === single.id);
    if (!p || p.available === false) { toast('This item is not available'); return; }
    const modalEl = $('#buynow-modal'); const wrap = $('#buynow-item');
    if (!modalEl || !wrap) return;
    wrap.innerHTML = '';
    const unit = p.price || 0; const qty = Number(single.qty || 1); const line = +(unit * qty).toFixed(2);
    const subtotal = line; const fee = +(subtotal * 0.0295).toFixed(2); const total = +(subtotal + fee).toFixed(2);
    const row = document.createElement('div'); row.className = 'checkout-item';
    row.innerHTML = `<img src="${(p.images && p.images[0])||''}" alt="${p.title}" /><div class="meta"><div class="title">${p.title}</div><div class="sub">${single.size ? 'Size: '+single.size+' • ':' '}Qty: ${qty}</div></div><div style="margin-left:auto;text-align:right;"><div style="font-weight:800">${formatPrice(unit)}</div><div style="color:var(--muted)">${formatPrice(line)}</div></div>`;
    wrap.appendChild(row);
    $('#buynow-subtotal').textContent = formatPrice(subtotal);
    $('#buynow-fee').textContent = formatPrice(fee);
    $('#buynow-total').textContent = formatPrice(total);
    modalEl._buynowItem = { id: single.id, qty, size: single.size, unit, line, subtotal, fee, total };
    openModal(modalEl);

    $('#buynow-cancel').onclick = () => closeModal(modalEl);
    $('#buynow-pay').onclick = async () => {
      const name = ($('#buynow-name')?.value || '').trim(); const email = ($('#buynow-email')?.value || '').trim();
      if (!name) { toast('Please provide name'); return; }
      if (!email || !email.includes('@')) { toast('Provide valid email'); return; }
      const item = modalEl._buynowItem;
      if (!item) return;
      // simulate Paystack or real
      if (!window.PaystackPop || PAYSTACK_PUBLIC_KEY.includes('YOUR_PAYSTACK_PUBLIC_KEY_HERE')) {
        const proceed = confirm(`Paystack not configured. Simulate payment of ${formatPrice(item.total)}?`);
        if (!proceed) return;
        const fakeRef = 'SIM-' + Math.random().toString(36).slice(2,10).toUpperCase();
        await handleSuccessfulPayment(fakeRef, email, [{ id: item.id, qty: item.qty, size: item.size }], item.total, { name, phone: ($('#buynow-phone')?.value || '').trim() });
        closeModal(modalEl);
        return;
      }
      try {
        const amountMinor = Math.round(item.total * 100);
        const handler = PaystackPop.setup({
          key: PAYSTACK_PUBLIC_KEY, email, amount: amountMinor, currency: PAYSTACK_CURRENCY,
          metadata: { custom_fields: [{ display_name: "Name", variable_name: "buyer_name", value: name }] },
          onClose: function(){ toast('Payment window closed'); },
          callback: function(response){ handleSuccessfulPayment(response.reference, email, [{ id: item.id, qty: item.qty, size: item.size }], item.total, { name, phone: ($('#buynow-phone')?.value || '').trim() }); closeModal(modalEl); }
        });
        handler.openIframe();
      } catch (err) { console.error(err); toast('Payment start failed'); }
    };
  }

  function closeBuyNowModal(){ closeModal($('#buynow-modal')); }

  /* ============= INVOICE PDF GENERATION (jsPDF) ============= */
  async function generateInvoiceBlobUrl(order) {
    if (!order) throw new Error('No order');
    const jspdf = window.jspdf;
    const jsPDF = jspdf && jspdf.jsPDF ? jspdf.jsPDF : (window.jsPDF ? window.jsPDF : null);
    if (!jsPDF) throw new Error('jsPDF not available');

    const doc = new jsPDF({ unit: 'pt', format: 'a4' });
    const left = 36; let y = 36;
    doc.setFontSize(20); doc.setFont('helvetica','bold'); doc.text('Tiny Threads — Invoice', left, y);
    y += 26;
    doc.setFontSize(11); doc.setFont('helvetica','normal');
    doc.text(`Reference: ${order.reference || 'REF-'+Math.random().toString(36).slice(2,8).toUpperCase()}`, left, y); y += 14;
    doc.text(`Date: ${new Date(order.paidAt || nowISO()).toLocaleString()}`, left, y); y += 20;

    // buyer
    doc.setFont('helvetica','bold'); doc.text('Bill to:', left, y); doc.setFont('helvetica','normal');
    const buyerName = (order.buyerDetails && order.buyerDetails.name) ? order.buyerDetails.name : (order.buyerEmail || '—');
    const buyerLines = [buyerName || '—', order.buyerEmail || '', (order.buyerDetails && order.buyerDetails.phone) || '', (order.buyerDetails && order.buyerDetails.address1) || ''].filter(Boolean);
    doc.text(buyerLines.join('\n'), left, y + 14);
    y += Math.max(28, 14 * buyerLines.length) + 6;

    // table header
    doc.setFont('helvetica','bold'); doc.text('Item', left, y); doc.text('Qty', 360, y); doc.text('Unit', 420, y, { align:'right' }); doc.text('Line', 500, y, { align:'right' });
    y += 12; doc.setDrawColor(220); doc.line(left, y, doc.internal.pageSize.getWidth()-left, y); y += 8;
    doc.setFont('helvetica','normal');

    // items
    let subtotal = 0;
    for (const it of (order.items||[])) {
      const prod = products.find(p => p.id === it.id) || {};
      const title = prod.title || it.id;
      const unit = Number(prod.price || it.unit || 0);
      const qty = Number(it.qty || 1);
      const line = +(unit * qty);
      subtotal += line;
      const lines = doc.splitTextToSize(title, 320);
      doc.text(lines, left, y);
      doc.text(String(qty), 360, y);
      doc.text(formatPrice(unit), 420, y, { align:'right' });
      doc.text(formatPrice(line), 500, y, { align:'right' });
      y += Math.max(14, lines.length * 12) + 8;
      if (y > doc.internal.pageSize.getHeight() - 120) { doc.addPage(); y = 36; }
    }

    const processingFee = Number(order.processingFee || +(subtotal * 0.0295).toFixed(2));
    const total = Number(order.total || (subtotal + processingFee));

    // totals block
    y += 8;
    const right = doc.internal.pageSize.getWidth() - left;
    doc.setFont('helvetica','normal');
    doc.text('Subtotal', 400, y); doc.text(formatPrice(subtotal), right, y, { align:'right' }); y += 14;
    doc.text('Processing', 400, y); doc.text(formatPrice(processingFee), right, y, { align:'right' }); y += 18;
    doc.setFont('helvetica','bold'); doc.text('Total', 400, y); doc.text(formatPrice(total), right, y, { align:'right' });

    // footer note
    y += 26;
    if (y > doc.internal.pageSize.getHeight()-80) { doc.addPage(); y = 36; }
    doc.setFontSize(10); doc.setFont('helvetica','normal'); doc.setTextColor(120);
    doc.text('Thank you for shopping with Tiny Threads — contact hello@tinythreads.example', left, y);

    const blob = doc.output('blob');
    const url = URL.createObjectURL(blob);
    return { url, blob };
  }

  async function generateInvoicePDFFallback(order) {
    try {
      const info = await generateInvoiceBlobUrl(order);
      if (info && info.url) {
        const a = document.createElement('a');
        a.href = info.url;
        a.download = `Invoice-${order.reference || 'receipt'}.pdf`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        setTimeout(()=>{ try { URL.revokeObjectURL(info.url); } catch(e){} }, 60000);
        return info;
      }
    } catch (err) {
      console.error('fallback generator failed', err);
      try {
        const jspdf = window.jspdf; const jsPDF = jspdf && jspdf.jsPDF ? jspdf.jsPDF : (window.jsPDF ? window.jsPDF : null);
        if (jsPDF) { const d = new jsPDF(); d.text('Invoice', 20,20); d.save(`Invoice-${(order.reference||'receipt')}.pdf`); }
      } catch (e) { console.error(e); }
    }
  }

  /* ============= RECEIPT / HISTORY UI ============= */
  function showReceiptModal(order, pdfInfo) {
    try {
      const modal = $('#receipt-modal'); if (!modal) return;
      const summary = $('#receipt-summary'); const itemsWrap = $('#receipt-items');
      const totalEl = $('#receipt-total'); const subEl = $('#receipt-subtotal'); const procEl = $('#receipt-processing');
      const refEl = $('#receipt-ref'); const refEl2 = $('#receipt-ref-2'); const dateEl = $('#receipt-date');
      const methodEl = $('#receipt-method'); const statusEl = $('#receipt-status');
      const viewBtn = $('#receipt-view'); const dlBtn = $('#receipt-download'); const printBtn = $('#receipt-print');
      const previewWrap = $('#receipt-preview-wrap'); const previewFrame = $('#receipt-preview'); const loader = $('#preview-loader');

      if (!summary || !itemsWrap) return;
      itemsWrap.innerHTML = ''; summary.innerHTML = '';

      const reference = order.reference || ('REF-' + Math.random().toString(36).slice(2,8).toUpperCase());
      const paidAt = order.paidAt ? new Date(order.paidAt) : new Date();
      refEl.textContent = reference; refEl2.textContent = reference; dateEl.textContent = paidAt.toLocaleString();

      const buyerName = (order.buyerDetails && order.buyerDetails.name) ? order.buyerDetails.name : (order.buyerEmail || '—');
      const buyerEmail = order.buyerEmail || (order.buyerDetails && order.buyerDetails.email) || '—';
      const buyerPhone = (order.buyerDetails && order.buyerDetails.phone) || '';
      const processingFee = Number(order.processingFee || +( (order.total||0) * 0.0295 ).toFixed(2));
      const subtotal = +( (order.total || 0) - processingFee ).toFixed(2);
      const total = +(order.total || 0).toFixed(2);

      summary.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center;">
        <div><div style="font-weight:800">${buyerName}</div><div style="color:var(--muted);font-size:13px">${buyerEmail}${buyerPhone ? ' • '+buyerPhone : ''}</div></div>
        <div style="text-align:right;"><div style="color:var(--muted);font-size:12px">Status</div><div style="font-weight:800;color:var(--brand-1)">${(order.status||'PAID').toUpperCase()}</div></div>
      </div>
      <div style="margin-top:10px;color:var(--muted);font-size:13px">${(order.buyerDetails && (order.buyerDetails.address1 || order.buyerDetails.city)) ? `${order.buyerDetails.address1 || ''} ${order.buyerDetails.city || ''}` : ''}</div>`;

      (order.items || []).forEach(it => {
        const prod = products.find(p=>p.id===it.id) || {};
        const title = prod.title || it.id; const unit = prod.price || (it.unit||0); const qty = Number(it.qty||1); const line = +(unit*qty).toFixed(2);
        const itemNode = document.createElement('div'); itemNode.className='receipt-item';
        itemNode.innerHTML = `<img src="${(prod.images && prod.images[0])||''}" alt="${title}" /><div class="it-meta"><div style="font-weight:800">${title}</div><div style="color:var(--muted);font-size:13px">${it.size?`Size: ${it.size} • `:''}ID: ${it.id}</div></div><div class="it-price"><div>${formatPrice(unit)}</div><div style="color:var(--muted);font-size:13px">${qty} ×</div><div style="font-weight:900;margin-top:6px">${formatPrice(line)}</div></div>`;
        itemsWrap.appendChild(itemNode);
      });

      subEl.textContent = formatPrice(subtotal);
      procEl.textContent = formatPrice(processingFee);
      totalEl.textContent = formatPrice(total);
      methodEl.textContent = order.method || 'Paystack';
      statusEl.textContent = (order.status || 'PAID').toUpperCase();

      // cleanup previous blob
      try { if (modal._pdfUrl && modal._pdfUrl.startsWith('blob:')) { URL.revokeObjectURL(modal._pdfUrl); modal._pdfUrl = null; } } catch(e){}

      viewBtn.disabled = dlBtn.disabled = printBtn.disabled = true;
      previewWrap.style.display = 'none';
      previewFrame.src = '';
      // if we got pdfInfo with blob url, wire actions
      if (pdfInfo && pdfInfo.url) {
        const url = pdfInfo.url;
        modal._pdfUrl = url;
        viewBtn.disabled = dlBtn.disabled = printBtn.disabled = false;

        // ensure iframe does not have restrictive sandbox attribute when loading blob URLs
        if (previewFrame.hasAttribute('sandbox')) previewFrame.removeAttribute('sandbox');

        viewBtn.onclick = () => {
          previewWrap.style.display = '';
          loader.style.display = '';
          previewFrame.onload = () => { loader.style.display = 'none'; };
          previewFrame.src = url;
          try { window.open(url, '_blank'); } catch (e) {}
        };

        dlBtn.onclick = () => {
          const a = document.createElement('a'); a.href = url; a.download = `Invoice-${reference || 'receipt'}.pdf`; document.body.appendChild(a); a.click(); a.remove();
        };

        printBtn.onclick = () => {
          // open new window/tab (some browsers block if not user gesture but this is a click handler)
          const w = window.open(url, '_blank');
          if (!w) { toast('Popup blocked — use Download'); return; }
          w.onload = () => { try { w.focus(); w.print(); } catch (e) { console.error(e); } };
        };

        // preload small preview
        setTimeout(()=>{ previewWrap.style.display=''; loader.style.display=''; previewFrame.onload = ()=>{ loader.style.display='none'; }; previewFrame.src = url; }, 120);
      } else {
        viewBtn.onclick = dlBtn.onclick = printBtn.onclick = null;
      }

      $('#receipt-close') && ($('#receipt-close').onclick = () => closeModal(modal));
      $('#receipt-close-bottom') && ($('#receipt-close-bottom').onclick = () => closeModal(modal));
      openModal(modal);
    } catch (err) { console.error('showReceiptModal error', err); toast('Could not show receipt'); }
  }

  /* ============= after-success payment handler ============= */
  async function handleSuccessfulPayment(reference, buyerEmail, items, total, buyerDetails = {}) {
    try {
      if (!Array.isArray(items)) items = [];
      const snapshotItems = items.map(it => ({ id: it.id, qty: it.qty||1, size: it.size||'' }));

      // mark products unavailable
      for (const it of snapshotItems) { const p = products.find(pp => pp.id === it.id); if (p) p.available = false; }
      saveProductsLocal();

      const processingFee = +( (total * 0.0295) ).toFixed(2);
      const order = {
        reference: reference || ('REF-' + Math.random().toString(36).slice(2,9).toUpperCase()),
        buyerEmail: buyerEmail || (buyerDetails && buyerDetails.email) || '',
        buyerDetails: buyerDetails || {},
        items: snapshotItems,
        total: total || 0,
        processingFee,
        paidAt: nowISO(),
        status: 'paid',
        method: 'Paystack'
      };
      pushOrder(order);

      // remove purchased items from cart
      const purchasedIds = snapshotItems.map(i => i.id);
      cart = cart.filter(c => !purchasedIds.includes(c.id));
      saveCart(cart);

      updateCartUI();
      renderProductsBatch(true);
      closeCart();
      closeProductModal();

      toast('Payment successful — generating receipt...');

      // generate pdf & show receipt
      try {
        const pdfInfo = await generateInvoiceBlobUrl(order);
        showReceiptModal(order, pdfInfo);
      } catch (err) {
        console.error('invoice gen failed', err);
        try { await generateInvoicePDFFallback(order); } catch(e) {}
        showReceiptModal(order, null);
      }

      return order;
    } catch (err) {
      console.error('handleSuccessfulPayment', err); toast('Payment processed but an error occurred.');
      return null;
    }
  }
  // expose globally (Paystack callback compatibility)
  window.handleSuccessfulPayment = handleSuccessfulPayment;

  /* ============= PURCHASE HISTORY UI ============= */
  (function purchaseHistoryInit() {
    const historyToggle = $('#history-toggle'); const historyBadge = $('#history-badge'); const historyModal = $('#history-modal'); const historyList = $('#history-list');
    const historyClose = $('#history-close'); const historyCloseBottom = $('#history-close-bottom'); const historyClearAll = $('#history-clear-all'); const historyCountEl = $('#history-count');

    function formatDate(iso) { try { return new Date(iso).toLocaleString(); } catch(e) { return iso || ''; } }

    function updateHistoryBadge() {
      const orders = readOrders();
      historyBadge && (historyBadge.textContent = orders.length || 0);
      historyCountEl && (historyCountEl.textContent = (orders.length || 0) + ' order' + (orders.length===1 ? '' : 's'));
    }

    function renderHistoryList() {
      const orders = readOrders();
      if (!historyList) return;
      historyList.innerHTML = '';
      if (!orders || orders.length === 0) {
        historyList.innerHTML = `<div style="padding:18px;border-radius:10px;background:linear-gradient(180deg,#fff,#fffefc);box-shadow:var(--shadow);text-align:center;color:var(--muted)"><i class="fa fa-box-open fa-2x"></i><div style="margin-top:8px">No purchases yet.</div></div>`;
        return;
      }
      orders.forEach(order => {
        const itemCount = (order.items||[]).length;
        const firstProduct = (order.items && order.items[0]) ? (products.find(p => p.id === order.items[0].id) || {}) : {};
        const thumb = (firstProduct.images && firstProduct.images[0]) || '';
        const title = firstProduct.title || (order.items && order.items[0] && order.items[0].id) || `Order`;
        const d = document.createElement('div'); d.className = 'history-item';
        d.innerHTML = `<div class="history-left"><div class="history-thumb">${thumb ? `<img src="${thumb}" style="width:100%;height:100%;object-fit:cover;border-radius:8px" alt="${title}">` : (title.charAt(0)||'O')}</div><div class="history-meta"><div class="title">${title}</div><div class="sm">${formatDate(order.paidAt)} • ${itemCount} item${itemCount===1?'':'s'} • ${formatPrice(order.total||0)}</div></div></div><div class="history-actions"><button class="btn tiny outline view-receipt" data-ref="${order.reference}">View PDF</button><button class="btn tiny download-receipt" data-ref="${order.reference}">Download</button><button class="btn tiny delete-order" data-ref="${order.reference}" title="Delete order"><i class="fa fa-trash"></i></button></div>`;
        historyList.appendChild(d);
      });

      // wire actions
      historyList.querySelectorAll('.view-receipt').forEach(btn => btn.addEventListener('click', async (e) => {
        const ref = btn.dataset.ref; const orders = readOrders(); const order = orders.find(o => o.reference === ref);
        if (!order) { toast('Order not found'); return; }
        try {
          const pdfInfo = await generateInvoiceBlobUrl(order);
          showReceiptModal(order, pdfInfo);
        } catch (err) {
          console.error(err); toast('Could not generate PDF — check console.'); showReceiptModal(order, null);
        }
      }));

      historyList.querySelectorAll('.download-receipt').forEach(btn => btn.addEventListener('click', async (e) => {
        const ref = btn.dataset.ref; const orders = readOrders(); const order = orders.find(o => o.reference === ref);
        if (!order) { toast('Order not found'); return; }
        try {
          const pdfInfo = await generateInvoiceBlobUrl(order);
          const a = document.createElement('a'); a.href = pdfInfo.url; a.download = `Invoice-${order.reference||'receipt'}.pdf`; document.body.appendChild(a); a.click(); a.remove();
          setTimeout(()=>{ try { URL.revokeObjectURL(pdfInfo.url); } catch(e){} }, 60000);
        } catch (err) { console.error(err); toast('Could not create PDF for download.'); }
      }));

      historyList.querySelectorAll('.delete-order').forEach(btn => btn.addEventListener('click', (e) => {
        const ref = btn.dataset.ref;
        if (!confirm('Remove this order from local history?')) return;
        const newOrders = readOrders().filter(o => o.reference !== ref);
        localStorage.setItem(STORAGE_KEYS.ORDERS, JSON.stringify(newOrders));
        renderHistoryList(); updateHistoryBadge(); toast('Order removed from history');
      }));
    }

    function openHistoryModal() { renderHistoryList(); updateHistoryBadge(); openModal(historyModal); }
    function closeHistoryModal() { closeModal(historyModal); }

    historyToggle?.addEventListener('click', (e)=>{ e.preventDefault(); const isOpen = historyModal.classList.contains('open'); if (isOpen) closeHistoryModal(); else openHistoryModal(); });
    historyClose?.addEventListener('click', closeHistoryModal);
    historyCloseBottom?.addEventListener('click', closeHistoryModal);
    historyClearAll?.addEventListener('click', ()=> {
      if (!confirm('Clear all saved purchase history from this device?')) return;
      localStorage.removeItem(STORAGE_KEYS.ORDERS);
      renderHistoryList(); updateHistoryBadge(); toast('Purchase history cleared');
    });

    updateHistoryBadge();
    setInterval(updateHistoryBadge, 2000);
  })();

  /* ============= HERO SLIDER ============= */
  (function heroInit(){
    const slider = document.querySelector('.hero-slider'); if (!slider) return;
    const slides = $$('.hero-slider .slide'); const dotsWrap = $('.hero-dots');
    let idx = 0; const total = slides.length; let timer = null;
    function show(i) {
      slides.forEach(s=>{ s.classList.remove('active'); s.style.display='none'; });
      slides[i].style.display=''; slides[i].classList.add('active');
      dotsWrap.innerHTML='';
      for (let d=0; d<total; d++){ const b=document.createElement('button'); b.className='dot'+(d===i?' active':''); b.setAttribute('aria-label',`Go to slide ${d+1}`); b.addEventListener('click',()=>{ idx=d; resetTimer(); show(idx); }); dotsWrap.appendChild(b); }
    }
    function next(){ idx=(idx+1)%total; show(idx); }
    function prev(){ idx=(idx-1+total)%total; show(idx); }
    $('.hero-next')?.addEventListener('click', (e)=>{ e.preventDefault(); resetTimer(); next(); });
    $('.hero-prev')?.addEventListener('click', (e)=>{ e.preventDefault(); resetTimer(); prev(); });
    function resetTimer(){ if (timer) clearInterval(timer); timer = setInterval(next, 4000); }
    show(0); resetTimer();
  })();

  /* ============= NAV / SEARCH / UI ============= */
  // category chips
  $$('.category-chips .chip').forEach(chip => chip.addEventListener('click', () => {
    const key = chip.dataset.filter;
    if (activeFilters.ageCategory === key) { activeFilters.ageCategory = null; chip.classList.remove('active'); }
    else { activeFilters.ageCategory = key; $$('.category-chips .chip').forEach(c=>c.classList.remove('active')); chip.classList.add('active'); }
    renderProductsBatch(true);
  }));

  $('#search-input')?.addEventListener('input', (e)=>{ activeFilters.search = e.target.value; clearTimeout(window.__searchTimer); window.__searchTimer = setTimeout(()=>renderProductsBatch(true), 220); });
  $('#search-clear')?.addEventListener('click', ()=>{ $('#search-input').value=''; activeFilters.search=''; renderProductsBatch(true); });
  $('#sort-select')?.addEventListener('change', (e)=>{ activeFilters.sort = e.target.value; renderProductsBatch(true); });
  $('#load-more')?.addEventListener('click', (e)=>{ e.preventDefault(); renderProductsBatch(false); });

  // mobile nav toggle
  (function mobileNavInit(){
    const mobileToggle = $('#mobile-toggle'); const mobileNav = $('#mobile-nav');
    if (!mobileToggle || !mobileNav) return;
    function ensure() {
      if (window.innerWidth <= MOBILE_BREAKPOINT) { mobileToggle.style.display='inline-flex'; mobileToggle.setAttribute('aria-hidden','false'); }
      else { mobileToggle.style.display=''; mobileNav.classList.remove('open'); mobileNav.setAttribute('aria-hidden','true'); mobileToggle.setAttribute('aria-expanded','false'); }
    }
    ensure(); window.addEventListener('resize', ensure);
    mobileToggle.addEventListener('click', (ev)=>{ ev.preventDefault(); const isOpen = mobileNav.classList.contains('open'); mobileNav.classList.toggle('open', !isOpen); mobileNav.setAttribute('aria-hidden', (!isOpen).toString()); mobileToggle.setAttribute('aria-expanded', (!isOpen).toString()); });
    $$('#mobile-nav a').forEach(a => a.addEventListener('click', ()=>{ mobileNav.classList.remove('open'); mobileNav.setAttribute('aria-hidden','true'); mobileToggle.setAttribute('aria-expanded','false'); }));
  })();

  // search overlay behavior
  (function headerSearchInit(){
    const searchToggle = $('#search-toggle'); const searchInput = $('#search-input'); const searchWrap = document.querySelector('.search-wrap');
    if (!searchToggle || !searchInput) return;
    function openSearch(){ document.body.classList.add('search-open'); if (searchWrap) searchWrap.style.zIndex = 230; setTimeout(()=>searchInput.focus(),120); searchToggle.setAttribute('aria-expanded','true'); }
    function closeSearch(){ document.body.classList.remove('search-open'); searchToggle.setAttribute('aria-expanded','false'); }
    searchToggle.addEventListener('click', ()=>{ const is = document.body.classList.contains('search-open'); if (is) closeSearch(); else openSearch(); });
    document.addEventListener('click', (e)=>{ if (!document.body.classList.contains('search-open')) return; const t = e.target; if (searchWrap && !searchWrap.contains(t) && !searchToggle.contains(t)) closeSearch(); });
  })();

  /* ============= CONTACT ACTIONS ============= */
  (function contactEnhance(){
    const actions = $$('.contact-action');
    actions.forEach(btn => {
      btn.addEventListener('click', (ev) => {
        ev.preventDefault();
        const action = btn.dataset.action;
        const value = btn.dataset.value;
        if (action === 'call' && value) { window.location.href = `tel:${value}`; }
        else if (action === 'whatsapp' && value) {
          // prepare phone for wa.me
          const cleaned = value.replace(/\D/g,'').replace(/^0+/,''); // basic sanitization
          // prefer international with plus stripped
          let number = cleaned;
          if (!number.startsWith('233') && !number.startsWith('234') && !number.startsWith('234') && number.length <= 10) {
            // assume local GH number; don't force
            number = cleaned;
          }
          try { window.open(`https://wa.me/${number}`, '_blank'); } catch(e){ window.location.href = `https://wa.me/${number}`; }
        }
        else if (action === 'copy' && value) {
          navigator.clipboard?.writeText(value).then(()=> toast('Copied to clipboard'), ()=> { toast('Could not copy — select and copy manually'); });
        }
      });
    });

    // contact form
    const form = $('#contact-form');
    form?.addEventListener('submit', (ev) => {
      ev.preventDefault(); toast('Thanks! Message sent (demo). Owner needs a backend to actually receive messages.'); form.reset();
    });
  })();

  /* ============= SMALL INITS ============= */
  function syncHeaderSpace() { const header = document.querySelector('.site-header'); if (!header) return; const h = header.offsetHeight || 0; document.documentElement.style.setProperty('--header-space', h + 'px'); }
  document.addEventListener('DOMContentLoaded', () => { syncHeaderSpace(); setTimeout(syncHeaderSpace, 120); renderProductsBatch(true); updateCartUI(); });
  window.addEventListener('resize', () => setTimeout(syncHeaderSpace, 160));

  /* Expose small debug API */
  window._tinyThreads = { getState: ()=>({ products, cart }), setPaystackKey: (k,c)=>{ if (!k) return; /* do nothing here: key is const in this build */ console.log('setPaystackKey called (ignored in this build)'); } };

  console.log('[tinythreads] script loaded (improved modal + PDF handling). Paystack key present?', !!PAYSTACK_PUBLIC_KEY);

})();
</script>


</body>
</html>
